var Fe=Object.defineProperty;var He=(l,e,t)=>e in l?Fe(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var ce=(l,e,t)=>He(l,typeof e!="symbol"?e+"":e,t);import{i as T,m as K,p as ae,j as pe,a as L,b as P,o as n,w as i,f as a,d as o,n as X,u as A,t as r,c as u,e as y,F as H,h as q,g as w,r as We,N as Ee,l as Se,L as qe,v as ze,H as Ke}from"./vue.esm-bundler-Dk_uEpzT.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{B as Ze,I as fe}from"./Badge-Bo-XvQ4z.js";import{_ as Qe}from"./Empty-_Xwqr8fE.js";import{f as Ye}from"./common-BfEhDM5f.js";import{b as Y,c as ve,a as re,C as Ge}from"./CopyToClipboard-CdYJKbOz.js";import{_ as R}from"./DynamicIcon-y7KGaMbT.js";import{t as v,a as Te}from"./Translator-Cu_KObU0.js";import{_ as Je,C as xe,c as Oe,d as Ue}from"./RouteCell-B9g1hLhs.js";import{A as Ne}from"./Arr-MwYQQ3qa.js";import{A as Xe}from"./Asset-lElToF0K.js";import{n as x}from"./Notify-2R1_bNii.js";import{R as z}from"./Rest-U7WPPDzn.js";import{L as Pe,u as et}from"./NotFound-_aB0Ut7N.js";import{e as Be}from"./index-CCpw3JZM.js";import{f as tt}from"./productService-BFa9dULw.js";const st={class:"fc-customer-edit-modal"},lt={class:"fc-compact-form"},at={class:"form-heading"},ot={class:"fc-compact-form fc-customer-address-section"},dt={key:0,class:"mt-5"},nt={key:1,class:"form-error-wrap"},rt={class:"dialog-footer"},it={__name:"NewCustomerModal",props:{customer_id:{type:[String,Number],default:null},customer:{type:Object,default:()=>({})},customerModalInfos:{type:Object,default:()=>({})}},emits:["close-modal","select-new-customer","update:customerModal"],setup(l,{emit:e}){const t=e,C=l,c=T({}),d=T(!1),h=T({}),k=()=>{t("close-modal")},N=()=>{d.value=!0,c.value.wp_user=C.customerModalInfos.manageWpUser,z.post("customers/",{...c.value}).then(p=>{t("select-new-customer",p.data),t("update:customerModal",!1),x.success(p.message),h.value={}}).catch(p=>{var g;p.status_code=="422"?(x.validationErrors(p),h.value=p.data):x.error((g=p.data)==null?void 0:g.message)}).finally(()=>{d.value=!1})},I=()=>{d.value=!0,c.value.wp_user=C.customerModalInfos.manageWpUser,z.put("customers/"+C.customer_id,{...c.value}).then(p=>{t("select-new-customer",p.data),t("update:customerModal",!1),x.success(p.message),h.value={}}).catch(p=>{var g;p.status_code=="422"?(x.validationErrors(p),h.value=p.data):x.error((g=p.data)==null?void 0:g.message)}).finally(()=>{d.value=!1})},U=K(()=>C.customerModalInfos.action==="create"?v("Create as wordpress user"):v("Update wordpress user profile")),E=K(()=>d.value?C.customerModalInfos.action==="edit"?v("Updating"):v("Creating"):C.customerModalInfos.action==="edit"?v("Update Customer"):v("Create Customer")),B=K(()=>{const p={};for(const g in h.value){const O=h.value[g];p[g]=Array.isArray(O)?O:Object.values(O)}return p});return ae(()=>C.customer,p=>{c.value={id:p.id,email:p.email,full_name:p.full_name,state:p.state,city:p.city,country:p.country,postcode:p.postcode,country_name:p.country_name,contact_id:p.contact_id,user_id:p.user_id,wp_user:p.wp_user}},{deep:!0}),pe(()=>{c.value={id:C.customer.id,email:C.customer.email,full_name:C.customer.full_name,state:C.customer.state,city:C.customer.city,country:C.customer.country,postcode:C.customer.postcode,country_name:C.customer.country_name,contact_id:C.customer.contact_id,user_id:C.customer.user_id,wp_user:C.customer.wp_user}}),(p,g)=>{const O=L("el-checkbox"),m=L("el-button"),_=L("el-dialog");return n(),P(_,{modelValue:l.customerModalInfos.showModal,"onUpdate:modelValue":g[6]||(g[6]=$=>l.customerModalInfos.showModal=$),title:l.customerModalInfos.title,onClose:g[7]||(g[7]=()=>{h.value={}})},{default:i(()=>[a("div",st,[a("div",lt,[o(Y,{label:A(v)("Full Name *"),modelValue:c.value.full_name,"onUpdate:modelValue":g[0]||(g[0]=$=>c.value.full_name=$),class:X(h.value.full_name?"is-error":"")},null,8,["label","modelValue","class"]),o(Y,{type:"email",label:A(v)("Email *"),modelValue:c.value.email,"onUpdate:modelValue":g[1]||(g[1]=$=>c.value.email=$),disabled:l.customer.user_id&&l.customer.user_id!=0,class:X(h.value.email?"is-error":"")},null,8,["label","modelValue","disabled","class"])]),a("h4",at,r(A(v)("Address")),1),a("div",ot,[o(ve,{modelValue:c.value,"onUpdate:modelValue":g[2]||(g[2]=$=>c.value=$),validationErrors:h.value},null,8,["modelValue","validationErrors"]),l.customerModalInfos.action==="create"?(n(),u("div",dt,[o(O,{"true-value":"yes","false-value":"no",modelValue:l.customerModalInfos.manageWpUser,"onUpdate:modelValue":g[3]||(g[3]=$=>l.customerModalInfos.manageWpUser=$)},{default:i(()=>[o(Pe,{title:U.value,content:A(v)("We will create a new user for this customer. If a user with the same email already exists, we will associate the customer with that existing user.")},null,8,["title","content"])]),_:1},8,["modelValue"])])):y("",!0),Object.keys(h.value).length?(n(),u("div",nt,[(n(!0),u(H,null,q(B.value,($,V)=>(n(),u("p",{key:V},[(n(!0),u(H,null,q($,M=>(n(),u("span",{key:M},r(M),1))),128))]))),128))])):y("",!0)]),a("div",rt,[o(m,{onClick:k},{default:i(()=>[w(r(A(v)("Cancel")),1)]),_:1}),l.customerModalInfos.action==="edit"?(n(),P(m,{key:0,loading:d.value,type:"primary",onClick:g[4]||(g[4]=$=>I())},{default:i(()=>[w(r(E.value),1)]),_:1},8,["loading"])):(n(),P(m,{key:1,type:"primary",loading:d.value,onClick:g[5]||(g[5]=$=>N())},{default:i(()=>[w(r(E.value),1)]),_:1},8,["loading"]))])])]),_:1},8,["modelValue","title"])}}};class ut{constructor(){ce(this,"allPermissions",[]);this.allPermissions=Ne.get(window,"fluentCartAdminApp.app_config.permissions",[])}isSuperAdmin(){return this.allPermissions.includes("is_super_admin")}has(e){return this.isSuperAdmin()?!0:this.allPermissions.includes(e)}hasAny(e){return this.isSuperAdmin()?!0:Array.isArray(e)&&e.some(t=>this.allPermissions.includes(t))}hasAll(e){return this.isSuperAdmin()?!0:Array.isArray(e)&&e.every(t=>this.allPermissions.includes(t))}resolve({permission:e,permissionType:t}){const C=t==="all"?"all":"any",c=Array.isArray(e)?e:typeof e=="string"?e.split(",").map(d=>d.trim()):[];return C==="all"?this.hasAll(c):this.hasAny(c)}}const ct=new ut,De={__name:"UserCan",props:{permission:{type:[String,Array],required:!0},permissionType:{type:String,default:"any"}},setup(l){const e=l,t=K(()=>ct.resolve({permission:e.permission,permissionType:e.permissionType}));return(C,c)=>t.value?We(C.$slots,"default",{key:0}):y("",!0)}},mt={name:"OrderUpDownIndicator",props:{order:{type:Object,required:!0}},data(){var l,e;return{upgradeToId:((l=this.order.config)==null?void 0:l.upgraded_to)||null,upgradeFromId:((e=this.order.config)==null?void 0:e.upgraded_from)||null}}},pt={key:0,class:"ml-2"};function _t(l,e,t,C,c,d){const h=L("el-icon"),k=L("el-button"),N=L("router-link"),I=L("el-tooltip");return c.upgradeFromId||c.upgradeToId?(n(),u("span",pt,[c.upgradeFromId?(n(),P(I,{key:0,trigger:"click"},{content:i(()=>[w(r(l.$t("This order has been upgraded from"))+" ",1),o(N,{to:{name:"view_order",params:{order_id:c.upgradeFromId}}},{default:i(()=>[a("strong",null,"#"+r(c.upgradeFromId),1)]),_:1},8,["to"])]),default:i(()=>[o(k,{text:""},{default:i(()=>[o(h,null,{default:i(()=>e[0]||(e[0]=[a("svg",{viewBox:"0 0 24 24",width:"24",height:"24",color:"currentColor",fill:"none"},[a("defs"),a("path",{fill:"currentColor",d:"M11.943,1.75 L12.057,1.75 C14.248,1.75 15.969,1.75 17.312,1.931 C18.689,2.116 19.781,2.503 20.639,3.361 C21.497,4.219 21.884,5.311 22.069,6.688 C22.25,8.031 22.25,9.752 22.25,11.943 L22.25,12.057 C22.25,14.248 22.25,15.969 22.069,17.312 C21.884,18.689 21.497,19.781 20.639,20.639 C19.781,21.497 18.689,21.884 17.312,22.069 C15.969,22.25 14.248,22.25 12.057,22.25 L11.943,22.25 C9.752,22.25 8.031,22.25 6.688,22.069 C5.311,21.884 4.219,21.497 3.361,20.639 C2.503,19.781 2.116,18.689 1.931,17.312 C1.75,15.969 1.75,14.248 1.75,12.057 L1.75,11.943 C1.75,9.752 1.75,8.031 1.931,6.688 C2.116,5.311 2.503,4.219 3.361,3.361 C4.219,2.503 5.311,2.116 6.688,1.931 C8.031,1.75 9.752,1.75 11.943,1.75 L11.943,1.75 Z M4.422,4.422 C3.889,4.955 3.58,5.678 3.417,6.888 C3.252,8.12 3.25,9.74 3.25,12 C3.25,14.26 3.252,15.88 3.417,17.112 C3.58,18.322 3.889,19.045 4.422,19.578 C4.955,20.111 5.678,20.42 6.888,20.583 C8.12,20.748 9.74,20.75 12,20.75 C14.26,20.75 15.88,20.748 17.112,20.583 C18.322,20.42 19.045,20.111 19.578,19.578 C20.111,19.045 20.42,18.322 20.583,17.112 C20.748,15.88 20.75,14.26 20.75,12 C20.75,9.74 20.748,8.12 20.583,6.888 C20.42,5.678 20.111,4.955 19.578,4.422 C19.045,3.889 18.322,3.58 17.112,3.417 C15.88,3.252 14.26,3.25 12,3.25 C9.74,3.25 8.12,3.252 6.888,3.417 C5.678,3.58 4.955,3.889 4.422,4.422 Z M10.038,11.023 C9.749,11.32 9.274,11.326 8.977,11.038 C8.68,10.749 8.673,10.274 8.962,9.977 C9.051,9.886 9.197,9.704 9.41,9.433 L9.457,9.373 C9.647,9.131 9.87,8.847 10.099,8.576 C10.346,8.285 10.621,7.983 10.897,7.749 C11.035,7.631 11.19,7.515 11.358,7.425 C11.519,7.339 11.742,7.25 12,7.25 C12.258,7.25 12.481,7.339 12.642,7.425 C12.81,7.515 12.965,7.631 13.103,7.749 C13.379,7.983 13.654,8.285 13.901,8.576 C14.13,8.847 14.353,9.131 14.543,9.373 L14.543,9.373 L14.59,9.433 C14.804,9.704 14.949,9.886 15.038,9.977 C15.326,10.274 15.32,10.749 15.023,11.038 C14.726,11.326 14.251,11.32 13.962,11.023 C13.805,10.861 13.603,10.604 13.411,10.359 L13.366,10.302 C13.173,10.057 12.967,9.794 12.756,9.545 L12.75,9.538 L12.75,16 C12.75,16.414 12.414,16.75 12,16.75 C11.586,16.75 11.25,16.414 11.25,16 L11.25,9.538 L11.244,9.545 C11.033,9.794 10.827,10.057 10.634,10.302 L10.634,10.302 L10.589,10.359 C10.397,10.604 10.195,10.861 10.038,11.023 Z"})],-1)])),_:1,__:[0]})]),_:1})]),_:1})):y("",!0),c.upgradeToId?(n(),P(I,{key:1,trigger:"click"},{content:i(()=>[w(r(l.$t("This order has been upgraded to"))+" ",1),o(N,{to:{name:"view_order",params:{order_id:c.upgradeToId}}},{default:i(()=>[a("strong",null,"#"+r(c.upgradeToId),1)]),_:1},8,["to"])]),default:i(()=>[o(k,{text:""},{default:i(()=>[o(h,null,{default:i(()=>e[1]||(e[1]=[a("svg",{viewBox:"0 0 24 24",width:"24",height:"24",color:"currentColor",fill:"none"},[a("defs"),a("path",{fill:"currentColor",d:"M3.367,20.63 C1.756,19.02 1.756,16.672 1.756,11.995 L1.756,11.995 C1.756,7.317 1.756,4.97 3.367,3.359 C4.976,1.75 7.324,1.75 12.002,1.75 C16.68,1.75 19.026,1.75 20.637,3.359 C22.247,4.97 22.247,7.318 22.247,11.996 C22.247,16.674 22.247,19.022 20.637,20.631 C19.026,22.242 16.678,22.242 12,22.242 L12.003,22.241 C7.326,22.241 4.976,22.241 3.367,20.63 Z M4.427,4.418 C3.256,5.59 3.256,7.73 3.256,11.994 L3.256,11.995 C3.256,16.259 3.256,18.399 4.427,19.569 C5.597,20.741 7.738,20.741 12.003,20.741 C16.269,20.741 18.408,20.741 19.58,19.569 C20.75,18.399 20.75,16.259 20.75,11.993 L20.75,11.993 C20.75,7.727 20.75,5.588 19.58,4.417 C18.408,3.247 16.268,3.247 12.005,3.247 L12.003,3.248 C7.739,3.248 5.599,3.248 4.427,4.418 Z M12.024,8.951 C12.121,9.047 12.306,9.198 12.578,9.415 L12.654,9.476 L12.654,9.476 C12.894,9.667 13.172,9.888 13.437,10.117 C13.727,10.367 14.029,10.648 14.262,10.932 C14.432,11.139 14.661,11.456 14.726,11.834 C14.729,11.85 14.732,11.866 14.734,11.883 C14.741,11.94 14.745,11.999 14.745,12.059 C14.744,12.083 14.743,12.106 14.74,12.13 C14.693,12.568 14.41,12.933 14.199,13.168 C13.96,13.435 13.661,13.696 13.375,13.93 C13.152,14.112 12.918,14.292 12.71,14.452 C12.651,14.497 12.594,14.541 12.541,14.582 C12.277,14.786 12.109,14.923 12.027,15.007 C11.739,15.305 11.264,15.312 10.967,15.024 C10.669,14.735 10.662,14.26 10.95,13.963 C11.121,13.787 11.382,13.582 11.623,13.396 C11.684,13.349 11.745,13.302 11.807,13.254 C12.012,13.097 12.222,12.935 12.427,12.768 L12.483,12.722 L6.995,12.715 C6.581,12.715 6.246,12.379 6.246,11.964 C6.247,11.55 6.583,11.215 6.997,11.215 L12.422,11.222 C12.191,11.024 11.949,10.832 11.718,10.648 L11.718,10.648 L11.643,10.588 C11.396,10.391 11.134,10.181 10.965,10.012 C10.672,9.72 10.671,9.245 10.964,8.952 C11.257,8.659 11.731,8.658 12.024,8.951 Z M17.754,8.001 L17.745,15.993 C17.744,16.407 17.408,16.743 16.994,16.742 C16.58,16.742 16.244,16.405 16.245,15.991 L16.254,7.999 C16.255,7.585 16.591,7.25 17.005,7.25 C17.419,7.25 17.755,7.587 17.754,8.001 Z"})],-1)])),_:1,__:[1]})]),_:1})]),_:1})):y("",!0)])):y("",!0)}const sa=_e(mt,[["render",_t]]),ie=class ie{static emptyImage(e=!1){return ie.assetUrl()+(e?"images/empty-image-dark.svg":"images/empty-image.svg")}};ce(ie,"assetUrl",()=>Xe.url());let me=ie;const ft={components:{DynamicIcon:R},props:{product:{type:Object},hideProductId:{type:Boolean,default:!1},hideViewIcon:{type:Boolean,default:!1},hideImage:{type:Boolean,default:!1}},data(){return{}},methods:{translate:v,getImage(l,e=!1){return Ne.get(l,"featured_media.url")??me.emptyImage(e)}}},vt={class:"fc-product-info-card w-full"},ht={key:0,class:"fc-product-info-media"},gt=["src","alt"],yt=["src","alt"],bt={class:"fc-product-info-details"},Ct={class:"fc-product-info-name"},At={class:"product-name"},wt={class:"product-name-inner"},kt=["href"],$t={key:0,class:"product-id"},Mt={key:1,class:"product-sub-name"};function Lt(l,e,t,C,c,d){var k,N,I,U,E,B,p,g,O;const h=L("DynamicIcon");return n(),u("div",vt,[t.hideImage?y("",!0):(n(),u("div",ht,[a("span",null,[a("img",{class:"block dark:hidden",src:d.getImage((k=t.product)==null?void 0:k.detail),alt:(N=t.product)==null?void 0:N.post_title},null,8,gt),a("img",{class:"hidden dark:block",src:d.getImage((I=t.product)==null?void 0:I.detail,!0),alt:(U=t.product)==null?void 0:U.post_title},null,8,yt)])])),a("div",bt,[a("div",Ct,[a("span",At,[a("span",wt,r(((E=t.product)==null?void 0:E.post_title)||d.translate("No Name")),1),t.hideViewIcon?y("",!0):(n(),u("a",{key:0,class:"view-link right-1",target:"_blank",href:(B=t.product)==null?void 0:B.view_url,onClick:e[0]||(e[0]=Ee(()=>{},["stop"]))},[o(h,{class:"w-5 h-5",name:"Eye"})],8,kt))]),t.hideProductId?y("",!0):(n(),u("span",$t," #"+r((p=t.product)==null?void 0:p.ID),1)),(g=t.product)!=null&&g.variation_title?(n(),u("span",Mt," – "+r((O=t.product)==null?void 0:O.variation_title),1)):y("",!0)])])])}const It=_e(ft,[["render",Lt]]),Vt={name:"LicenseTable",components:{ProductInfo:It,UserCan:De,RouteCell:Je,DynamicIcon:R,IconButton:fe,CopyToClipboard:re,Empty:Qe,Badge:Ze},props:{licenses:{type:Array,required:!0},columns:{type:Array,default(){return["product","order_id","customer","date"]}}},computed:{Clipboard(){return Ge},formattedLicense(){return this.licenses.map(l=>{var e;return{...l,product:{...l.product,variation_title:((e=l.product_variant)==null?void 0:e.variation_title)||"n/a"}}})}},methods:{translate:v,formatDate:Ye,translateNumber:Te,getProductName(l){var e,t;return(e=l==null?void 0:l.product)!=null&&e.post_title?(t=l==null?void 0:l.product)==null?void 0:t.post_title:"n/a"},getProductVariationName(l){var e,t;return(e=l==null?void 0:l.product_variant)!=null&&e.variation_title?(t=l==null?void 0:l.product_variant)==null?void 0:t.variation_title:"n/a"}}},Et={class:"fct_licenses_table hide-on-mobile"},St={class:"fc-license-key-wrap flex flex-col"},Tt={class:"fc-license-key max-w-full pr-1"},xt={class:"fc-license-key-inner pr-2"},Ot={key:0},Ut={key:1},Nt={class:"fct_licenses_table_mobile"},Pt={class:"fc-table-mobile-wrap"},Bt=["onClick"],Dt={class:"fc-table-mobile-header-left"},jt={class:"fc-table-status-col"},Rt={class:"fc-table-activations-col"},Ft={class:"fc-table-mobile-body"},Ht=["onClick"],Wt={class:"fc-license-key-wrap has-bg"},qt={class:"fc-license-key"},zt={class:"fc-license-key-inner pr-2"};function Kt(l,e,t,C,c,d){const h=L("Badge"),k=L("router-link"),N=L("DynamicIcon"),I=L("el-tooltip"),U=L("el-table-column"),E=L("ProductInfo"),B=L("RouteCell"),p=L("Empty"),g=L("el-table"),O=L("UserCan");return n(),P(O,{permission:"licenses/view"},{default:i(()=>[a("div",Et,[o(g,{data:d.formattedLicense,class:"w-full compact-table"},{empty:i(()=>[o(p,{icon:"Empty/ListView","has-dark":!0,text:d.translate("No Licenses found based on your filter")},null,8,["text"])]),default:i(()=>[o(U,{label:d.translate("License Key"),width:200},{default:i(m=>{var _;return[a("div",St,[a("span",null,[(n(),P(h,{status:m.row.status,key:m.row.id},null,8,["status"]))]),a("span",Tt,[a("span",xt,[o(k,{class:"link",to:{name:"view_license",params:{license_id:(_=m.row)==null?void 0:_.id}}},{default:i(()=>[w(r(m.row.license_key),1)]),_:2},1032,["to"])]),o(I,{content:m.row.license_key,placement:"top","popper-class":"fc-tooltip"},{default:i(()=>[o(N,{class:"cursor-pointer p-1 w-6 h-6 flex-none",name:"Copy",onClick:()=>{d.Clipboard.copy(m.row.license_key,{successMessage:d.translate("License Key copied to clipboard"),errorMessage:d.translate("Failed to copy License Key")})}},null,8,["onClick"])]),_:2},1032,["content"])])])]}),_:1},8,["label"]),t.columns.indexOf("product")!==-1?(n(),P(U,{key:0,width:200,label:d.translate("Product")},{default:i(m=>{var _;return[o(B,{class:"link block hover:no-underline",to:{name:"view_license",params:{license_id:(_=m.row)==null?void 0:_.id}}},{default:i(()=>[o(E,{product:m.row.product,hideProductId:!0,hideViewIcon:!0,hideImage:!0},null,8,["product"])]),_:2},1032,["to"])]}),_:1},8,["label"])):y("",!0),t.columns.indexOf("order_id")!==-1?(n(),P(U,{key:1,width:80,label:d.translate("Order ID")},{default:i(m=>[o(B,{class:"link order_id block hover:no-underline relative w-full",to:{name:"view_order",params:{order_id:m.row.order_id}}},{default:i(()=>[o(k,{class:"link absolute left-1/2 top-1/2 translate-x-[calc(-50%-16px)] translate-y-[-50%]",to:{name:"view_order",params:{order_id:m.row.order_id}}},{default:i(()=>[w(" #"+r(m.row.order_id),1)]),_:2},1032,["to"])]),_:2},1032,["to"])]),_:1},8,["label"])):y("",!0),t.columns.indexOf("customer")!==-1?(n(),P(U,{key:2,width:100,label:d.translate("Customer")},{default:i(m=>[o(k,{class:"link",to:{name:"view_customer",params:{customer_id:m.row.customer_id}}},{default:i(()=>{var _,$;return[w(r((($=(_=m.row)==null?void 0:_.customer)==null?void 0:$.full_name)||d.translate("No Name")),1)]}),_:2},1032,["to"])]),_:1},8,["label"])):y("",!0),o(U,{width:90,label:d.translate("Activations")},{default:i(m=>{var _;return[o(B,{class:"link block hover:no-underline relative w-full",to:{name:"view_license",params:{license_id:(_=m.row)==null?void 0:_.id}}},{default:i(()=>[w(r(d.translateNumber(m.row.activation_count))+" / "+r(m.row.limit==0?"Unlimited":m.row.limit),1)]),_:2},1032,["to"])]}),_:1},8,["label"]),t.columns.indexOf("date")!==-1?(n(),P(U,{key:3,width:140,label:d.translate("Date")},{default:i(m=>{var _;return[o(B,{class:"block hover:no-underline w-full",to:{name:"view_license",params:{license_id:(_=m.row)==null?void 0:_.id}}},{default:i(()=>[a("div",null,[a("span",null,r(d.formatDate(m.row.created_at)),1),e[0]||(e[0]=a("span",{class:"text-gray-300 px-2"},"–",-1)),m.row.expiration_date?(n(),u("span",Ot,r(d.formatDate(m.row.expiration_date)),1)):(n(),u("span",Ut,r(d.translate("Lifetime")),1))])]),_:2},1032,["to"])]}),_:1},8,["label"])):y("",!0)]),_:1},8,["data"])]),a("div",Nt,[a("div",Pt,[(n(!0),u(H,null,q(d.formattedLicense,(m,_)=>(n(),u("div",{key:_,class:"fc-table-mobile-row"},[a("div",{class:"fc-table-mobile-header",onClick:$=>l.$router.push({name:"view_license",params:{license_id:m==null?void 0:m.id}})},[a("div",Dt,[a("div",jt,[(n(),P(h,{status:m.status,key:m.id},null,8,["status"]))]),a("div",Rt,r(m.activation_count)+" / "+r(m.limit==0?"Unlimited":m.limit),1)])],8,Bt),a("div",Ft,[a("div",{class:"fc-table-product-col",onClick:$=>l.$router.push({name:"view_license",params:{license_id:m==null?void 0:m.id}})},[o(E,{product:m.product,hideProductId:!0,hideViewIcon:!0,hideImage:!0},null,8,["product"])],8,Ht),a("div",Wt,[a("div",qt,[a("div",zt,[o(k,{class:"link",to:{name:"view_license",params:{license_id:m==null?void 0:m.id}}},{default:i(()=>[w(r(m.license_key),1)]),_:2},1032,["to"])]),o(N,{class:"cursor-pointer p-1 w-6 h-6",name:"Copy",onClick:()=>{d.Clipboard.copy(m.license_key,{successMessage:d.translate("License Key copied to clipboard"),errorMessage:d.translate("Failed to copy License Key")})}},null,8,["onClick"])])])])]))),128))])])]),_:1})}const la=_e(Vt,[["render",Kt]]),Zt={class:"fct_edit_customer_popup"},Qt={class:"form-error-wrap"},Yt=["innerHTML"],Gt={class:"dialog-footer"},je=Object.assign({name:"AddOrEditAddressModal"},{__name:"AddOrEditAddressModal",props:["customer_id","modalAction","address","showAddressModal","order_id","customerAddressModalInfos","showSetAsAlsoCheckbox","closing_modal"],emits:["close-modal","update:refresh-address"],setup(l,{emit:e}){const t=l,C=e;T([]);const c=T(!1),d=T({}),h=T(!1),k=T(!1),N=T(!1);T(null);const I=T({...t.address??{}}),U=Se().ctx;et().onSave(()=>{t.showAddressModal&&["billing","shipping"].includes(t.modalAction.type)&&(t.modalAction.action==="edit"&&U.address.id!==""?g():t.modalAction.action==="create"&&p())});const B=m=>{let _="";for(const $ in m){const V=m[$],M=Object.values(V);_+=M+" </br>"}return _},p=()=>{h.value=!0;const m=I.value;let _={type:t.modalAction.type,customer_id:t.customer_id,order_id:t.order_id??null},$={...m,..._};z.post("customers/"+t.customer_id+"/address",{...$}).then(V=>{N.value&&O(),C("update:refresh-address",!1,V.data),x.success(V.message),d.value={}}).catch(V=>{var M;V.status_code=="422"?(x.validationErrors(V),d.value=V.data):x.error((M=V.data)==null?void 0:M.message)}).finally(()=>{c.value=!1,h.value=!1})},g=()=>{k.value=!0,t.address;let _={...{type:t.modalAction.type,customer_id:t.customer_id,is_primary:t.address.is_primary,id:t.address.id,order_id:t.order_id&&t.address.is_primary==1?t.order_id:null},...I.value};z.put("customers/"+t.customer_id+"/address",{..._}).then($=>{N.value&&O(),C("update:refresh-address",!1,$.data),x.success($.message),d.value={}}).catch($=>{var V;$.status_code=="422"?(x.validationErrors($),d.value=$):x.error((V=$.data)==null?void 0:V.message)}).finally(()=>{c.value=!1,k.value=!1})},O=()=>{const m=t.modalAction.type==="billing"?"shipping":"billing";z.post("customers/"+t.customer_id+"/address",{type:m,...t.address,...I}).then(_=>{x.success(_.message)}).catch(_=>{var $;_.status_code=="422"?(x.validationErrors(_),d.value=_):x.error(($=_.data)==null?void 0:$.message)}).finally(()=>{c.value=!1,h.value=!1})};return ae(()=>t.closing_modal,(m,_)=>{m&&(d.value={})}),(m,_)=>{const $=L("el-form"),V=L("el-checkbox"),M=L("el-button");return n(),u("div",Zt,[o($,{"label-position":"top",class:"fc-compact-form","require-asterisk-position":"right"},{default:i(()=>[o(Y,{label:A(v)("Address Label"),class:X(d.value.hasOwnProperty("label")?"is-error":""),modelValue:I.value.label,"onUpdate:modelValue":_[0]||(_[0]=j=>I.value.label=j)},null,8,["label","class","modelValue"]),o(Y,{label:A(v)("Name"),required:"",class:X(d.value.hasOwnProperty("name")?"is-error":""),modelValue:I.value.name,"onUpdate:modelValue":_[1]||(_[1]=j=>I.value.name=j)},null,8,["label","class","modelValue"]),o(Y,{label:A(v)("Email"),required:"",class:X(d.value.hasOwnProperty("email")?"is-error":""),modelValue:I.value.email,"onUpdate:modelValue":_[2]||(_[2]=j=>I.value.email=j)},null,8,["label","class","modelValue"]),o(Y,{label:A(v)("Phone"),required:"",class:X(d.value.hasOwnProperty("phone")?"is-error":""),modelValue:I.value.phone,"onUpdate:modelValue":_[3]||(_[3]=j=>I.value.phone=j)},null,8,["label","class","modelValue"]),o(ve,{use_additional_address_fields:"",modelValue:I.value,"onUpdate:modelValue":_[4]||(_[4]=j=>I.value=j),validationErrors:d.value},null,8,["modelValue","validationErrors"])]),_:1}),a("div",Qt,[a("p",{class:"form-error-text",innerHTML:B(d.value)},null,8,Yt)]),a("div",Gt,[l.showSetAsAlsoCheckbox?(n(),P(V,{key:0,modelValue:N.value,"onUpdate:modelValue":_[5]||(_[5]=j=>N.value=j),style:{"margin-right":"16px"}},{default:i(()=>[w(r(A(v)("Set as"))+" "+r(l.modalAction.type==="billing"?A(v)("shipping address also"):A(v)("billing address also")),1)]),_:1},8,["modelValue"])):y("",!0),l.address.id?(n(),P(M,{key:1,type:"primary",onClick:_[6]||(_[6]=j=>g()),loading:k.value,disabled:k.value},{default:i(()=>[w(r(A(v)("Update Address")),1)]),_:1},8,["loading","disabled"])):(n(),P(M,{key:2,type:"primary",onClick:_[7]||(_[7]=j=>p()),loading:h.value,disabled:h.value},{default:i(()=>[w(r(A(v)("Add Address")),1)]),_:1},8,["loading","disabled"]))])])}}}),Jt={class:"fc-manage-address-modal"},Xt={key:1,class:"fc-manage-address-wrap"},es=["onClick"],ts={class:"fc-address-action absolute top-0 right-0 pt-2"},ss={class:"more-btn"},ls={key:0,class:"empty-text"},as={key:2,class:"edit_address"},os={key:3,class:"dialog-footer"},ds={name:"ManageAddressModal",props:["showAddressModal","customer_id","modalAction","order_id"],expose:["editAddress"],data(){return{manageAddress:[],address:{},loading:!0,isEditAddress:!1,selectedAddressIndex:null}},computed:{showModal:{get(){return this.showAddressModal},set(l){this.$emit("update:showAddressModal",l)}}},methods:{handleAddressCommand(l){l.action==="edit"?this.editAddress(l.data):l.action==="use"?this.$emit("onAddressSelected",l.data):l.action==="set-as-also"?this.setAsAlso(l.data):l.action==="default"?this.setAddressPrimary(l.data):l.action==="remove"&&this.$confirm("Are you sure want to delete this address?","Warning",{confirmButtonText:this.$t("Yes, Delete!"),cancelButtonText:this.$t("Cancel"),cancelButtonClass:"el-button--small",confirmButtonClass:"el-button--small",type:"warning"}).then(()=>{this.removeAddress(l.data)}).catch(()=>{})},emitAddNewAddress(l,e=[]){this.$emit("addNewAddress",l,"create",e)},emitAddressSelected(){this.showModal=!1,this.$emit("onAddressSelected",this.manageAddress[this.selectedAddressIndex])},editAddress(l){this.address=l,this.isEditAddress=!0},removeAddress(l){let e=l.id;this.$del("customers/"+this.customer_id+"/address",{address:l}).then(t=>{this.getAddresses(),this.$emit("refresh-address"),this.handleSuccess(t.message),e===this.selectedAddressIndex&&(this.selectedAddressIndex=null)}).catch(t=>{var C;t.status_code=="422"?x.validationErrors(t):x.error((C=t.data)==null?void 0:C.message)}).finally(()=>{this.loading=!1})},setAddressPrimary(l){this.$post("customers/"+this.customer_id+"/address/make-primary",{addressId:l.id,type:l.type}).then(e=>{this.$emit("refresh-address"),this.getAddresses(),this.handleSuccess(e.message)}).catch(e=>{var t;e.status_code=="422"?x.validationErrors(e):x.error((t=e.data)==null?void 0:t.message)}).finally(()=>{this.loading=!1})},getTitle(){return this.modalAction.type==="billing"?this.$t("Manage billing address"):this.$t("Manage shipping address")},fetchAddresses(){this.getAddresses(this.modalAction.type)},getAddresses(l="billing"){this.loading=!0,this.selectedOrders=[],this.$get("customers/"+this.customer_id+"/address",{type:this.modalAction.type}).then(e=>{this.manageAddress=e.addresses}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1})},updateAddress(){this.fetchAddresses(),this.$emit("refresh-address")},setAsAlso(l){const e=this.modalAction.type==="billing"?"shipping":"billing",t={...l,type:e,customer_id:this.customer_id,is_primary:0};delete t.id,delete t.created_at,delete t.updated_at,this.emitAddNewAddress(e,t)}}},ns=Object.assign(ds,{setup(l){return(e,t)=>{const C=L("el-skeleton"),c=L("el-tag"),d=L("el-dropdown-item"),h=L("el-dropdown-menu"),k=L("el-dropdown"),N=L("el-icon"),I=L("el-button"),U=L("el-dialog");return n(),u("div",Jt,[o(U,{modelValue:e.showModal,"onUpdate:modelValue":t[5]||(t[5]=E=>e.showModal=E),onClose:t[6]||(t[6]=()=>{e.selectedAddressIndex=null,e.isEditAddress=!1}),onOpen:e.fetchAddresses,title:e.getTitle(),"append-to-body":!0},{default:i(()=>[e.loading?(n(),P(C,{key:0,animated:"",rows:4})):y("",!0),!e.loading&&!e.isEditAddress?(n(),u("div",Xt,[(n(!0),u(H,null,q(e.manageAddress,(E,B)=>(n(),u("div",{class:"fc-manage-address-block-wrap",key:E.id},[a("div",{class:X(`cursor-pointer fc-manage-address-block ${E.is_primary==="1"?"default-address":""}  ${B===e.selectedAddressIndex?"selected":""} `),onClick:()=>{e.selectedAddressIndex=B}},[E.is_primary==="1"?(n(),P(c,{key:0,type:"info",round:""},{default:i(()=>[w(r(e.$t("Default")),1)]),_:1})):y("",!0),a("p",null,[a("strong",null,r(E.name),1),w(" "+r(e.getOrderAddress(E,"",!0)),1)])],10,es),a("div",ts,[o(k,{trigger:"click",class:"fc-more-option-wrap","popper-class":"fc-dropdown",onCommand:e.handleAddressCommand},{dropdown:i(()=>[o(h,null,{default:i(()=>[o(d,{command:{action:"edit",data:E}},{default:i(()=>[w(r(e.$t("Edit")),1)]),_:2},1032,["command"]),o(d,{command:{action:"use",data:E}},{default:i(()=>[w(r(e.$t("Use this address")),1)]),_:2},1032,["command"]),o(d,{command:{action:"set-as-also",data:E}},{default:i(()=>[w(r(l.modalAction.type==="billing"?e.$t("Copy to Shipping"):e.$t("Copy to Billing")),1)]),_:2},1032,["command"]),E.is_primary!=="1"?(n(),u(H,{key:0},[o(d,{command:{action:"default",data:E}},{default:i(()=>[w(r(e.$t("Set as default")),1)]),_:2},1032,["command"]),o(d,{command:{action:"remove",data:E},class:"item-destructive"},{default:i(()=>[w(r(e.$t("Delete")),1)]),_:2},1032,["command"])],64)):y("",!0)]),_:2},1024)]),default:i(()=>[a("span",ss,[o(R,{name:"More"})])]),_:2},1032,["onCommand"])])]))),128)),e.manageAddress.length==0?(n(),u("div",ls,r(l.modalAction.type==="billing"?e.$t("No billing address found."):e.$t("No shipping address found.")),1)):y("",!0)])):y("",!0),e.isEditAddress?(n(),u("div",as,[o(I,{text:"",onClick:t[0]||(t[0]=()=>e.isEditAddress=!1),style:{"margin-bottom":"16px"}},{default:i(()=>[o(N,null,{default:i(()=>[o(A(Be))]),_:1}),w(" "+r(e.$t("Manage address")),1)]),_:1}),o(je,{"onUpdate:refreshAddress":t[1]||(t[1]=E=>{e.isEditAddress=E,e.updateAddress()}),customer_id:l.customer_id,modalAction:l.modalAction,address:e.address,showAddressModal:e.isEditAddress,order_id:l.order_id,onCloseModal:t[2]||(t[2]=E=>e.showModal=!1)},null,8,["customer_id","modalAction","address","showAddressModal","order_id"])])):y("",!0),e.isEditAddress?y("",!0):(n(),u("div",os,[e.selectedAddressIndex!=null?(n(),P(I,{key:0,onClick:t[3]||(t[3]=E=>e.emitAddressSelected())},{default:i(()=>[o(R,{name:"LocationPin"}),w(" "+r(e.$t("Use this address")),1)]),_:1})):y("",!0),o(I,{onClick:t[4]||(t[4]=E=>e.emitAddNewAddress(l.modalAction.type)),type:"primary"},{default:i(()=>[o(R,{name:"Plus"}),w(" "+r(e.$t("Add new address")),1)]),_:1})]))]),_:1},8,["modelValue","onOpen","title"])])}}}),rs={class:"fc-term-container"},is={class:"fc-term-input-wrap"},us={key:0,class:"fc-term-search-result-button-wrap mb-1.5"},cs={class:"search-text"},ms={key:1,class:"fc-term-search-result-list is-scrollable"},ps=["value","checked","onChange"],_s={key:2,class:"empty-text"},fs={key:0,class:"fc-term-selected-list"},vs={class:"fc-term-selected"},hs={class:"text"},gs={class:"fc-term-list-header"},ys={class:"fc-term-input-inline-wrap"},bs={key:0,class:"fc-term-list-header-button-wrap"},Cs={class:"search-text"},As={class:"fc-term-list-wrap is-scrollable"},ws={key:0,class:"fc-term-list newly-added-list"},ks={class:"title"},$s={class:"fc-term-label"},Ms=["value","checked","onChange"],Ls={key:1,class:"fc-term-list to-add-list"},Is={class:"title"},Vs={class:"fc-term-label"},Es=["value","checked","onChange"],Ss={key:2,class:"fc-term-list available-list"},Ts={class:"title"},xs={class:"fc-term-label"},Os=["value","checked","onChange"],Us={key:3,class:"empty-text"},Ns={class:"dialog-footer"},Re={__name:"Modal",props:{bindToType:{type:String},bindToId:{type:[String,Number]},selected_labels:{type:Array,default:[]},labelModalIsOpen:{type:Boolean,default:!1},shouldEnableEditing:{type:Boolean,default:!0}},emits:["update:update-label","close-label-modal"],setup(l,{emit:e}){const t=Se().ctx,C=l,c=e,d=T([]),h=T([]),k=T([]),N=T(),I=T(""),U=T([]),E=T([]),B=T(!1),p=T(!1),g=T(C.labelModalIsOpen),O=T("");ae(()=>C.labelModalIsOpen,s=>{g.value=s,s&&(k.value=[...d.value])});const m=s=>{s.stopPropagation(),s.preventDefault(),$()},_=()=>{t.$get("labels").then(s=>{U.value=s.labels,d.value=C.selected_labels}).catch(s=>{var b;s.status_code=="422"?x.validationErrors(s):x.error((b=s.data)==null?void 0:b.message)}).finally(()=>{})},$=(s="")=>{const b=I.value||O.value;t.$post("labels",{value:b,bind_to_type:C.bindToType,bind_to_id:C.bindToId}).then(D=>{I.value="",O.value="",U.value.push(D.data),s!=="insideModal"?d.value.push(D.data.id):h.value.push(D.data.id),c("update:update-label",d.value)}).catch(D=>{x.error(D)})};ae(I,s=>{s?(s=s.trim(),E.value=U.value.filter(b=>b.value.toLowerCase().includes(s.toLowerCase())),B.value=!0):(E.value=[],B.value=!1)});const V=s=>{const b=d.value.indexOf(s);b===-1?d.value.push(s):d.value.splice(b,1),c("update:update-label",d.value)},M=s=>{const b=k.value.indexOf(s);b===-1?k.value.push(s):k.value.splice(b,1)},j=s=>{const b=h.value.indexOf(s);b===-1?h.value.push(s):h.value.splice(b,1)},ue=()=>{d.value=[...k.value,...h.value],h.value=[],c("update:update-label",d.value),te()},oe=s=>{const b=d.value.indexOf(s);b!==-1&&(d.value.splice(b,1),c("update:update-label",d.value))},de=s=>{B.value&&!N.value.$el.contains(s.target)&&!p.value.contains(s.target)&&(B.value=!1,I.value="")},ne=K(()=>U.value.filter(s=>d.value.includes(s.id))),ee=K(()=>U.value.filter(s=>h.value.includes(s.id))),G=K(()=>U.value.filter(s=>k.value.includes(s.id)).filter(s=>s.value.toLowerCase().includes(O.value.trim().toLowerCase()))),J=K(()=>U.value.filter(s=>!k.value.includes(s.id)).filter(s=>!h.value.includes(s.id)).filter(s=>s.value.toLowerCase().includes(O.value.trim().toLowerCase())).sort((s,b)=>s.value.localeCompare(b.value))),te=()=>{c("close-label-modal")},f=K(()=>{const s=O.value.trim().toLowerCase(),b=I.value.trim().toLowerCase();return(s||b)===""||E.value.some(D=>D.value.toLowerCase()===s||D.value.toLowerCase()===b)||G.value.some(D=>D.value.toLowerCase()===s||D.value.toLowerCase()===b)||J.value.some(D=>D.value.toLowerCase()===s||D.value.toLowerCase()===b)});return pe(()=>{_(),document.addEventListener("click",de)}),qe(()=>{document.removeEventListener("click",de)}),(s,b)=>{const D=L("el-input"),Z=L("el-button"),Q=L("el-dialog");return n(),u("div",rs,[a("div",is,[l.shouldEnableEditing?(n(),P(D,{key:0,ref_key:"inputRef",ref:N,modelValue:I.value,"onUpdate:modelValue":b[0]||(b[0]=S=>I.value=S),onKeydown:ze(m,["enter"])},null,8,["modelValue"])):y("",!0),B.value?(n(),u("div",{key:1,class:"fc-term-search-result",ref_key:"suggestionsRef",ref:p,style:Ke(I.value==""?"display: none":"")},[I.value!==""&&!f.value?(n(),u("div",us,[o(Z,{type:"info",plain:"",onClick:$,size:"small"},{default:i(()=>[o(R,{name:"PlusCircle"}),w(" "+r(s.$t("Add"))+" ",1),a("span",cs,'"'+r(I.value)+'"',1)]),_:1})])):y("",!0),E.value.length>0?(n(),u("ul",ms,[(n(!0),u(H,null,q(E.value,(S,W)=>(n(),u("li",{key:W},[a("label",null,[a("input",{type:"checkbox",value:S.id,checked:d.value.includes(S.id),onChange:se=>V(S.id)},null,40,ps),w(" "+r(S.value),1)])]))),128))])):y("",!0),E.value.length===0?(n(),u("p",_s,r(s.$t("No labels found.")),1)):y("",!0)],4)):y("",!0)]),ne.value.length>0?(n(),u("ul",fs,[(n(!0),u(H,null,q(ne.value,S=>(n(),u("li",{key:S.id},[a("div",vs,[a("div",hs,r(S.value),1),l.shouldEnableEditing?(n(),P(R,{key:0,name:"Cross",onClick:W=>oe(S.id)},null,8,["onClick"])):y("",!0)])]))),128))])):y("",!0),o(Q,{"before-close":te,"append-to-body":!0,width:"45%",modelValue:g.value,"onUpdate:modelValue":b[3]||(b[3]=S=>g.value=S),title:s.$t("Add labels"),class:"fc-add-labels-modal"},{default:i(()=>[a("div",gs,[a("div",ys,[o(D,{modelValue:O.value,"onUpdate:modelValue":b[1]||(b[1]=S=>O.value=S),placeholder:s.$t("Search to find or create labels")},{prefix:i(()=>[o(R,{name:"Search"})]),_:1},8,["modelValue","placeholder"])]),O.value!==""&&!f.value?(n(),u("div",bs,[o(Z,{type:"info",plain:"",onClick:b[2]||(b[2]=S=>$("insideModal")),size:"small"},{default:i(()=>[o(R,{name:"PlusCircle"}),w(" "+r(s.$t("Add"))+" ",1),a("span",Cs,'"'+r(O.value)+'"',1)]),_:1})])):y("",!0)]),a("div",As,[ee.value.length>0?(n(),u("ul",ws,[a("li",ks,r(s.$t("Newly added")),1),(n(!0),u(H,null,q(ee.value,S=>(n(),u("li",{key:S.id},[a("label",$s,[a("input",{type:"checkbox",value:S.id,checked:h.value.includes(S.id),onChange:W=>j(S.id)},null,40,Ms),w(" "+r(S.value),1)])]))),128))])):y("",!0),G.value.length>0?(n(),u("ul",Ls,[a("li",Is,r(s.$t("To add")),1),(n(!0),u(H,null,q(G.value,S=>(n(),u("li",{key:S.id},[a("label",Vs,[a("input",{type:"checkbox",value:S.id,checked:k.value.includes(S.id),onChange:W=>M(S.id)},null,40,Es),w(" "+r(S.value),1)])]))),128))])):y("",!0),J.value.length>0?(n(),u("ul",Ss,[a("li",Ts,r(s.$t("Available")),1),(n(!0),u(H,null,q(J.value,S=>(n(),u("li",{key:S.id},[a("label",xs,[a("input",{type:"checkbox",value:S.id,checked:k.value.includes(S.id),onChange:W=>M(S.id)},null,40,Os),w(" "+r(S.value),1)])]))),128))])):y("",!0),G.value.length===0&&J.value.length===0&&ee.value.length===0?(n(),u("p",Us,r(s.$t("No labels found.")),1)):y("",!0)]),a("div",Ns,[o(Z,{onClick:te},{default:i(()=>[w(r(s.$t("Cancel")),1)]),_:1}),o(Z,{type:"primary",onClick:ue},{default:i(()=>[w(r(s.$t("Done")),1)]),_:1})])]),_:1},8,["modelValue","title"])])}}},Ps={class:"fc-admin-sidebar-item"},Bs={name:"Labels",props:{bindToType:{type:String},bindToId:{type:[String,Number]},selectedLabels:{type:Array,default:()=>[]},shouldEnableEditing:{type:Boolean,default:!0}},components:{IconButton:fe,LabelModal:Re,DynamicIcon:R},data(){return{labelModalIsOpen:!1}},methods:{openLabelModal(){this.labelModalIsOpen=!0},updateLabel(l){this.bindToId&&this.bindToType&&this.$post("labels/update-label-selections",{bind_to_type:this.bindToType,bind_to_id:this.bindToId,selectedLabels:l}).then(e=>{x.success(e.message)}).catch(e=>{x.error(e.message)}),this.$emit("update:update-label",l)},closeLabel(){this.labelModalIsOpen=!1}},mounted(){}},aa=Object.assign(Bs,{setup(l){return(e,t)=>(n(),P(De,{permission:"labels/manage"},{default:i(()=>[a("div",null,[o(Ue,null,{default:i(()=>[o(xe,{title:e.$t("Labels"),border_bottom:"",title_size:"small"},{action:i(()=>[l.shouldEnableEditing?(n(),P(fe,{key:0,size:"x-small",bg:"transparent",tag:"button",border:"transparent",onClick:e.openLabelModal},{default:i(()=>[o(R,{name:"Edit"})]),_:1},8,["onClick"])):y("",!0)]),_:1},8,["title"]),o(Oe,null,{default:i(()=>[a("div",Ps,[o(Re,{bindToType:l.bindToType,bindToId:l.bindToId,labelModalIsOpen:e.labelModalIsOpen,selected_labels:l.selectedLabels,shouldEnableEditing:l.shouldEnableEditing,"onUpdate:updateLabel":e.updateLabel,onCloseLabelModal:t[0]||(t[0]=C=>e.labelModalIsOpen=!1)},null,8,["bindToType","bindToId","labelModalIsOpen","selected_labels","shouldEnableEditing","onUpdate:updateLabel"])])]),_:1})]),_:1})])]),_:1}))}}),Ds={class:"fc-customer-edit-modal"},js={key:1,class:"fc-form-group"},Rs={class:"label"},Fs={style:{display:"flex","align-items":"center",gap:"10px"}},Hs={class:"select-use-option"},Ws={class:"fc-compact-form"},qs={class:"form-heading"},zs={class:"fc-compact-form fc-customer-address-section"},Ks={style:{"margin-top":"20px"}},Zs={class:"form-error-wrap"},Qs={class:"form-error-text"},Ys={class:"dialog-footer"},Gs={key:3,class:"dialog-footer"},Js={__name:"ChangeOrderCustomer",props:{orderId:{type:[String,Number],default:null,required:!0}},setup(l){const e=l,t=T(null),C=T([]),c=T(!1),d=T(!1),h=T({}),k=T({id:"",email:"",full_name:"",state:"",city:"",country:"",postcode:"",country_name:"",contact_id:"",user_id:"",wp_user:""}),N=p=>{if(!p){C.value=[];return}z.get("customers/",{search:p}).then(g=>{C.value=g.customers.data}).finally(()=>{})},I=()=>{if(!t.value){x.error(v("Please select a customer"));return}z.post("orders/"+e.orderId+"/change-customer",{customer_id:t.value}).then(p=>{x.success(p.message),setTimeout(()=>{window.location.reload()},300)}).catch(p=>{if(p.message)return x.error(p.message);console.log("errors",p)}).finally(()=>{console.log("finally")})},U=()=>{z.post("orders/"+e.orderId+"/create-and-change-customer",k.value).then(p=>{x.success(p.message),setTimeout(()=>{window.location.reload()},300),h.value={},d.value=!1}).catch(p=>{if(p.message)return x.error(p.message);h.value=p}).finally(()=>{})},E=()=>{d.value=!0},B=()=>{d.value=!1};return(p,g)=>{const O=L("el-button"),m=L("el-option"),_=L("el-select"),$=L("el-checkbox");return n(),u("div",Ds,[d.value?(n(),u("div",{key:0,onClick:B,style:{"margin-bottom":"10px"}},[o(O,{text:"",style:{"margin-top":"0"}},{default:i(()=>[o(R,{name:"ArrowLeft"}),w(" "+r(A(v)("Back")),1)]),_:1})])):y("",!0),d.value?y("",!0):(n(),u("div",js,[a("label",Rs,[w(r(A(v)("Select Customer"))+" ",1),o(O,{text:"",class:"fc-create-customer-btn",onClick:Ee(E,["prevent"])},{default:i(()=>[o(R,{name:"Plus"}),w(" "+r(A(v)("Add New Customer")),1)]),_:1})]),a("div",Fs,[o(_,{modelValue:t.value,"onUpdate:modelValue":g[0]||(g[0]=V=>t.value=V),remote:!0,"remote-method":N,loading:c.value,filterable:"",clearable:"",placeholder:A(v)("Type to search user"),style:{width:"100%"}},{default:i(()=>[(n(!0),u(H,null,q(C.value,V=>(n(),P(m,{key:V.id,label:V.full_name,value:V.id},{default:i(()=>[a("div",Hs,[a("span",null,r(V.full_name),1),a("span",null,r(V.email),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","loading","placeholder"])])])),d.value?(n(),u(H,{key:2},[a("div",Ws,[o(Y,{label:A(v)("Full Name"),modelValue:k.value.full_name,"onUpdate:modelValue":g[1]||(g[1]=V=>k.value.full_name=V)},null,8,["label","modelValue"]),o(Y,{label:A(v)("Email"),modelValue:k.value.email,"onUpdate:modelValue":g[2]||(g[2]=V=>k.value.email=V)},null,8,["label","modelValue"])]),a("h4",qs,r(A(v)("Address")),1),a("div",zs,[o(ve,{modelValue:k.value,"onUpdate:modelValue":g[3]||(g[3]=V=>k.value=V)},null,8,["modelValue"]),a("div",Ks,[o($,{"true-value":"yes","false-value":"no",modelValue:k.value.wp_user,"onUpdate:modelValue":g[4]||(g[4]=V=>k.value.wp_user=V)},{default:i(()=>[o(Pe,{title:A(v)("Create as wordpress user"),content:A(v)("We will create a new user for this customer. If a user with the same email already exists, we will associate the customer with that existing user.")},null,8,["title","content"])]),_:1},8,["modelValue"])]),a("div",Zs,[(n(!0),u(H,null,q(h.value,V=>(n(),u("p",Qs,r(V.required),1))),256))])]),a("div",Ys,[o(O,{onClick:g[5]||(g[5]=V=>p.$emit("close"))},{default:i(()=>[w(r(A(v)("Cancel")),1)]),_:1}),o(O,{type:"primary",onClick:U},{default:i(()=>[w(r(A(v)("Create & Attach Customer")),1)]),_:1})])],64)):y("",!0),d.value?y("",!0):(n(),u("div",Gs,[o(O,{type:"primary",onClick:I},{default:i(()=>[w(r(A(v)("Create & Attach Customer")),1)]),_:1})]))])}}},Xs={class:"fc-admin-sidebar"},el={class:"more-btn"},tl={key:0,class:"fc-admin-sidebar-item"},sl={class:"name"},ll={class:"email"},al={class:"fc-admin-sidebar-item"},ol={class:"fc-profile-card"},dl=["src","alt"],nl={key:0,class:"fc-profile-details"},rl={class:"title"},il={class:"text"},ul={key:0},cl={class:"text"},ml={key:0,class:"user-info mt-2"},pl=["href"],_l={class:"fc-admin-sidebar-item mt-5"},fl={class:"fc-contact-info-list"},vl={class:"flex items-center justify-between gap-2"},hl=["href"],gl={class:"fc-admin-sidebar-item mt-5"},yl={class:"sidebar-title"},bl={key:0,class:"fc-address-copy-wrap"},Cl={class:"text"},Al={key:0,class:"pr-1"},wl=["innerHTML"],kl={key:1,class:"mt-4"},$l=["href"],Ml={key:1,class:"no-address-text"},Ll={class:"fc-admin-sidebar-item mt-5"},Il={class:"sidebar-title"},Vl={key:0,class:"fc-address-copy-wrap"},El={class:"text"},Sl={key:0,class:"pr-1"},Tl=["innerHTML"],xl={key:1,class:"mt-4"},Ol=["href"],Ul={key:2,class:"mt-4"},Nl={class:"m-0"},Pl={key:1,class:"no-address-text"},Bl={class:"fluent-cart-admin-pages"},oa={__name:"OrderCustomerInformation",props:{order:{type:Object,default:()=>({})},shouldEnableEditing:{type:Boolean,default:!0}},emits:["onAddressSelected","onAddressRemove"],setup(l,{emit:e}){var ee,G,J,te;const t=l,C=T([]),c=T((G=(ee=t.order)==null?void 0:ee.customer)!=null&&G.id?t.order.customer:null),d=T((J=t.order)!=null&&J.billing_address?t.order.billing_address:null),h=T((te=t.order)!=null&&te.shipping_address?t.order.shipping_address:null),k=e,N=T(!1),I=f=>{f==="remove_customer"&&U(),f==="change_customer"?N.value=!0:f==="edit_customer"?$("edit"):f==="manage_billing_address"?j("billing"):f==="manage_shipping_address"&&j("shipping")},U=()=>{t.order.customer_id="",t.order.customer={},c.value=null,d.value=null,h.value=null,k("onAddressRemove"),setTimeout(()=>{oe()},50)},E=(f,s)=>{z.get("customers/",{search:f,with:["shipping_address","billing_address"]}).then(b=>{let D=b.customers.data;C.value=D;let Z=D.map(se=>({id:se.id,value:se.full_name,email:se.email})),Q=jQuery(".fc-customer-autocomplete-dropdown"),S=jQuery(".el-autocomplete-suggestion__list"),W="empty-text";D.length<1?Q.length>0&&(Q.addClass("is-empty-customer"),S.children(`.${W}`).length||S.prepend(`<li class="${W}">No customer found.</li>`)):Q.length>0&&(Q.removeClass("is-empty-customer"),S.children(`.${W}`).remove()),s(Z)}).catch(b=>{x.error(b)})},B=f=>{const s=C.value.find(b=>b.id===f.id)??null;p(s)},p=f=>{c.value=f,t.order.customer=f,t.order.customer_id=f.id,c.value!==null&&(g(),O())},g=()=>{const f=c.value.billing_address;f&&(Array.isArray(f)&&f.length>0?(d.value=f[0],d.value=f.find(s=>s.is_primary.toString()==="1")??d.value):d.value=null,k("onAddressSelected",d.value))},O=()=>{const f=c.value.shipping_address;f&&(Array.isArray(f)&&f.length>0?(h.value=f[0],h.value=f.find(s=>s.is_primary.toString()==="1")??h.value):h.value=null,k("onAddressSelected",h.value))},m=f=>{f&&z.post(`orders/${t.order.id}/update-address-id`,{address_id:f.id,address_type:f.type}).then(s=>{x.success(s.message),f.type==="shipping"?h.value=f:d.value=f,M.value.showModal=!1,k("onAddressSelected",f)}).catch(s=>{x.error(s)})},_=T({showModal:!1,action:"create",title:v("Create New Customer"),customer:{},manageWpUser:"yes"}),$=(f="create")=>{const s=_.value;s.showModal=!0,s.action=f==="create"?"create":"edit",s.title=f==="create"?v("Create New Customer"):v("Edit Customer Information"),s.customer_id=f==="create"?null:c.value.id,s.customer=f==="create"?{}:c.value,s.manageWpUser=f==="create"?"yes":c.value.user_id==="0"?"no":"yes",_.value=s},V=T(!0),M=T({showManageAddressModal:!1,showModal:!1,modalAction:{type:"billing",action:"create"},title:"",customer_id:"",address_id:"",address:{},address_mock:{name:"",phone:"",email:"",address_1:"",address_2:"",city:"",state:"",postcode:"",country:"",is_primary:"0"}}),j=(f="billing",s="edit")=>{M.value.showManageAddressModal=!0,M.value.modalAction.type=f,M.value.modalAction.action=s},ue=(f="billing",s="create",b={})=>{Object.keys(b).length>0?(M.value.address={...b},V.value=!1):M.value.address={...M.value.address_mock},M.value.showModal=!0,M.value.modalAction.type=f,M.value.modalAction.action=s,M.value.showManageAddressModal=!1},oe=()=>{let f=jQuery(".el-autocomplete-suggestion__wrap");if(f.length>0){let s=jQuery('<div class="fc-create-customer-button-wrap"><button class="el-button el-button--info el-button--small is-plain"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M1.5 7H12.5M7 1.5V12.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg> Create a new customer</button></div>').on("click",()=>{$()});f.prepend(s)}},de=()=>M.value.modalAction.action==="create"?M.value.modalAction.type==="billing"?v("Add new billing address"):v("Add new shipping Address"):M.value.modalAction.type==="billing"?v("Edit billing address"):v("Edit shipping address"),ne=(f,s)=>{M.value.modalAction.type==="billing"?d.value=s:h.value=s,M.value.showModal=f,M.value.showManageAddressModal=!0,m(s)};return ae(t.order,(f,s)=>{f.customer_id!==s.customer_id&&U()}),pe(()=>{oe()}),(f,s)=>{var ge;const b=L("el-dropdown-item"),D=L("el-dropdown-menu"),Z=L("el-dropdown"),Q=L("el-autocomplete"),S=L("router-link"),W=L("el-icon"),se=L("el-button"),he=L("el-dialog");return n(),u(H,null,[a("div",Xs,[o(Ue,null,{default:i(()=>[o(xe,{title:A(v)("Customer Information"),title_size:"small",border_bottom:""},{action:i(()=>[c.value&&l.shouldEnableEditing?(n(),P(Z,{key:0,trigger:"click",class:"fc-more-option-wrap","popper-class":"fc-dropdown",onCommand:I},{dropdown:i(()=>[o(D,null,{default:i(()=>[o(b,{command:"edit_customer"},{default:i(()=>[w(r(A(v)("Edit customer information")),1)]),_:1}),o(b,{command:"manage_shipping_address"},{default:i(()=>[w(r(A(v)("Manage shipping address")),1)]),_:1}),o(b,{command:"manage_billing_address"},{default:i(()=>[w(r(A(v)("Manage billing address")),1)]),_:1}),l.order.id?(n(),P(b,{key:0,command:"change_customer"},{default:i(()=>[w(r(A(v)("Change customer")),1)]),_:1})):y("",!0),l.order.id?y("",!0):(n(),P(b,{key:1,command:"remove_customer"},{default:i(()=>[w(r(A(v)("Remove customer")),1)]),_:1}))]),_:1})]),default:i(()=>[a("span",el,[o(R,{name:"More"})])]),_:1})):y("",!0)]),_:1},8,["title"]),o(Oe,null,{default:i(()=>{var F,ye,be,Ce,Ae,we,ke,$e,Me,Le,Ie,Ve;return[c.value===null?(n(),u("div",tl,[o(Q,{"popper-class":"fc-customer-autocomplete-dropdown",clearable:"",modelValue:l.order.customer.full_name,"onUpdate:modelValue":s[0]||(s[0]=le=>l.order.customer.full_name=le),"fetch-suggestions":E,placeholder:A(v)("Search or create a customer"),disabled:!1,onSelect:B},{prefix:i(()=>[o(R,{name:"Search"})]),default:i(le=>[a("span",sl,r(le.item.value),1),a("span",ll,r(le.item.email),1)]),_:1},8,["modelValue","placeholder"])])):(n(),u(H,{key:1},[a("div",al,[a("div",ol,[a("div",{class:"fc-profile-image cursor-pointer",onClick:s[1]||(s[1]=le=>f.$router.push({name:"view_customer",params:{customer_id:c.value.id}}))},[a("img",{src:c.value.photo,alt:(F=c.value)==null?void 0:F.full_name},null,8,dl)]),c.value.id?(n(),u("div",nl,[a("div",rl,[o(S,{to:{name:"view_customer",params:{customer_id:c.value.id}}},{default:i(()=>[w(r(c.value.full_name),1)]),_:1},8,["to"])]),a("span",il,[c.value.purchase_count>0?(n(),u("span",ul,r(A(Te)(c.value.purchase_count)),1)):y("",!0),w(" "+r(f.$n("Order","Orders",c.value.purchase_count??0,"No Order")),1)]),a("span",cl,r(A(tt)((ye=c.value)==null?void 0:ye.ltv,!0))+" "+r(A(v)("Lifetime Value")),1)])):y("",!0)]),l.order.customer.user_link?(n(),u("div",ml,[w(r(A(v)("WP User:"))+" ",1),a("a",{href:l.order.customer.user_link,target:"_blank",class:"inline-flex items-center gap-1 dark:text-gray-100 text-primary-500 focus:shadow-none hover:!underline"},[w(" #"+r(l.order.customer.user_id)+" ",1),o(R,{name:"Redirect",class:"w-2.5 h-2.5 text-primary-500 dark:text-gray-200"})],8,pl)])):y("",!0)]),a("div",_l,[a("ul",fl,[a("li",null,[a("div",vl,[a("a",{class:"text",href:"mailto:"+((be=l.order.customer)==null?void 0:be.email)},r(c.value.email),9,hl),o(re,{text:c.value.email,showMode:"basic_copy_btn",tooltipText:A(v)("Copy email")},null,8,["text","tooltipText"])])])])]),a("div",gl,[a("h4",yl,r(A(v)("Shipping Address")),1),h.value!=null?(n(),u("div",bl,[a("span",Cl,[h.value.name?(n(),u("strong",Al,r(h.value.name),1)):y("",!0),a("span",{class:"break-all",innerHTML:f.getOrderAddress({...h.value},"shipping",!0)},null,8,wl),(we=(Ae=(Ce=h.value)==null?void 0:Ce.meta)==null?void 0:Ae.other_data)!=null&&we.phone?(n(),u("div",kl,[a("a",{href:"tel:"+h.value.meta.other_data.phone,class:"text-system-dark"},r(h.value.meta.other_data.phone),9,$l)])):y("",!0)]),o(re,{text:f.getOrderAddress({...h.value},"shipping"),showMode:"basic_copy_btn",tooltipText:A(v)("Copy address")},null,8,["text","tooltipText"])])):(n(),u("p",Ml,r(A(v)("No shipping address provided")),1))]),a("div",Ll,[a("h4",Il,r(A(v)("Billing Address")),1),d.value!=null?(n(),u("div",Vl,[a("span",El,[d.value.name?(n(),u("strong",Sl,r(d.value.name),1)):y("",!0),a("span",{class:"break-all",innerHTML:f.getOrderAddress({...d.value},"billing",!0)},null,8,Tl),(Me=($e=(ke=d.value)==null?void 0:ke.meta)==null?void 0:$e.other_data)!=null&&Me.phone?(n(),u("div",xl,[a("a",{href:"tel:"+d.value.meta.other_data.phone,class:"text-system-dark"},r(d.value.meta.other_data.phone),9,Ol)])):y("",!0),(Ve=(Ie=(Le=d.value)==null?void 0:Le.meta)==null?void 0:Ie.other_data)!=null&&Ve.company_name?(n(),u("div",Ul,[a("b",null,r(A(v)("Company")),1),a("p",Nl,r(d.value.meta.other_data.company_name),1)])):y("",!0)]),o(re,{text:f.getOrderAddress({...d.value},"billing"),showMode:"basic_copy_btn",tooltipText:A(v)("Copy address")},null,8,["text","tooltipText"])])):(n(),u("p",Pl,r(A(v)("No shipping address provided")),1))])],64))]}),_:1})]),_:1})]),o(it,{onSelectNewCustomer:s[2]||(s[2]=F=>{p(F),_.value.showModal=!1}),customerModalInfos:_.value,customer_id:_.value.customer_id,customer:_.value.customer,onCloseModal:s[3]||(s[3]=F=>_.value.showModal=!1)},null,8,["customerModalInfos","customer_id","customer"]),o(ns,{modalAction:M.value.modalAction,onOnAddressSelected:m,"onUpdate:showAddressModal":s[4]||(s[4]=F=>M.value.showManageAddressModal=F),showAddressModal:M.value.showManageAddressModal,customer_id:(ge=c.value)==null?void 0:ge.id,order_id:l.order.id,onAddNewAddress:ue},null,8,["modalAction","showAddressModal","customer_id","order_id"]),o(he,{"show-close":!0,modelValue:M.value.showModal,"onUpdate:modelValue":s[7]||(s[7]=F=>M.value.showModal=F),"append-to-body":!0,title:de()},{default:i(()=>{var F;return[a("div",Bl,[o(se,{text:"",onClick:s[5]||(s[5]=()=>{M.value.showManageAddressModal=!0,M.value.showModal=!1}),class:"mb-4"},{default:i(()=>[o(W,null,{default:i(()=>[o(A(Be))]),_:1}),w(" "+r(f.$t("Manage address")),1)]),_:1}),o(je,{"onUpdate:refreshAddress":ne,customerAddressModalInfos:M.value,customer_id:c.value.id,modalAction:M.value.modalAction,address:M.value.address,showAddressModal:M.value.showModal,showSetAsAlsoCheckbox:V.value,order_id:(F=l.order)==null?void 0:F.id,onCloseModal:s[6]||(s[6]=()=>{M.value.showModal=!1,M.value.showManageAddressModal=!0})},null,8,["customerAddressModalInfos","customer_id","modalAction","address","showAddressModal","showSetAsAlsoCheckbox","order_id"])])]}),_:1},8,["modelValue","title"]),l.order.id?(n(),P(he,{key:0,modelValue:N.value,"onUpdate:modelValue":s[9]||(s[9]=F=>N.value=F),title:f.$t("Change Customer")},{default:i(()=>[o(Js,{"order-id":l.order.id,onClose:s[8]||(s[8]=F=>N.value=!1)},null,8,["order-id"])]),_:1},8,["modelValue","title"])):y("",!0)],64)}}};export{la as L,sa as O,It as P,De as _,it as a,je as b,ns as c,aa as d,oa as e,Js as f,ct as p};
