import{a as m,c,o as r,f as s,d as n,F as S,h as L,t as o,w as h,u as M,b as A,e as g,g as v,r as pt,X as q,W as F,v as ft,T as bt,n as O,m as yt,l as gt,i as Z,p as lt,j as ue,aF as vt,aG as wt,a4 as kt,q as $t}from"./vue.esm-bundler-Dk_uEpzT.js";import{d as H,p as G,t as b,B as V,a as Ct,I as Q,P as X,S as At}from"./Badge-Bo-XvQ4z.js";import{f as Mt}from"./common-BfEhDM5f.js";import{_ as x}from"./DynamicIcon-y7KGaMbT.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as ot,C as St,b as ee,c as ie}from"./CopyToClipboard-CdYJKbOz.js";import{u as Dt,S as j,c as Pt,d as Tt}from"./Str-Dyh8Kh0u.js";import{b as rt,E as le,o as W,v as me,x as he,y as _e,A as pe,B as fe,q as Et}from"./index-CCpw3JZM.js";import It from"./ArrowDown-DZBSKU54.js";import Lt from"./ArrowUp-DL4wXAyW.js";import{n as I}from"./Notify-2R1_bNii.js";import{R as K}from"./Rest-U7WPPDzn.js";import{a as be,b as ye,c as ge,d as ve,E as we,e as ke,f as $e,g as Ce,h as Ae,i as Me,j as Se,k as De,l as Pe,m as Te,n as Ee,o as Ie,p as Le,q as Ve,r as Be,s as xe,t as Ne,u as Ue,v as Fe,w as He,x as Oe,y as qe,B as Re,C as ze,D as Ye,F as je,G as Ke,H as Ze,I as We,J as Ge,K as Je,L as Qe,N as Xe,O as et,P as tt,Q as st,R as at,S as it}from"./index-CK7lbFBr.js";import{v as Vt,i as Bt}from"./defaults-9MvV4Ei1.js";import"./Arr-MwYQQ3qa.js";import"./dayjs.min-2rai63wT.js";import"./timezone-C2U15obx.js";import"./Translator-Cu_KObU0.js";import"./index-BScAXxPc.js";const xt={class:"fc-customer-dashboard-table"},Nt={class:"order-content-only-mobile",role:"list"},Ut=["aria-label"],Ft={class:"item-header"},Ht={class:"sr-only"},Ot={class:"block truncate max-w-[100px]"},qt={class:"text-system-light text-sm"},Rt={class:"item-body"},zt={class:"fc-customer-orders-items fc-customer-orders-items-2"},Yt={key:0},jt={class:"text-gray-800 text-sm"},Kt={key:0,class:"fc-customer-orders-items-sub-title !max-w-full"},Zt={class:"fc-popover-content"},Wt={class:"fc-product-orders-items"},Gt={class:"variation-title"},Jt={key:0},Qt=["aria-label"],Xt={class:"item-footer"},es={class:"item-footer-content"},ts=["innerHTML"],ss={key:1,class:"text-center p-5",role:"note"},as={class:"invoice-id-date"},is={class:"block truncate max-w-[100px]"},ls={class:"text"},os={class:"fc-customer-orders-items"},rs={key:0,class:"fc-customer-orders-items-sub-title"},ns={class:"fc-popover-content"},ds={class:"fc-product-orders-items"},cs={class:"variation-title"},us={key:0},ms=["aria-label"],hs=["innerHTML"],nt={__name:"OrderTable",props:{orders:{type:Array,required:!0},showTableHeader:{type:Boolean,default:!1},itemsColumnWidth:{type:Number,default:300},showInvoiceButton:{type:Boolean,default:!0}},setup(e){const a=t=>{const l=t.order_items.find(d=>d.payment_type==="subscription"),u=t.order_items.some(d=>d.payment_type==="adjustment");return t.order_items.filter(d=>!(d.payment_type==="signup_fee"||(d.payment_type==="adjustment"&&l&&(d.product.detail.featured_media=i(l)),u&&d.payment_type==="subscription")))},i=t=>{var l,u;return t.variants&&t.variants.media?(u=(l=t==null?void 0:t.variants)==null?void 0:l.media)==null?void 0:u.meta_value[0].url:t.variants&&!t.variants.media&&t.product.detail&&t.product.detail.featured_media&&t.product.detail.featured_media!==null&&typeof t.product.detail.featured_media=="object"?t.product.detail.featured_media.url:y},y=fluentcart_customer_profile_vars.placeholder_image;return(t,l)=>{const u=m("router-link"),d=m("el-popover"),f=m("el-table-column"),k=m("el-table");return r(),c("div",xt,[s("div",Nt,[e.orders.length>0?(r(!0),c(S,{key:0},L(e.orders,_=>(r(),c("div",{class:"order-content-only-mobile-item",key:_.id,role:"listitem","aria-label":t.$t("Order summary for order number %s",_.invoice_no)},[s("div",Ft,[s("h3",Ht,o(t.$t("Order Number")),1),n(u,{class:"link text-sm",to:{name:"view_order",params:{order_id:_.uuid}},"aria-label":t.$t("View order")+" #"+_.invoice_no},{default:h(()=>[s("span",Ot,"#"+o(_.invoice_no),1)]),_:2},1032,["to","aria-label"]),s("span",qt,o(M(H)(_.created_at)),1)]),s("div",Rt,[s("div",zt,[a(_).length===1?(r(),c("div",Yt,[n(u,{to:{name:"view_order",params:{order_id:_.uuid}},class:"fc-customer-orders-items-title"},{default:h(()=>{var p,w;return[v(o((p=a(_)[0])==null?void 0:p.post_title)+" ",1),s("span",jt," – "+o((w=a(_)[0])==null?void 0:w.title),1)]}),_:2},1032,["to"]),_.renewals_count>0?(r(),c("span",Kt,o(M(G)("%s Renewal","%s Renewals",_.renewals_count)),1)):g("",!0)])):(r(),A(u,{key:1,to:{name:"view_order",params:{order_id:_.uuid}},"aria-label":t.$t("View order")+" #"+_.invoice_no},{default:h(()=>[v(o(M(b)("%s items",a(_).length)),1)]),_:2},1032,["to","aria-label"])),a(_).length>1?(r(),A(d,{key:2,placement:"top",width:360,trigger:"click"},{reference:h(()=>[s("div",{class:"fc-action-link-btn","aria-expanded":!1,"aria-label":t.$t("Show items for order %s",[_.invoice_no]),role:"button"},[n(x,{name:"ChevronDown"})],8,Qt)]),default:h(()=>[s("div",Zt,[s("div",Wt,[(r(!0),c(S,null,L(a(_),p=>(r(),c("p",{key:p.id},[n(u,{to:{name:"view_order",params:{order_id:_.uuid}},class:"title"},{default:h(()=>[v(o(p.post_title),1)]),_:2},1032,["to"]),s("span",Gt,[s("b",null,o(p.quantity),1),v(" x "+o(p.title),1)])]))),128)),a(_).length===0?(r(),c("p",Jt,o(M(b)("No products found!")),1)):g("",!0)])])]),_:2},1024)):g("",!0)])]),s("div",Xt,[s("div",es,[n(V,{type:_.status,size:"small"},{default:h(()=>[v(o(_.status),1)]),_:2},1032,["type"]),s("span",{innerHTML:t.formatNumber(_.total_amount,!0,!1,_.currency)},null,8,ts)])])],8,Ut))),128)):(r(),c("div",ss,o(M(b)("Your purchases will be shown here!")),1))]),n(k,{class:"order-content-only-desktop","empty-text":t.$t("Your purchases will be shown here!"),data:e.orders,"show-header":e.showTableHeader,role:"table","aria-label":t.$t("Customer order history")},{default:h(()=>[n(f,{label:"#",width:120},{default:h(_=>[s("div",as,[n(u,{class:"link text-sm",to:{name:"view_order",params:{order_id:_.row.uuid}}},{default:h(()=>[s("span",is,"#"+o(_.row.invoice_no),1)]),_:2},1032,["to"]),s("span",ls,o(M(H)(_.row.created_at)),1)])]),_:1}),n(f,{width:e.itemsColumnWidth,label:M(b)("Items"),"aria-label":t.$t("Order items")},{default:h(_=>[s("div",os,[a(_.row).length===1?(r(),c(S,{key:0},[n(u,{to:{name:"view_order",params:{order_id:_.row.uuid}},class:"fc-customer-orders-items-title","aria-label":t.$t("View single item for this order")},{default:h(()=>{var p,w;return[v(o((p=a(_.row)[0])==null?void 0:p.post_title)+" ",1),s("span",null," – "+o((w=a(_.row)[0])==null?void 0:w.title),1)]}),_:2},1032,["to","aria-label"]),_.row.renewals_count>0?(r(),c("span",rs,o(M(G)("%s Renewal","%s Renewals",M(Ct)(_.row.renewals_count))),1)):g("",!0)],64)):(r(),A(u,{key:1,to:{name:"view_order",params:{order_id:_.row.uuid}},"aria-label":t.$t("%s items in this order")+a(_.row).length},{default:h(()=>[v(o(M(b)("%s items",a(_.row).length)),1)]),_:2},1032,["to","aria-label"])),a(_.row).length>1?(r(),A(d,{key:2,placement:"top",width:360,trigger:"click"},{reference:h(()=>[s("div",{class:"fc-action-link-btn",role:"button","aria-expanded":!1,"aria-label":t.$t("Show all items for this order")},[n(x,{name:"ChevronDown"})],8,ms)]),default:h(()=>[s("div",ns,[s("div",ds,[(r(!0),c(S,null,L(a(_.row),p=>(r(),c("p",{key:p.id},[n(u,{to:{name:"view_order",params:{order_id:_.row.uuid}},class:"title","aria-label":t.$t("View item details:")+p.post_title},{default:h(()=>[v(o(p.post_title),1)]),_:2},1032,["to","aria-label"]),s("span",cs,[s("b",null,o(p.quantity),1),v(" x "+o(p.title),1)])]))),128)),a(_.row).length===0?(r(),c("p",us,o(M(b)("No products found!")),1)):g("",!0)])])]),_:2},1024)):g("",!0)])]),_:1},8,["width","label","aria-label"]),n(f,{label:M(b)("Status"),width:"120","aria-label":t.$t("Order status")},{default:h(_=>[n(V,{type:_.row.status,size:"small"},{default:h(()=>[v(o(_.row.status),1)]),_:2},1032,["type"])]),_:1},8,["label","aria-label"]),n(f,{label:M(b)("Amount"),width:"90","aria-label":t.$t("Total amount")},{default:h(_=>[s("span",{class:"text",innerHTML:t.formatNumber(_.row.total_amount,!0,!1,_.row.currency)},null,8,hs)]),_:1},8,["label","aria-label"])]),_:1},8,["empty-text","data","show-header","aria-label"])])}}},_s={name:"OrderTableLoader",props:{rowsRange:{type:Array,default:[1,2]}}},ps={class:"fc-customer-dashboard-table"};function fs(e,a,i,y,t,l){const u=m("el-skeleton-item"),d=m("el-skeleton"),f=m("el-table-column"),k=m("el-table");return r(),c("div",ps,[n(k,{data:i.rowsRange,"show-header":!1},{default:h(()=>[n(f,{label:"#",width:150},{default:h(()=>[n(d,{animated:"",class:"py-3"},{template:h(()=>[n(u,{varient:"p",class:"w-3/5"})]),_:1})]),_:1}),n(f,{width:300,label:e.$t("Items")},{default:h(()=>[n(d,{animated:""},{template:h(()=>[n(u,{varient:"p",class:"w-3/5"})]),_:1})]),_:1},8,["label"]),n(f,{label:e.$t("Status"),width:"120"},{default:h(()=>[n(d,{animated:""},{template:h(()=>[n(u,{varient:"p",class:"w-3/5"})]),_:1})]),_:1},8,["label"]),n(f,{label:e.$t("Amount"),width:"90"},{default:h(()=>[n(d,{animated:""},{template:h(()=>[n(u,{varient:"p",class:"w-3/5"})]),_:1})]),_:1},8,["label"])]),_:1},8,["data"])])}const R=D(_s,[["render",fs]]),bs={name:"Dashboard",components:{OrderTable:nt,OrderTableLoader:R},data(){return{recentPurchasesTitleId:"recent-purchases-title",dashboardData:{orders:[],subscriptions:[],licenses:[]},loading:!1}},methods:{fetchDashboardData(){this.loading=!0,this.$get("customer-profile").then(e=>{this.dashboardData=e.dashboard_data}).finally(()=>{this.loading=!1})}},mounted(){this.fetchDashboardData()}},ys=["aria-labelledby","aria-busy"],gs={class:"fc-customer-dashboard-header"},vs=["id"],ws={class:"actions"},ks={key:0,"aria-live":"polite"};function $s(e,a,i,y,t,l){const u=m("router-link"),d=m("OrderTableLoader"),f=m("OrderTable");return r(),c("div",{class:"fc-customer-dashboard fc-customer-dashboard-layout-width",role:"region","aria-labelledby":t.recentPurchasesTitleId,"aria-busy":t.loading},[s("div",null,[s("div",gs,[s("h4",{id:t.recentPurchasesTitleId,class:"fc-customer-dashboard-title"},o(e.$t("Your Recent Purchases")),9,vs),s("div",ws,[t.dashboardData.orders.length?(r(),A(u,{key:0,class:"is-link",to:{name:"purchase-history"},"aria-label":e.$t("View all purchases")},{default:h(()=>[v(o(e.$t("View all")),1)]),_:1},8,["aria-label"])):g("",!0)])]),t.loading?(r(),c("div",ks,[n(d,{"rows-range":[1,2]})])):(r(),A(f,{key:1,orders:t.dashboardData.orders},null,8,["orders"]))])],8,ys)}const Cs=D(bs,[["render",$s]]),As={name:"EmptyState",props:["title","text"],data(){var e,a;return{shop_url:(a=(e=window.fluentcart_customer_profile_vars)==null?void 0:e.shop)==null?void 0:a.shop_url}}},Ms={class:"fc-customer-dashboard-empty-state",role:"status","aria-live":"polite","aria-atomic":"true"},Ss={class:"fc-customer-dashboard-empty-state-inner"},Ds={class:"fc-empty-icon-box","aria-hidden":"true"};function Ps(e,a,i,y,t,l){const u=m("el-button");return r(),c("div",Ms,[s("div",Ss,[s("div",Ds,[pt(e.$slots,"icon")]),s("h4",null,o(i.title),1),s("p",null,o(i.text),1),n(u,{tag:"a",href:t.shop_url,rel:"noopener noreferrer","aria-label":e.$t("Back to Shopping Now")},{default:h(()=>[v(o(e.$t("Back to Shopping Now")),1)]),_:1},8,["href","aria-label"])])])}const te=D(As,[["render",Ps]]),Ts={name:"PurchaseHistory",components:{OrderTable:nt,Pagination:X,IconButton:Q,DynamicIcon:x,OrderTableLoader:R,EmptyState:te},data(){var e,a;return{purchaseHistoryTitleId:"purchase-history-title",search:"",showSearch:!1,orders:[],paginate:{current_page:1,per_page:10,total:0},loading:!0,app_loaded:!1,purchaseHistoryTitle:(a=(e=window.fluentcart_customer_profile_vars)==null?void 0:e.section_titles)==null?void 0:a.purchaseHistory}},methods:{fetchOrders(){this.loading=!0,this.$get("customer-profile/orders",{per_page:this.paginate.per_page,page:this.paginate.current_page,search:this.search}).then(e=>{this.orders=e.orders.data,this.paginate.total=e.orders.total}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1,this.app_loaded=!0})}},mounted(){this.fetchOrders()}},Es=["aria-labelledby","aria-busy"],Is={class:"fc-customer-purchase-history-inner"},Ls={class:"fc-customer-dashboard-header"},Vs=["id"],Bs={class:"actions"},xs={class:"fc-collapsible-search-wrap"},Ns={for:"purchase-search-input",class:"sr-only"},Us={id:"search-help",class:"sr-only"},Fs={key:0,"aria-live":"polite"},Hs={key:1,"aria-live":"polite"};function Os(e,a,i,y,t,l){const u=m("el-input"),d=m("DynamicIcon"),f=m("IconButton"),k=m("OrderTableLoader"),_=m("OrderTable"),p=m("EmptyState"),w=m("pagination"),P=q("loading");return r(),c("div",{class:"fc-customer-purchase-history",role:"region","aria-labelledby":t.purchaseHistoryTitleId,"aria-busy":t.loading},[s("div",Is,[s("div",null,[s("div",Ls,[s("h4",{id:t.purchaseHistoryTitleId,class:"fc-customer-dashboard-title"},o(e.$t(t.purchaseHistoryTitle)),9,Vs),s("div",Bs,[s("div",xs,[s("label",Ns,o(e.$t("Search orders")),1),n(bt,{name:"fade-slide"},{default:h(()=>[t.showSearch?(r(),A(u,{key:0,id:"purchase-search-input",modelValue:t.search,"onUpdate:modelValue":a[0]||(a[0]=E=>t.search=E),onKeyup:ft(l.fetchOrders,["enter"]),onClear:l.fetchOrders,placeholder:e.$t("Search and hit enter..."),clearable:"",size:"small","aria-describedby":"search-help"},null,8,["modelValue","onKeyup","onClear","placeholder"])):g("",!0)]),_:1}),s("small",Us,o(e.$t("Press Enter to search")),1),n(f,{tag:"button",size:"small",onClick:a[1]||(a[1]=E=>t.showSearch=!t.showSearch),"aria-expanded":t.showSearch,"aria-label":t.showSearch?e.$t("Close search"):e.$t("Open search"),"aria-controls":"purchase-search-input"},{default:h(()=>[t.showSearch?(r(),A(d,{key:0,name:"Cross","aria-hidden":"true"})):(r(),A(d,{key:1,name:"Search","aria-hidden":"true"}))]),_:1},8,["aria-expanded","aria-label"])])])]),t.loading&&!t.app_loaded?(r(),c("div",Fs,[n(k,{rowsRange:[1,2,3,4,5]})])):t.app_loaded?F((r(),c("div",Hs,[t.orders.length>0?(r(),A(_,{key:0,orders:t.orders,showTableHeader:!0},null,8,["orders"])):(r(),A(p,{key:1,title:e.$t("No purchases yet"),text:e.$t("Your purchases will be shown here!")},{icon:h(()=>a[2]||(a[2]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 40 40",fill:"none","aria-hidden":"true"},[s("path",{opacity:"0.4",d:"M35 28.6021C35 30.9063 31.7573 32.2761 25.2718 35.0158C22.6663 36.1163 21.3637 36.6666 20 36.6666C18.6363 36.6666 17.3337 36.1163 14.7282 35.0158C8.24273 32.2761 5 30.9063 5 28.6021V11.6666L20 18.9246L35 11.6666V28.6021Z",fill:"#758195"}),s("path",{d:"M20 36.6666C18.6363 36.6666 17.3337 36.1163 14.7282 35.0158C8.24273 32.2761 5 30.9063 5 28.6021C5 27.957 5 16.7741 5 11.6666M20 36.6666C21.3637 36.6666 22.6663 36.1163 25.2718 35.0158C31.7573 32.2761 35 30.9063 35 28.6021V11.6666M20 36.6666V18.9246",stroke:"#758195","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),s("path",{d:"M13.8765 16.1523L9.00787 13.7965C6.33595 12.5035 5 11.8571 5 10.8334C5 9.80966 6.33595 9.16321 9.00787 7.87029L13.8765 5.51441C16.8813 4.06039 18.3838 3.33337 20 3.33337C21.6162 3.33337 23.1187 4.06037 26.1235 5.51441L30.9922 7.87029C33.664 9.16321 35 9.80966 35 10.8334C35 11.8571 33.664 12.5035 30.9922 13.7965L26.1235 16.1523C23.1187 17.6064 21.6162 18.3334 20 18.3334C18.3838 18.3334 16.8813 17.6064 13.8765 16.1523Z",stroke:"#758195","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),s("path",{d:"M10 20L13.3333 21.6667",stroke:"#758195","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"}),s("path",{d:"M28.3327 6.66663L11.666 15",stroke:"#758195","stroke-width":"2.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])),_:1},8,["title","text"]))])),[[P,t.loading]]):g("",!0)]),t.paginate&&t.paginate.total!==0?(r(),A(w,{key:0,hide_on_single:!0,pagination:t.paginate,onFetch:l.fetchOrders},null,8,["pagination","onFetch"])):g("",!0)])],8,Es)}const qs=D(Ts,[["render",Os]]),Rs={name:"LicenseKey",methods:{translate:b},props:{license_key:String,show_mode:{type:String,default:"icon_with_text"},tooltip_text:{type:String,default:"Copy License Key"}},components:{CopyToClipboard:ot,IconButton:Q,DynamicIcon:x},computed:{Clipboard(){return St}},data(){return{}}},zs=["aria-label"],Ys={class:"license-key"},js={class:"block",id:"license-key-value"};function Ks(e,a,i,y,t,l){const u=m("CopyToClipboard");return r(),c("div",{class:"fc-license-key-wrap",role:"group","aria-label":l.translate("License Key")},[s("div",Ys,[s("span",js,o(i.license_key),1)]),n(u,{text:i.license_key,showMode:i.show_mode,tooltipText:i.tooltip_text,"button-text":l.translate("Copy"),"aria-label":l.translate("Copy license key to clipboard"),"aria-describedby":"license-key-value"},null,8,["text","showMode","tooltipText","button-text","aria-label"])],8,zs)}const ae=D(Rs,[["render",Ks]]),Zs={class:"fc-customer-dashboard-table"},Ws={class:"license-only-mobile"},Gs={class:"item-header"},Js={key:0,class:"fc-expiration-info"},Qs={key:0,class:"text-meta"},Xs={key:1,class:"text-meta"},ea=["onClick","aria-label"],ta={class:"fc-customer-orders-items-title"},sa={class:"item-body"},aa={class:"fc-customer-payment-meta-info"},ia={class:"item-footer"},la={class:"fc-customer-orders-items-meta-wrap"},oa={key:1,class:"text-meta"},ra={key:1,role:"alert",class:"text-center p-5"},na=["onClick","aria-label"],da={class:"fc-customer-orders-items-title"},ca={class:"fc-customer-orders-items-meta-wrap"},ua={key:0,class:"text-meta"},ma={key:1,class:"fc-btn-group pt-1"},ha={class:"fc-customer-payment-meta-info"},_a={key:0,class:"text-meta"},pa={key:1,class:"text-meta"},oe={__name:"LicenseTable",props:{licenses:{type:Array,required:!0},showTableHeader:{type:Boolean,default:!1},itemsColumnWidth:{type:Number,default:300},is_simple:{type:Boolean,default:!1}},setup(e){const a=Dt();return(i,y)=>{const t=m("el-button"),l=m("el-table-column"),u=m("el-table");return r(),c("div",Zs,[s("div",Ws,[e.licenses.length>0?(r(!0),c(S,{key:0},L(e.licenses,d=>(r(),c("div",{class:"license-only-mobile-item",key:d.id},[s("div",Gs,[(d==null?void 0:d.status)!=="disabled"&&!e.is_simple?(r(),c("div",Js,[d.expiration_date?(r(),c("div",Qs,[(d==null?void 0:d.status)==="expired"?(r(),c(S,{key:0},[v(o(M(b)("Expired at: %s",M(H)(d.expiration_date,"MMM DD, YYYY"))),1)],64)):(r(),c(S,{key:1},[v(o(M(b)("Expires on: %s",M(H)(d.expiration_date,"MMM DD, YYYY"))),1)],64))])):(r(),c("div",Xs,o(M(b)("Never Expires")),1))])):g("",!0),s("div",{class:"fc-customer-orders-items fc-customer-license-orders-items cursor-pointer",onClick:f=>M(a).push({name:"manage_license",params:{license_key:d.license_key}}),"aria-label":i.$t("View details for license: %s",d.title)},[s("div",ta,o(d.title),1)],8,ea)]),s("div",sa,[s("div",aa,[n(ae,{license_key:d==null?void 0:d.license_key,show_mode:"basic_copy_btn",tooltip_text:M(b)("Copy Key")},null,8,["license_key","tooltip_text"])])]),s("div",ia,[s("div",la,[n(V,{status:d.status,"hide-icon":!0,"aria-label":i.$t("License status: %s",d.status)},null,8,["status","aria-label"]),d.renewal_url?(r(),A(t,{key:0,link:"",tag:"a",href:d.renewal_url,target:"_blank",rel:"noopener noreferrer","aria-label":i.$t("Renew license: %s",d.title)},{default:h(()=>[v(o(M(b)("Renew License")),1)]),_:2},1032,["href","aria-label"])):g("",!0),d.status!=="expired"?(r(),c("div",oa,o(d.subtitle),1)):g("",!0)])])]))),128)):(r(),c("div",ra,o(M(b)("No Licenses found")),1))]),n(u,{class:"license-only-desktop",data:e.licenses,"show-header":e.showTableHeader,role:"grid","aria-label":i.$t("Licenses table")},{default:h(()=>[n(l,{label:M(b)("Items"),width:e.itemsColumnWidth},{default:h(d=>[s("div",{class:"fc-customer-orders-items fc-customer-license-orders-items cursor-pointer",onClick:f=>M(a).push({name:"manage_license",params:{license_key:d.row.license_key}}),"aria-label":i.$t("View details for license: %s",d.row.title)},[s("div",da,o(d.row.title),1),s("div",ca,[d.row.status!=="expired"?(r(),c("div",ua,o(d.row.subtitle),1)):g("",!0),n(V,{status:d.row.status,"hide-icon":!0,"aria-label":i.$t("License status: %s",d.row.status)},null,8,["status","aria-label"]),d.row.renewal_url?(r(),c("div",ma,[n(t,{link:"",tag:"a",href:d.row.renewal_url,target:"_blank",rel:"noopener noreferrer","aria-label":i.$t("Renew license: %s",d.row.title)},{default:h(()=>[v(o(M(b)("Renew License")),1)]),_:2},1032,["href","aria-label"])])):g("",!0)])],8,na)]),_:1},8,["label","width"]),n(l,{width:400,label:M(b)("License Info"),align:"right","class-name":"license-info-column"},{default:h(d=>{var f;return[s("div",ha,[d.row.status!=="disabled"&&!e.is_simple?(r(),c(S,{key:0},[d.row.expiration_date?(r(),c("div",_a,[d.row.status==="expired"?(r(),c(S,{key:0},[v(o(M(b)("Expired at: %s",M(H)(d.row.expiration_date,"MMM DD, YYYY"))),1)],64)):(r(),c(S,{key:1},[v(o(M(b)("Expires on: %s",M(H)(d.row.expiration_date,"MMM DD, YYYY"))),1)],64))])):(r(),c("div",pa,o(M(b)("Never Expires")),1))],64)):g("",!0),n(ae,{license_key:(f=d.row)==null?void 0:f.license_key,show_mode:"basic_copy_btn",tooltip_text:M(b)("Copy Key")},null,8,["license_key","tooltip_text"])])]}),_:1},8,["label"])]),_:1},8,["data","show-header","aria-label"])])}}},fa={name:"Licenses",components:{LicenseTable:oe,Pagination:X,OrderTableLoader:R,EmptyState:te},data(){var e,a;return{licensesTitleId:"licenses-title",licenses:[],loading:!1,skeletonRowCount:10,paginate:{current_page:1,total:0,per_page:10},search:"",appLoaded:!1,licensesTitle:(a=(e=window.fluentcart_customer_profile_vars)==null?void 0:e.section_titles)==null?void 0:a.licenses}},methods:{fetchLicenses(){this.loading=!0,this.paginate.per_page,this.paginate.current_page,this.$get("customer-profile/licenses",{per_page:this.paginate.per_page,page:this.paginate.current_page,search:this.search}).then(e=>{this.licenses=e.licenses.data,this.paginate.total=e.licenses.total}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1,this.appLoaded=!0})}},mounted(){this.fetchLicenses()}},ba=["aria-labelledby","aria-busy"],ya={class:"fc-customer-dashboard-license-inner"},ga={class:"fc-customer-dashboard-header"},va=["id"],wa={key:0,"aria-live":"polite"};function ka(e,a,i,y,t,l){const u=m("OrderTableLoader"),d=m("LicenseTable"),f=m("EmptyState"),k=m("pagination"),_=q("loading");return r(),c("div",{class:"fc-customer-dashboard-license",role:"region","aria-labelledby":t.licensesTitleId,"aria-busy":t.loading},[s("div",ya,[s("div",null,[s("div",ga,[s("h4",{id:t.licensesTitleId,class:"fc-customer-dashboard-title"},o(t.licensesTitle),9,va)]),t.loading&&!t.appLoaded?(r(),c("div",wa,[n(u,{"rows-range":[1,2,3,4]})])):t.appLoaded&&t.paginate.total?F((r(),A(d,{key:1,licenses:t.licenses,showTableHeader:!0},null,8,["licenses"])),[[_,t.loading]]):(r(),A(f,{key:2,title:e.$t("No licenses yet"),text:e.$t("Looks like no licenses yet. Purchase something to view data.")},{icon:h(()=>a[0]||(a[0]=[s("svg",{"aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 40 40",fill:"none"},[s("path",{opacity:"0.4",d:"M20.928 2.08337C23.9908 2.08334 26.4168 2.08332 28.3157 2.33861C30.2697 2.60131 31.8512 3.15484 33.0985 4.40211C34.3458 5.64939 34.8993 7.23097 35.162 9.18501C35.4173 11.0837 35.4172 13.5097 35.4172 16.5726V23.4274C35.4172 26.4902 35.4173 28.9164 35.162 30.815C34.8993 32.769 34.3458 34.3507 33.0985 35.598C31.8512 36.8452 30.2697 37.3987 28.3157 37.6615C26.4168 37.9167 23.9908 37.9167 20.928 37.9167H19.0733C16.0105 37.9167 13.5843 37.9167 11.6856 37.6615C9.7315 37.3987 8.14992 36.8452 6.90264 35.5979C5.65537 34.3507 5.10185 32.769 4.83915 30.815C4.58389 28.9164 4.58394 26.4902 4.58399 23.4274L4.58405 16.5726C4.58405 13.5096 4.58405 11.0836 4.83934 9.18494C5.10207 7.23091 5.6556 5.64934 6.90287 4.40209C8.15014 3.15482 9.7317 2.60131 11.6857 2.33859C13.5844 2.08332 16.0104 2.08334 19.0733 2.08337H20.928Z",fill:"#758195"}),s("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M11.666 11.6667C11.666 10.7462 12.4122 10 13.3327 10H26.666C27.5865 10 28.3327 10.7462 28.3327 11.6667C28.3327 12.5871 27.5865 13.3333 26.666 13.3333H13.3327C12.4122 13.3333 11.666 12.5871 11.666 11.6667ZM11.666 20C11.666 19.0795 12.4122 18.3333 13.3327 18.3333H26.666C27.5865 18.3333 28.3327 19.0795 28.3327 20C28.3327 20.9205 27.5865 21.6667 26.666 21.6667H13.3327C12.4122 21.6667 11.666 20.9205 11.666 20ZM11.666 28.3333C11.666 27.4128 12.4122 26.6667 13.3327 26.6667H19.9993C20.9198 26.6667 21.666 27.4128 21.666 28.3333C21.666 29.2538 20.9198 30 19.9993 30H13.3327C12.4122 30 11.666 29.2538 11.666 28.3333Z",fill:"#758195"})],-1)])),_:1},8,["title","text"]))]),t.paginate&&t.paginate.total!==0?(r(),A(k,{key:0,hide_on_single:!0,pagination:t.paginate,onFetch:l.fetchLicenses},null,8,["pagination","onFetch"])):g("",!0)])],8,ba)}const $a=D(fa,[["render",ka]]),Ca={props:{downloads:{type:Array,default:()=>[]},showTableHeader:{type:Boolean,default:!0}},components:{DynamicIcon:x},methods:{translate:b,readableFileSize(e){return At.readableFileSizeFromBytes(e)}}},Aa={class:"fc-customer-dashboard-table"},Ma={class:"fc-customer-downloads-file-info"},Sa=["aria-label"],Da=["aria-label"],Pa=["href","aria-label"];function Ta(e,a,i,y,t,l){const u=m("el-table-column"),d=m("DynamicIcon"),f=m("el-table");return r(),c("div",Aa,[n(f,{data:i.downloads,"show-header":i.showTableHeader,role:"grid","aria-label":e.$t("Downloads table")},{default:h(()=>[n(u,{label:e.$t("File Name")},{default:h(k=>{var _,p,w,P;return[s("div",Ma,[s("div",{class:"filename",role:"status","aria-label":`${l.translate("File name: %s",((_=k.row)==null?void 0:_.title)||"N/A")}`},o(((p=k.row)==null?void 0:p.title)||"N/A"),9,Sa),k.row.file_size?(r(),c("div",{key:0,class:"text",role:"status","aria-label":`${l.translate("File size: %s",l.readableFileSize((w=k.row)==null?void 0:w.file_size))}`},o(l.readableFileSize((P=k.row)==null?void 0:P.file_size)),9,Da)):g("",!0)])]}),_:1},8,["label"]),n(u,{align:"right"},{default:h(k=>{var _;return[s("a",{target:"_blank",class:"el-button el-button--info is-plain el-button--x-small",href:k.row.download_url,"aria-label":`Download ${((_=k.row)==null?void 0:_.title)||"file"}`,rel:"noopener noreferrer"},[n(d,{name:"Download","aria-hidden":"true",role:"presentation"}),v(" "+o(e.$t("Download")),1)],8,Pa)]}),_:1})]),_:1},8,["data","show-header","aria-label"])])}const dt=D(Ca,[["render",Ta]]),Ea={components:{OrderTableLoader:R,Pagination:X,DownloadsTable:dt,EmptyState:te},props:{isLimited:{type:Boolean,default:!1},per_page:{type:Number,default:10}},data(){var e,a;return{downloadsTitleId:"downloads-title",downloads:[],loading:!1,appLoaded:!1,paginate:{current_page:1,per_page:this.per_page,total:0},downloadsTitle:(a=(e=window.fluentcart_customer_profile_vars)==null?void 0:e.section_titles)==null?void 0:a.downloads}},methods:{fetchFiles(){this.loading=!0,this.$get("customer-profile/downloads",{per_page:this.paginate.per_page,page:this.paginate.current_page}).then(e=>{var a,i;this.downloads=(a=e.downloads)==null?void 0:a.data,this.paginate.total=(i=e.downloads)==null?void 0:i.total}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1,this.appLoaded=!0})}},mounted(){this.fetchFiles()}},Ia=["aria-labelledby","aria-busy"],La={class:"fc-customer-dashboard-header"},Va=["id"],Ba={key:0,class:"actions"},xa={key:0,"aria-live":"polite"},Na={key:1,class:"fc-customer-dashboard-downloads-table","aria-live":"polite"};function Ua(e,a,i,y,t,l){var w;const u=m("router-link"),d=m("order-table-loader"),f=m("DownloadsTable"),k=m("EmptyState"),_=m("pagination"),p=q("loading");return r(),c("div",{class:"fc-customer-dashboard-download",role:"region","aria-labelledby":t.downloadsTitleId,"aria-busy":t.loading||!t.appLoaded},[s("div",La,[s("h4",{id:t.downloadsTitleId,class:"fc-customer-dashboard-title"},o(t.downloadsTitle),9,Va),i.isLimited?(r(),c("div",Ba,[n(u,{class:"is-link",to:{name:"downloads"},"aria-label":e.$t("View all downloads")},{default:h(()=>[v(o(e.$t("View all")),1)]),_:1},8,["aria-label"])])):g("",!0)]),t.appLoaded?t.appLoaded?F((r(),c("div",Na,[((w=t.downloads)==null?void 0:w.length)>0?(r(),A(f,{key:0,downloads:t.downloads},null,8,["downloads"])):(r(),A(k,{key:1,title:e.$t("No downloads yet"),text:e.$t("Your valid downloads will be shown here.")},{icon:h(()=>a[0]||(a[0]=[s("svg",{"aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 40 40",fill:"none"},[s("path",{opacity:"0.4",d:"M18.3328 5.41667C18.3328 4.49618 19.079 3.75 19.9995 3.75C20.92 3.75 21.6661 4.49618 21.6661 5.41667V22.998C22.0163 22.6323 22.378 22.2345 22.734 21.8245C23.4321 21.0203 24.0816 20.2106 24.5585 19.5996C24.796 19.2953 24.9885 19.0418 25.1216 18.8656C25.1881 18.7775 25.2401 18.7083 25.2746 18.6621C25.2916 18.6393 25.3036 18.6213 25.312 18.61C25.316 18.6046 25.3198 18.6013 25.3218 18.5986L25.3235 18.5953C25.8693 17.8541 26.913 17.6963 27.6541 18.2421C28.395 18.788 28.5541 19.8301 28.009 20.5713H28.0073V20.5745C28.0065 20.5756 28.0038 20.576 28.0025 20.5778C27.9996 20.5816 27.9961 20.5873 27.9911 20.5941C27.9808 20.608 27.9663 20.6285 27.9471 20.6543C27.9088 20.7058 27.8523 20.7798 27.7811 20.874C27.639 21.0623 27.4353 21.3301 27.1855 21.6503C26.6868 22.2893 25.9988 23.1465 25.2501 24.0088C24.5085 24.863 23.6738 25.76 22.8853 26.4566C22.4931 26.8031 22.0738 27.1363 21.6515 27.391C21.2748 27.618 20.6833 27.9166 19.9995 27.9166C19.3158 27.9166 18.7241 27.618 18.3475 27.391C17.9253 27.1363 17.506 26.8031 17.1138 26.4566C16.3253 25.76 15.4905 24.863 14.7489 24.0088C14.0002 23.1465 13.3122 22.2893 12.8137 21.6503C12.5637 21.3301 12.3601 21.0623 12.2179 20.874C12.1468 20.7798 12.0903 20.7058 12.0519 20.6543C12.0327 20.6285 12.0183 20.608 12.008 20.5941C12.0029 20.5871 11.9978 20.5816 11.995 20.5778C11.9939 20.5763 11.9924 20.5755 11.9917 20.5745V20.5713C11.4464 19.8301 11.6039 18.7863 12.3449 18.2406C13.086 17.6953 14.1299 17.8545 14.6756 18.5953L14.6773 18.5986C14.6792 18.6013 14.6831 18.6046 14.687 18.61C14.6954 18.6213 14.7074 18.6393 14.7245 18.6621C14.7589 18.7083 14.8109 18.7775 14.8775 18.8656C15.0106 19.0418 15.2031 19.2953 15.4406 19.5996C15.9174 20.2106 16.5669 21.0203 17.2651 21.8245C17.621 22.2345 17.9828 22.6323 18.3328 22.998V5.41667Z",fill:"black"}),s("path",{d:"M3.75 23.75V20.415L3.7614 19.987C3.98537 15.5864 7.6225 12.086 12.0785 12.0834H12.0833C13.0036 12.0834 13.7496 12.8299 13.75 13.75C13.75 14.6705 13.0038 15.4167 12.0833 15.4167H12.0801C9.32045 15.4185 7.08403 17.657 7.08333 20.4167V23.75C7.08333 25.7243 7.08512 27.1007 7.17612 28.1707C7.26538 29.2198 7.43154 29.8213 7.67417 30.2752C8.14029 31.1468 8.85484 31.8615 9.72657 32.3275C10.1803 32.5698 10.7808 32.7363 11.8294 32.8255C12.8993 32.9165 14.2758 32.9167 16.25 32.9167H23.75C25.7242 32.9167 27.1007 32.9148 28.1705 32.824C29.2195 32.7347 29.8197 32.5683 30.2734 32.3258C31.1455 31.8597 31.8597 31.1455 32.3259 30.2735C32.5684 29.8198 32.7347 29.2195 32.8239 28.1707C32.9149 27.1008 32.9167 25.7242 32.9167 23.75V20.4167C32.9167 17.6553 30.678 15.4167 27.9167 15.4167C26.9962 15.4167 26.25 14.6705 26.25 13.75C26.25 12.8296 26.9962 12.0834 27.9167 12.0834C32.519 12.0834 36.25 15.8143 36.25 20.4167V23.75C36.25 25.6665 36.2515 27.2083 36.1459 28.4522C36.0384 29.7167 35.8099 30.8252 35.2654 31.8442C34.4885 33.2973 33.2989 34.4883 31.8457 35.2653C30.8267 35.81 29.7167 36.0383 28.4522 36.1458C27.8305 36.1987 27.1344 36.2242 26.3542 36.237L23.75 36.25H16.25C14.3335 36.25 12.7917 36.2517 11.5479 36.1458C10.2831 36.0383 9.17335 35.8117 8.1543 35.267C6.70118 34.4902 5.51155 33.2988 4.7347 31.8457C4.19002 30.8268 3.96177 29.7183 3.85417 28.4538C3.74833 27.2097 3.75 25.6672 3.75 23.75Z",fill:"black"})],-1)])),_:1},8,["title","text"]))])),[[p,t.loading]]):g("",!0):(r(),c("div",xa,[n(d,{"rows-range":[1,2,3,4]})])),t.paginate.total>0?(r(),A(_,{key:2,hide_on_single:!0,pagination:t.paginate,onFetch:l.fetchFiles},null,8,["pagination","onFetch"])):g("",!0)],8,Ia)}const Fa=D(Ea,[["render",Ua]]),Ha={props:["license_key"],components:{Badge:V,DynamicIcon:x,IconButton:Q},data(){return{loading:!1,activations:[],activatedSitesModal:!1}},methods:{showActivatedSitesModal(){this.activatedSitesModal=!0,this.fetchActivatedSites()},fetchActivatedSites(){this.loading=!0,this.$get(`customer-profile/licenses/${this.license_key}/activations`).then(e=>{this.activations=e.activations}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1})},deactivate(e){this.$post(`customer-profile/licenses/${this.license_key}/deactivate_site`,{site_url:e.site_url}).then(a=>{this.$notify.success(a.message),this.activations=this.activations.filter(i=>i.site_url!==e.site_url)}).catch(a=>{this.handleError(a)})}}},Oa={id:"activated-sites-title",class:"sr-only"},qa={id:"activated-sites-description",class:"sr-only"},Ra=["aria-label"],za=["id"],Ya={id:"delete-confirm-title",class:"sr-only"},ja={role:"alert"};function Ka(e,a,i,y,t,l){const u=m("el-button"),d=m("Badge"),f=m("el-table-column"),k=m("DynamicIcon"),_=m("IconButton"),p=m("el-popconfirm"),w=m("el-table"),P=m("el-dialog"),E=q("loading");return r(),c(S,null,[n(u,{text:"",class:"underline-link-button",onClick:l.showActivatedSitesModal,"aria-label":e.$t("View list of activated sites")},{default:h(()=>[v(o(e.$t("View List")),1)]),_:1},8,["onClick","aria-label"]),n(P,{modelValue:t.activatedSitesModal,"onUpdate:modelValue":a[0]||(a[0]=T=>t.activatedSitesModal=T),"append-to-body":!0,title:e.$t("License Activations"),"modal-class":"fc-activated-sites-modal",role:"dialog","aria-labelledby":"activated-sites-title","aria-describedby":"activated-sites-description"},{default:h(()=>{var T;return[s("h2",Oa,o(e.$t("License Activations")),1),s("p",qa,o(e.$t("List of sites where the license is activated")),1),F((r(),c("div",{class:O(["fc-table-style-two fc-activated-sites-table",((T=t.activations)==null?void 0:T.length)>10?"scrollable":""]),"aria-live":"polite",id:"activated-sites-description"},[n(w,{data:t.activations,stripe:"",role:"grid","aria-label":e.$t("Table of activated sites")},{empty:h(()=>[s("span",ja,o(e.$t("No activations found for this license")),1)]),default:h(()=>[n(f,{label:e.$t("Site"),"min-width":270},{default:h(C=>[s("span",null,o(C.row.site_url),1),C.row.is_local!="0"?(r(),c("span",{key:0,style:{"margin-left":"10px"},role:"status","aria-label":e.$t("local")},[n(d,{status:"warning",size:"small","hide-icon":!0,text:e.$t("local")},null,8,["text"])],8,Ra)):g("",!0)]),_:1},8,["label"]),n(f,{label:e.$t("Status"),width:100},{default:h(C=>[n(d,{status:C.row.status,size:"small","hide-icon":!0,"aria-label":`${e.$t("Status")}: ${e.$t(C.row.status)}`},null,8,["status","aria-label"])]),_:1},8,["label"]),n(f,{width:60},{default:h(C=>[s("span",null,[n(p,{width:235,"confirm-button-text":e.$t("Confirm"),"cancel-button-text":e.$t("No, Thanks"),"icon-color":"red",title:e.$t("Are you sure to disconnect?"),onConfirm:B=>l.deactivate(C.row),"aria-labelledby":"delete-confirm-title"},{reference:h(()=>[n(_,{tag:"a",size:"x-small",hover:"danger","aria-label":e.$t("Delete activation for site"),"aria-describedby":`site-${C.$index}`},{default:h(()=>[n(k,{name:"TrashIcon"})]),_:2},1032,["aria-label","aria-describedby"])]),_:2},1032,["confirm-button-text","cancel-button-text","title","onConfirm"]),s("span",{id:`site-${C.$index}`,class:"sr-only"},o(C.row.site_url),9,za),s("span",Ya,o(e.$t("Are you sure to disconnect the site"))+" "+o(C.row.site_url)+"? ",1)])]),_:1})]),_:1},8,["data","aria-label"])],2)),[[E,t.loading]])]}),_:1},8,["modelValue","title"])],64)}const Za=D(Ha,[["render",Ka]]),Wa={name:"UpgradePlan",components:{CopyToClipboard:ot,DynamicIcon:x},props:{variation_id:{type:[String,Number],required:!0},order_hash:{type:String,required:!0},buttonText:{type:String,default:"Upgrade"},buttonType:{type:String,default:"default"}},data(){return{upgradePlanModal:!1,selectedUpgradePath:"",upgradePaths:[],loading:!1}},computed:{currencySign(){return this.appVars.shop.currency_sign}},methods:{translate:b,showUpgradePlanModal(){this.fetchPaths(),this.upgradePlanModal=!0},fetchPaths(){this.loading=!0,this.$get(`customer-profile/orders/${this.order_hash}/upgrade-paths`,{variation_id:this.variation_id}).then(e=>{this.upgradePaths=e.upgradePaths}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1})},closeUpgradePlanModal(){this.upgradePlanModal=!1}}},Ga={class:"fc-upgrade-plan"},Ja={id:"upgrade-dialog-title",class:"sr-only"},Qa={key:0,class:"fc-upgrade-variation-table pb-10"},Xa={class:"upgrade-title"},ei={class:"plan-price"},ti={class:"plan-price"},si={class:"upgrade-cost"},ai={class:"upgrade-title"},ii=["innerHTML"],li={class:"upgrade-action"},oi={key:1,role:"status","aria-live":"polite"},ri={key:2,role:"alert","aria-live":"assertive"};function ni(e,a,i,y,t,l){const u=m("el-button"),d=m("el-table-column"),f=m("el-table"),k=m("el-skeleton"),_=m("el-dialog");return r(),c("div",Ga,[n(u,{type:i.buttonType,size:"small",onClick:l.showUpgradePlanModal,"aria-label":i.buttonText},{default:h(()=>[v(o(i.buttonText),1)]),_:1},8,["type","onClick","aria-label"]),n(_,{modelValue:t.upgradePlanModal,"onUpdate:modelValue":a[0]||(a[0]=p=>t.upgradePlanModal=p),"append-to-body":!0,title:e.$t("Upgrade Options"),class:"fc-upgrade-plan-dialog fluent-cart-customer-profile-app",role:"dialog","aria-modal":"true","aria-labelledby":"upgrade-dialog-title"},{default:h(()=>[s("h2",Ja,o(e.$t("Upgrade Options")),1),t.upgradePaths.length>0?(r(),c("div",Qa,[n(f,{data:t.upgradePaths,"aria-label":l.translate("Upgrade options table")},{default:h(()=>[n(d,{label:l.translate("Package"),width:290,"aria-label":l.translate("Package")},{default:h(p=>[s("div",Xa,o(p.row.title),1)]),_:1},8,["label","aria-label"]),n(d,{label:l.translate("Price"),width:100,"aria-label":l.translate("Price")},{default:h(p=>[s("div",ei,[s("div",ti,o(e.formatNumber(p.row.original_price,p.row.currency)),1)])]),_:1},8,["label","aria-label"]),n(d,{label:l.translate("Amount to pay"),width:200,"aria-label":l.translate("Amount to pay")},{default:h(p=>[s("div",si,[s("div",ai,[s("span",{innerHTML:p.row.payment_summary},null,8,ii)])])]),_:1},8,["label","aria-label"]),n(d,{label:l.translate("Action"),width:110,"aria-label":l.translate("Action")},{default:h(p=>[s("div",li,[n(u,{class:"el-button--x-small",tag:"a",href:p.row.upgrade_url,target:"_blank",rel:"noopener noreferrer","aria-label":e.$t("Upgrade to")+" "+p.row.title},{default:h(()=>[v(o(e.$t("Upgrade")),1)]),_:2},1032,["href","aria-label"])])]),_:1},8,["label","aria-label"])]),_:1},8,["data","aria-label"])])):t.loading?(r(),c("div",oi,[n(k,{animated:!0,rows:2})])):(r(),c("div",ri,o(l.translate("No upgrade found for this purchase")),1))]),_:1},8,["modelValue","title"])])}const ct=D(Wa,[["render",ni]]),di={name:"LicenseDetails",components:{UpgradePlan:ct,Badge:V,LicenseKey:ae,ActivatedSites:Za},data(){return{licenseDetailsTitleId:"license-details-title",license:null,loading:!1}},props:{license_key:{type:String,required:!0}},methods:{fetchLicense(){this.loading=!0,this.$get("customer-profile/licenses/"+this.license_key).then(e=>{this.license=e.license}).catch(e=>{this.$notify.error(e)}).finally(()=>{this.loading=!1})}},mounted(){this.fetchLicense()}},ci=["aria-labelledby","aria-busy"],ui={class:"fc-customer-dashboard-single-subscription"},mi=["aria-label"],hi=["aria-labelledby"],_i={key:0,class:"fc-renew-box mb-4"},pi={class:"text-center p-4"},fi={class:"p-0 m-0 mb-3"},bi=["href","aria-label"],yi={class:"fc-single-order-box"},gi={class:"fc-single-order-header"},vi=["id"],wi={class:"fc-single-order-body"},ki={class:"fc-single-order-box-inner"},$i={class:"fc-customer-dashboard-content-table-item border-0 pb-0"},Ci={class:"left-content"},Ai={class:"fc-product-info-card"},Mi={class:"fc-product-info-card-inner"},Si={class:"product-info-content"},Di={class:"title truncate-none"},Pi={class:"variation-title"},Ti={class:"right-content"},Ei={class:"fc-customer-dashboard-content-table-item border-0 pb-0"},Ii={class:"left-content"},Li={class:"title"},Vi={class:"fc-customer-dashboard-content-table-item border-0 pb-0"},Bi={class:"left-content"},xi={class:"title"},Ni={class:"flex items-center gap-2"},Ui={key:0,class:"text"},Fi={key:1,class:"text"},Hi={class:"fc-customer-dashboard-content-table-item border-0 pb-0"},Oi={class:"left-content"},qi={class:"title"},Ri={class:"text"},zi={class:"fc-single-order-footer mt-3"},Yi={class:"flex items-center gap-3"},ji={key:1,class:"fc-customer-dashboard-loader","aria-live":"polite"},Ki={key:2,class:"fc-customer-dashboard-no-data",role:"alert"};function Zi(e,a,i,y,t,l){var T,C,B,$,N,U;const u=m("el-breadcrumb-item"),d=m("el-breadcrumb"),f=m("el-alert"),k=m("Badge"),_=m("LicenseKey"),p=m("ActivatedSites"),w=m("UpgradePlan"),P=m("router-link"),E=m("el-skeleton");return r(),c("div",{class:"fc-customer-dashboard-manage-license-wrap fc-customer-dashboard-layout-width",role:"main","aria-labelledby":t.licenseDetailsTitleId,"aria-busy":t.loading},[s("div",ui,[s("div",{class:"fc-customer-dashboard-breadcrumb mb-8",role:"navigation","aria-label":e.$t("Breadcrumb")},[n(d,null,{default:h(()=>[n(u,{class:"cursor-pointer",to:{path:"/licenses"}},{default:h(()=>[v(o(e.$t("Licenses")),1)]),_:1}),n(u,null,{default:h(()=>[v(o(i.license_key),1)]),_:1})]),_:1})],8,mi),t.license?(r(),c("div",{key:0,"aria-labelledby":t.licenseDetailsTitleId},[t.license.renewal_url&&t.license.status==="expired"?(r(),c("div",_i,[n(f,{type:"error",closable:!1,role:"alert","aria-live":"assertive"},{default:h(()=>[s("div",pi,[s("p",fi,"Your license has been expired at "+o(e.formatDate(t.license.expiration_date))+". Please renew the license for getting updates and support.",1),s("a",{href:t.license.renewal_url,class:"el-button el-button--primary","aria-label":e.$t("Renew License")},o(e.$t("Renew License")),9,bi)])]),_:1})])):g("",!0),s("article",yi,[s("header",gi,[s("h1",{id:t.licenseDetailsTitleId,class:"title"},o(e.$t("License Details")),9,vi)]),s("div",wi,[s("div",ki,[s("div",$i,[s("div",Ci,[s("div",Ai,[s("div",Mi,[s("div",Si,[s("div",Di,o(t.license.title),1),s("div",Pi,o(t.license.subtitle),1)])])])]),s("div",Ti,[n(k,{status:t.license.status},null,8,["status"])])]),s("div",Ei,[s("div",Ii,[s("div",Li,o(e.$t("License Key")),1),n(_,{license_key:i.license_key},null,8,["license_key"])])]),s("div",Vi,[s("div",Bi,[s("div",xi,o(e.$t("Activations")),1),s("div",Ni,[!((T=t.license)!=null&&T.limit)||Number((C=t.license)==null?void 0:C.limit)===0?(r(),c("span",Ui,o(e.$t("%s / Unlimited",(B=t.license)==null?void 0:B.activation_count)),1)):(r(),c("span",Fi,o(e.$t("%s / %s",($=t.license)==null?void 0:$.activation_count,(N=t.license)==null?void 0:N.limit)),1)),t.license.license_key?(r(),A(p,{key:2,license_key:(U=t.license)==null?void 0:U.license_key},null,8,["license_key"])):g("",!0)])]),a[0]||(a[0]=s("div",{class:"right-content"},null,-1))]),s("div",Hi,[s("div",Oi,[s("div",qi,o(e.$t("Expiration Date")),1),s("div",Ri,o(t.license.expiration_date?e.formatDate(t.license.expiration_date,!0):e.$t("Never Expires")),1)])])])]),s("footer",zi,[s("div",Yi,[t.license.has_upgrades?(r(),A(w,{key:0,"button-type":"primary","button-text":e.$t("Upgrade Plan"),variation_id:t.license.variation_id,order_hash:t.license.order.uuid,"aria-label":e.$t("Upgrade Plan")},null,8,["button-text","variation_id","order_hash","aria-label"])):g("",!0),n(P,{class:"underline-link-button",to:{name:"view_order",params:{order_id:t.license.order.uuid}},"aria-label":e.$t("View Order")},{default:h(()=>[v(o(e.$t("View Order")),1)]),_:1},8,["to","aria-label"])])])])],8,hi)):t.loading?(r(),c("div",ji,[n(E,{rows:5,animated:""})])):(r(),c("div",Ki,[s("p",null,o(e.$t("License could not be loaded. Please try again.")),1)]))])],8,ci)}const Wi=D(di,[["render",Zi]]),Gi={name:"PaymentInfo",props:{data:Object}},Ji={"aria-labelledby":"payment-info-heading",role:"region"},Qi={id:"payment-info-heading",class:"sr-only"},Xi=["innerHTML"];function el(e,a,i,y,t,l){var u,d;return r(),c("div",Ji,[s("h2",Qi,o(e.$t("Payment details")),1),(u=i.data)!=null&&u.payment_info?(r(),c("div",{key:0,class:"fc-customer-payment-info",innerHTML:(d=i.data)==null?void 0:d.payment_info},null,8,Xi)):g("",!0)])}const tl=D(Gi,[["render",el]]),sl=["aria-label"],al=["src","alt"],il=["src","alt"],ll=["aria-label"],ol=["aria-label"],rl={__name:"CardInfo",props:{data:Object,showPaymentInfo:Boolean},setup(e){const a=yt(()=>window.fluentcart_customer_profile_vars.assets_path);return(i,y)=>{var t,l,u,d,f,k,_,p,w,P,E,T,C,B,$,N,U,z,Y;return e.data?(r(),c("div",{key:0,class:"fc-card-info",role:"status","aria-label":i.$t("Payment method information")},[((t=e.data)==null?void 0:t.current_payment_method)==="paypal"||((l=e.data)==null?void 0:l.payment_method)==="paypal"?(r(),c("img",{key:0,src:`${a.value}images/payment-methods/paypal-icon.svg`,alt:i.$t("PayPal logo"),role:"presentation"},null,8,al)):(f=(d=(u=e.data)==null?void 0:u.billing_info)==null?void 0:d.details)!=null&&f.last_4||(k=e.data)!=null&&k.card_last_4?(r(),c(S,{key:1},[s("img",{src:`${a.value}images/credit-card/card.svg`,alt:i.$t("Credit card icon"),role:"presentation","aria-hidden":"true"},null,8,il),s("div",{class:"text","aria-label":i.$t("Credit card number")+" "+(((w=(p=(_=e.data)==null?void 0:_.billing_info)==null?void 0:p.details)==null?void 0:w.last_4)||((P=e.data)==null?void 0:P.card_last_4))}," **** "+o(((C=(T=(E=e.data)==null?void 0:E.billing_info)==null?void 0:T.details)==null?void 0:C.last_4)||((B=e.data)==null?void 0:B.card_last_4)),9,ll)],64)):(($=e.data)==null?void 0:$.current_payment_method)=="offline_payment"?(r(),c("div",{key:2,class:"text",role:"status","aria-label":`${M(j).headline((N=e.data)==null?void 0:N.current_payment_method)||M(j).headline((U=e.data)==null?void 0:U.payment_method)} payment method`},o(M(j).headline((z=e.data)==null?void 0:z.current_payment_method)||M(j).headline((Y=e.data)==null?void 0:Y.payment_method)),9,ol)):g("",!0)],8,sl)):g("",!0)}}},nl={name:"SubscriptionTable",components:{PaymentInfo:tl,CardInfo:rl,Badge:V},props:{subscriptions:{type:Array,required:!0},hideHeader:{type:Boolean,default:!1}},methods:{dateTimeI18:H,translate:b,subscriptionStatus(e){return e!=null&&e.overridden_status?e==null?void 0:e.overridden_status:e==null?void 0:e.status}}},dl={class:"fc-customer-dashboard-table"},cl={class:"subscription-only-mobile"},ul={class:"item-header"},ml={key:0,class:"text","aria-live":"polite"},hl={class:"item-body"},_l=["onClick","aria-label"],pl={class:"fc-customer-orders-items-title"},fl={class:"item-footer"},bl={class:"item-footer-content"},yl={key:1,class:"text-center p-5",role:"alert","aria-live":"polite"},gl=["onClick","aria-label"],vl={class:"fc-customer-orders-items-title"},wl={class:"fc-customer-orders-items-meta-wrap"},kl={key:0,class:"text-meta","aria-live":"polite"},$l={class:"fc-customer-payment-meta-info"};function Cl(e,a,i,y,t,l){const u=m("CardInfo"),d=m("Badge"),f=m("PaymentInfo"),k=m("el-table-column"),_=m("el-table");return r(),c("div",dl,[s("div",cl,[i.subscriptions.length>0?(r(!0),c(S,{key:0},L(i.subscriptions,p=>(r(),c("div",{class:"subscription-only-mobile-item",key:p.id},[s("div",ul,[n(u,{data:p,"show-payment-info":e.showPaymentInfo},null,8,["data","show-payment-info"]),p.status!=="expired"&&p.status!=="canceled"&&p.status!=="completed"?(r(),c("div",ml,o(e.$t("Auto renews on %s",l.dateTimeI18(p.next_billing_date))),1)):g("",!0)]),s("div",hl,[s("div",{class:"fc-customer-orders-items fc-customer-sub-orders-items cursor-pointer",onClick:w=>e.$router.push({name:"view_subscription",params:{subscription_uuid:p.uuid}}),"aria-label":e.$t("View subscription details for")+" "+p.item_name},[s("div",pl,o(p.item_name),1)],8,_l)]),s("div",fl,[s("div",bl,[n(d,{status:l.subscriptionStatus(p),"hide-icon":!0,size:"small"},null,8,["status"]),n(f,{data:p},null,8,["data"])])])]))),128)):(r(),c("div",yl,o(l.translate("No subscription plans found!")),1))]),n(_,{class:"subscription-only-desktop",data:i.subscriptions,"show-header":!i.hideHeader,role:"table"},{default:h(()=>[n(k,{"min-width":200,label:e.$t("Item")},{default:h(p=>[s("div",{class:"fc-customer-orders-items fc-customer-sub-orders-items cursor-pointer",onClick:w=>e.$router.push({name:"view_subscription",params:{subscription_uuid:p.row.uuid}}),"aria-label":e.$t("View subscription details for")+" "+p.row.item_name},[s("div",vl,o(p.row.item_name),1),s("div",wl,[n(d,{status:l.subscriptionStatus(p.row),"hide-icon":!0,size:"small","aria-hidden":"true"},null,8,["status"]),p.row.status!=="expired"&&p.row.status!=="canceled"&&p.row.status!=="completed"?(r(),c("div",kl,o(e.$t("Auto renews on %s",l.dateTimeI18(p.row.next_billing_date,"DD MMM, YYYY"))),1)):g("",!0)])],8,gl)]),_:1},8,["label"]),n(k,{"min-width":"200",label:e.$t("Plan"),align:"right"},{default:h(p=>[s("div",$l,[n(f,{data:p.row},null,8,["data"]),n(u,{data:p.row},null,8,["data"])])]),_:1},8,["label"])]),_:1},8,["data","show-header"])])}const ut=D(nl,[["render",Cl]]),Al={name:"SubscriptionPlans",components:{OrderTableLoader:R,Badge:V,Pagination:X,SubscriptionTable:ut,EmptyState:te},props:{showLimit:{type:Number,default:10},showViewAllLink:{type:Boolean,default:!1}},data(){return{loading:!1,appLoaded:!1,subscriptions:[],canceling_subscription:!1,paginate:{current_page:1,per_page:10,total:0}}},methods:{subscriptionStatus(e){return e!=null&&e.overridden_status?e==null?void 0:e.overridden_status:e==null?void 0:e.status},modifySubscriptionResponse(e){return e.map(a=>{var i,y;return{...a,card_last_4:(y=(i=a==null?void 0:a.billingInfo)==null?void 0:i.card)==null?void 0:y.last_4}})},fetchSubscriptions(){this.loading=!0,this.$get("customer-profile/subscriptions",{per_page:this.paginate.per_page,page:this.paginate.current_page}).then(e=>{this.subscriptions=e.subscriptions.data,this.paginate.total=e.subscriptions.total}).finally(()=>{this.appLoaded=!0,this.loading=!1})},cancelSubscription(e,a,i){ElMessageBox.confirm(b("It will permanently cancel the active subscription from your payment provider. Are you sure to do that?"),b("Warning"),{type:"warning",cancelButtonText:b("No, keep this!"),confirmButtonText:b("Yes cancel this subscription!")}).then(()=>{this.canceling_subscription=!0,this.$put(`orders/${i}/subscriptions/${e}/cancel`,{data:{vendor_charge_id:a}}).then(()=>{this.canceling_subscription=!1,this.fetchSubscriptions()}).catch(y=>{this.canceling_subscription=!1,console.log(y)})})}},mounted(){this.fetchSubscriptions()}},Ml={class:"fc-customer-dashboard-subscriptions",role:"main","aria-labelledby":"subscriptions-title"},Sl={class:"fc-customer-dashboard-subscriptions-inner"},Dl={class:"fc-customer-dashboard-header"},Pl={id:"subscriptions-title",class:"fc-customer-dashboard-title"},Tl={key:1,class:"fc-customer-dashboard-loading","aria-live":"polite","aria-busy":"true"};function El(e,a,i,y,t,l){const u=m("SubscriptionTable"),d=m("OrderTableLoader"),f=m("EmptyState"),k=m("pagination");return r(),c("div",Ml,[s("div",Sl,[s("header",Dl,[s("h4",Pl,o(e.$t("Subscription Plans")),1)]),t.subscriptions.length?(r(),A(u,{key:0,subscriptions:t.subscriptions,"aria-label":e.$t("Subscription plans table")},null,8,["subscriptions","aria-label"])):t.loading?(r(),c("div",Tl,[n(d,{"rows-range":[1,2,3,4,5]})])):(r(),A(f,{key:2,title:e.$t("No subscriptions yet"),text:e.$t("Once you subscribe to a plan, it will appear here."),role:"status"},{icon:h(()=>a[0]||(a[0]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 40 40",fill:"none","aria-hidden":"true"},[s("path",{d:"M33.5429 11.9789C34.291 11.4426 35.3322 11.6143 35.8685 12.3624C37.4175 14.5232 38.3297 17.1585 38.3297 20.0001C38.3297 27.4066 32.172 33.3335 24.6727 33.3335H14.349V35C14.3491 35.419 14.1921 35.8383 13.8769 36.1623C13.235 36.8221 12.1798 36.8365 11.5201 36.1946L9.84873 34.5685C9.53043 34.259 9.11337 33.8536 8.86883 33.5373C8.65405 33.2595 8.03432 32.3905 8.48888 31.3226C8.93338 30.2785 9.96332 30.1015 10.3062 30.0543C10.7031 29.9996 11.2015 29.9998 11.6536 30.0001H11.7377H24.6727C30.4177 30.0001 34.9963 25.4803 34.9963 20.0001C34.9963 17.8841 34.3197 15.9231 33.1593 14.3045C32.623 13.5564 32.7949 12.5152 33.5429 11.9789Z",fill:"black"}),s("path",{opacity:"0.4",d:"M6.45682 28.0212C5.7087 28.5575 4.66751 28.3857 4.13121 27.6377C2.58217 25.4768 1.66992 22.8415 1.66992 20C1.66992 12.5934 7.82769 6.66658 15.327 6.66658H25.6507V5.00005C25.6507 4.58106 25.8075 4.16166 26.1228 3.83765C26.7647 3.17793 27.8198 3.16348 28.4797 3.8054L30.151 5.43163C30.4692 5.741 30.8863 6.1464 31.1308 6.46268C31.3457 6.74053 31.9653 7.60961 31.5108 8.67741C31.0663 9.72158 30.0363 9.89861 29.6935 9.94578C29.2965 10.0004 28.7982 10.0002 28.3462 9.99995L28.262 9.99991H15.327C9.58204 9.99991 5.00326 14.5198 5.00326 20C5.00326 22.1158 5.67996 24.0768 6.84032 25.6955C7.37662 26.4437 7.20492 27.4848 6.45682 28.0212Z",fill:"black"})],-1)])),_:1},8,["title","text"])),t.paginate.total?(r(),A(k,{key:3,hide_on_single:!0,pagination:t.paginate,onFetch:l.fetchSubscriptions,"aria-label":e.$t("Subscription pagination")},null,8,["pagination","onFetch","aria-label"])):g("",!0)])])}const Il=D(Al,[["render",El]]),Ll=["id"],Vl=["for"],Bl=["id","type","aria-describedby","aria-required"],xl=["src","id"],mt={__name:"InputField",props:{id:String,label:String,type:{type:String,default:"text"},imageUrl:{type:String,default:""},modelValue:{type:[String,Number],default:null}},emits:["update:modelValue","change","input"],setup(e,{emit:a}){const i=gt().ctx,y=Z(!1);Z();const t=e,l=a,u=Z(t.modelValue),d=p=>{y.value=p},f=p=>{i.$refs.input.value?y.value=!0:y.value=p},k=()=>{l("update:modelValue",u.value),l("change",u.value)},_=()=>{l("update:modelValue",u.value),l("input",u.value)};return lt(()=>t.modelValue,p=>{u.value=p}),ue(()=>{y.value=!!u.value}),ue(()=>{y.value=!!u.value}),(p,w)=>(r(),c("div",{class:O(["form-input-group",{"is-focused":y.value}]),id:e.id,role:"group"},[e.label?(r(),c("label",{key:0,for:e.id},o(e.label),9,Vl)):g("",!0),F(s("input",{id:e.id,type:e.type,ref:"input","onUpdate:modelValue":w[0]||(w[0]=P=>u.value=P),onFocus:w[1]||(w[1]=P=>d(!0)),onBlur:w[2]||(w[2]=P=>f(!1)),onChange:k,onInput:_,"aria-describedby":e.imageUrl?`${e.id}-icon`:null,"aria-required":p.required||!1},null,40,Bl),[[vt,u.value]]),e.imageUrl?(r(),c("img",{key:1,src:e.imageUrl,alt:"",id:`${e.id}-icon`,"aria-hidden":"true"},null,8,xl)):g("",!0)],10,Ll))}},Nl=["id"],Ul={disabled:"",value:""},Fl=["value"],Hl={__name:"SelectField",props:{id:String,options:{type:Array,required:!0,default:()=>[]},modelValue:{type:[String,Number],default:null},placeholder:{type:String,default:"Please select an option"}},emits:["update:modelValue"],setup(e,{emit:a}){const i=e,y=a,t=Z(i.modelValue);lt(()=>i.modelValue,u=>{t.value=u});const l=()=>{y("update:modelValue",t.value)};return(u,d)=>(r(),c("div",{class:"form-input-group",id:e.id},[F(s("select",{"onUpdate:modelValue":d[0]||(d[0]=f=>t.value=f),onChange:l},[s("option",Ul,o(e.placeholder),1),(r(!0),c(S,null,L(e.options,(f,k)=>(r(),c("option",{key:k,value:f.value},o(f.label),9,Fl))),128))],544),[[wt,t.value]])],8,Nl))}},Ol=()=>new Promise((e,a)=>{if(window.Stripe)e(window.Stripe);else{const i=document.createElement("script");i.src="https://js.stripe.com/v3/",i.async=!0,document.head.appendChild(i),i.onload=()=>{e(window.Stripe)},i.onerror=()=>{a(new Error("Failed to load Stripe script"))}}}),ql={components:{InputField:mt,SelectField:Hl,ArrowDown:It,ArrowUp:Lt},props:{subscription:{type:Object,required:!0},updateMethod:{type:Boolean,required:!0,default:!0}},data(){var e;return{currentPaymentMethod:"",cardNumber:null,cardExpiry:null,cardCvc:null,selectedAddress:"",updating:!1,switching:!1,reactivating:!1,invalidCard:!1,elementStates:{cardNumber:!1,cardExpiry:!1,cardCvc:!1},elementStyle:{base:{fontSize:"16px",color:"#32325d","::placeholder":{color:"#aab7c4"}},invalid:{color:"#fa755a"}},editing:!0,stripe:null,stripePubKey:(e=window.fluentcart_customer_profile_vars)==null?void 0:e.stripe_pub_key,loading:!1,errorMessage:"",successMessage:""}},computed:{getBillingAddresses(){return this.subscription.billing_addresses||[{}]}},methods:{translate:b,handleElementChange(e){this.elementStates[e.elementType]=e.complete,this.invalidCard=!(this.elementStates.cardNumber&&this.elementStates.cardExpiry&&this.elementStates.cardCvc)},async loadAndMountStripeElements(){this.loading=!0;let e=null;try{e=await Ol()}catch(i){this.handleError((i==null?void 0:i.message)||b("Error in loading stripe")),this.loading=!1}this.stripe=e(this.stripePubKey);const a=this.stripe.elements();this.cardNumber=a.create("cardNumber",{style:this.elementStyle,showIcon:!0}),this.cardNumber.mount("#card-number"),this.cardExpiry=a.create("cardExpiry",{style:this.elementStyle}),this.cardExpiry.mount("#card-expiry"),this.cardCvc=a.create("cardCvc",{style:this.elementStyle}),this.cardCvc.mount("#card-cvc"),this.loading=!1,this.cardNumber.on("change",this.handleElementChange),this.cardExpiry.on("change",this.handleElementChange),this.cardCvc.on("change",this.handleElementChange)},processNewPaymentMethod(){this.save()},async save(){this.updating=!0;const e=await this.createPaymentMethod();e&&this.currentPaymentMethod=="stripe"?this.updatePaymentMethodInStripe(e,"verify"):e&&this.currentPaymentMethod!="stripe"&&this.switchPaymentMethod(e,"verify")},async switchPaymentMethod(e,a="verify",i=""){var y;this.switching=!0,this.errorMessage="";try{const t=await this.$post("customer-profile/subscriptions/"+((y=this.subscription)==null?void 0:y.uuid)+"/switch-payment-method",{data:{newPaymentMethod:"stripe",currentPaymentMethod:this.currentPaymentMethod,vendorPaymentMethod:e,verification_status:a,customer_id:i},_fluentCart_rest_nonce:window.fluentCartRestVars.rest.nonce});if((t==null?void 0:t.status)==="requires_action"){const{setupIntent:l,error:u}=await this.stripe.confirmCardSetup(t==null?void 0:t.client_secret,{payment_method:e.id});if(u){this.errorMessage=u.message||b("Card verification failed"),this.switching=!1;return}l.status==="succeeded"?await this.switchPaymentMethod(e,"verified",t==null?void 0:t.customer_id):(this.errorMessage=b("Card verification failed"),this.switching=!1)}else(t==null?void 0:t.status)==="failed"?(this.resetData(),this.errorMessage=(t==null?void 0:t.message)||b("Card verification failed"),this.switching=!1,this.handleError(this.errorMessage)):(t==null?void 0:t.status)==="success"?(this.resetData(),this.handleSuccess(b("Payment method updated Successfully!")),this.successMessage=b("Payment method updated Successfully!"),this.closeUpdatePaymentModal(),this.$emit("fetchSubscription")):(this.resetData(),this.errorMessage=(t==null?void 0:t.message)||b("Something went wrong"),this.handleError((error==null?void 0:error.message)||b("Error in switching payment method")))}catch(t){this.resetData(),this.errorMessage=(t==null?void 0:t.message)||b("Something went wrong"),this.handleError((t==null?void 0:t.message)||b("Error in switching payment method")),this.switching=!1}finally{this.switching=!1}},async createPaymentMethod(){const e=this.getBillingAddresses.find(a=>a.id==this.selectedAddress);try{const{paymentMethod:a,error:i}=await this.stripe.createPaymentMethod({type:"card",card:this.cardNumber,billing_details:{name:e.name,email:e.email,phone:e.phone,address:{country:e.country,line1:e.address_1,line2:e.address_2,city:e.city,state:e.state,postal_code:e.postcode}}});return a}catch(a){this.errorMessage=(a==null?void 0:a.message)||b("Error in creating payment method"),this.resetData(),this.handleError(this.errorMessage)}},async updatePaymentMethodInStripe(e,a="verify"){this.updating=!0,this.errorMessage="";try{console.log("update...payment method",this.updateMethod,this.subscription);const i=await this.$post(`customer-profile/subscriptions/${this.subscription.uuid}/update-payment-method`,{data:{newPaymentMethod:e,method:"stripe",vendor_subscription_id:this.subscription.vendor_subscription_id,verification_status:a},_fluentCart_rest_nonce:window.fluentCartRestVars.rest.nonce});if((i==null?void 0:i.status)==="requires_action"){const{setupIntent:y,error:t}=await this.stripe.confirmCardSetup(i==null?void 0:i.client_secret,{payment_method:e.id});if(t){this.errorMessage=t.message||b("Card verification failed"),this.updating=!1;return}y.status==="succeeded"?await this.updatePaymentMethodInStripe(e,"verified"):(this.errorMessage=b("Card verification failed"),this.updating=!1)}else(i==null?void 0:i.status)==="failed"?(this.errorMessage=(i==null?void 0:i.message)||b("Card verification failed"),this.resetData(),this.handleError(this.errorMessage)):(i==null?void 0:i.status)==="success"?(this.handleSuccess(b("Payment method updated Successfully!")),this.resetData(),this.closeUpdatePaymentModal(),this.$emit("fetchSubscription")):(this.errorMessage=(i==null?void 0:i.message)||b("Something went wrong"),this.resetData(),this.handleError((error==null?void 0:error.message)||b("Error in updating payment method")))}catch(i){this.errorMessage=(i==null?void 0:i.message)||b("Something went wrong"),this.handleError((i==null?void 0:i.message)||b("Error in updating payment method")),this.updating=!1}},resetData(){this.cardNumber.clear(),this.cardExpiry.clear(),this.cardCvc.clear(),this.updating=!1,this.switching=!1,this.reactivating=!1,this.editing=!1,this.errorMessage=""},closeUpdatePaymentModal(){this.resetData(),this.$emit("close")}},mounted(){var a,i;this.$nextTick(()=>{this.loadAndMountStripeElements()}),console.log("update...payment method mounted",this.updateMethod),this.invalidCard=!0,this.currentPaymentMethod=(a=this.subscription)==null?void 0:a.current_payment_method;const e=(i=this.getBillingAddresses)==null?void 0:i.find(y=>y.is_primary);e&&(this.selectedAddress=e.id)}},Rl={role:"form","aria-labelledby":"stripe-payment-heading"},zl={id:"stripe-payment-heading",class:"sr-only"},Yl={class:"stripe-card-form"},jl={class:"form-group"},Kl={class:"form-row col-2"},Zl={class:"form-group"},Wl={for:"card-expiry"},Gl={class:"form-group"},Jl={for:"card-cvc"},Ql={class:"fc-update-payment-form-item"},Xl={class:"form-heading"},eo={class:"form-input-container"},to={for:"billing-select",class:"sr-only"},so={id:"billing-help",class:"sr-only"},ao={key:1},io={class:"text-red-500"},lo={key:0,class:"error-message",role:"alert","aria-live":"assertive"},oo={key:1,class:"success-message",role:"alert","aria-live":"assertive"},ro={class:"dialog-footer"};function no(e,a,i,y,t,l){const u=m("el-option"),d=m("el-select"),f=m("el-button"),k=q("loading");return r(),c("div",Rl,[s("h2",zl,o(l.translate("Stripe Payment Method")),1),F((r(),c("div",Yl,[s("div",jl,[s("label",null,o(l.translate("Card Number")),1),a[2]||(a[2]=s("div",{id:"card-number",class:"stripe-element","aria-describedby":"card-errors"},null,-1))]),s("div",Kl,[s("div",Zl,[s("label",Wl,o(l.translate("MM/YY")),1),a[3]||(a[3]=s("div",{id:"card-expiry",class:"stripe-element","aria-describedby":"card-errors"},null,-1))]),s("div",Gl,[s("label",Jl,o(l.translate("CVC")),1),a[4]||(a[4]=s("div",{id:"card-cvc",class:"stripe-element","aria-describedby":"card-errors"},null,-1))])]),a[5]||(a[5]=s("div",{id:"card-errors",class:"sr-only",role:"alert","aria-live":"assertive"},null,-1))])),[[k,t.loading]]),s("div",Ql,[s("h3",Xl,o(l.translate("Billing Address")),1),s("div",eo,[l.getBillingAddresses.length?(r(),c(S,{key:0},[s("label",to,o(l.translate("Select billing address")),1),n(d,{id:"billing-select",modelValue:t.selectedAddress,"onUpdate:modelValue":a[0]||(a[0]=_=>t.selectedAddress=_),placeholder:l.translate("Select"),"aria-describedby":"billing-help"},{default:h(()=>[(r(!0),c(S,null,L(l.getBillingAddresses,_=>(r(),A(u,{key:_.id,label:e.getAddress(_.formatted_address),value:_.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),s("small",so,o(l.translate("Choose an existing billing address or add a new one in profile settings.")),1)],64)):(r(),c("span",ao,[s("span",io,o(l.translate("No billing address found,")),1),v(" "+o(l.translate("please add a new address from"))+" ",1),s("span",{class:"cursor-pointer text-system-dark underline font-medium",onClick:a[1]||(a[1]=_=>e.$router.push({name:"profile"})),role:"link",tabindex:"0"},o(l.translate("here")),1)]))])]),t.errorMessage?(r(),c("div",lo,o(t.errorMessage),1)):g("",!0),t.successMessage?(r(),c("div",oo,o(t.successMessage),1)):g("",!0),s("div",ro,[n(f,{size:"small",onClick:l.closeUpdatePaymentModal,"aria-label":l.translate("Cancel")},{default:h(()=>[v(o(l.translate("Cancel")),1)]),_:1},8,["onClick","aria-label"]),n(f,{size:"small",type:"primary",onClick:l.processNewPaymentMethod,loading:t.updating||t.switching,disabled:t.updating||t.switching||t.invalidCard,"aria-disabled":t.updating||t.switching||t.invalidCard,"aria-label":i.updateMethod?l.translate("Update"):l.translate("Reactivate")},{default:h(()=>[v(o(i.updateMethod?l.translate("Update"):l.translate("Reactivate")),1)]),_:1},8,["onClick","loading","disabled","aria-disabled","aria-label"])])])}const co=D(ql,[["render",no],["__scopeId","data-v-caa104c7"]]),uo=()=>new Promise((e,a)=>{var i;if(window.paypal)e(window.paypal);else{const y=document.createElement("script");y.src=`https://www.paypal.com/sdk/js?client-id=${(i=window.fluentcart_customer_profile_vars)==null?void 0:i.paypal_client_id}&vault=true&intent=subscription`,y.async=!0,y.setAttribute("data-partner-attribution-id","FLUENTCART_SP_PPCP"),document.head.appendChild(y),y.onload=()=>{e(window.paypal)},y.onerror=()=>{a(new Error("Failed to load PayPal script"))}}}),mo={name:"Paypal",props:{subscription:{type:Object,required:!0},updateMethod:{type:Boolean,required:!0,default:!0}},emits:["close","fetchSubscription"],data(){var e;return{updatePaymentUrl:"",paypalClientId:(e=window.fluentcart_customer_profile_vars)==null?void 0:e.paypal_client_id,selectedAddress:"",loading:!1,planId:null,switching:!1,reactivating:!1,reason:"",errorMessage:"",successMessage:""}},computed:{getBillingAddresses(){return this.subscription.billing_addresses}},methods:{translate:b,closeUpdatePaymentModal(){this.$emit("close")},async loadPaypal(){this.loading=!0;let e=null;try{e=await uo()}catch(a){this.handleError((a==null?void 0:a.message)||"Error in loading paypal"),this.loading=!1}this.paypal=e,await this.loadPaypalButtons(),this.loading=!1},async getPlanId(){return this.updateMethod?await this.getPlanIdForUpdate():""},async getPlanIdForUpdate(){try{const e=await this.$post("customer-profile/subscriptions/"+this.subscription.uuid+"/get-or-create-plan",{data:{method:"paypal",reason:this.reason},_fluentCart_rest_nonce:window.fluentCartRestVars.rest.nonce});return(!e||!e.plan||!e.plan.id)&&(this.errorMessage=b("Invalid plan ID response!"),this.handleError(this.errorMessage)),e}catch(e){throw this.errorMessage=(e==null?void 0:e.message)||"Error in getPlanId",this.handleError(this.errorMessage),e}},async confirmNewPaypalSubscriptionSwitch(e,a){this.loading=!0,this.$post("customer-profile/subscriptions/"+this.subscription.uuid+"/confirm-subscription-switch",{data:{newVendorSubscriptionId:e,vendorOrderId:a,method:"paypal"},_fluentCart_rest_nonce:window.fluentCartRestVars.rest.nonce}).then(i=>{(i==null?void 0:i.status)==="success"?(this.handleSuccess(b("PayPal subscription updated successfully")),this.loading=!1,this.$emit("close"),this.$emit("fetchSubscription")):(i!=null&&i.message&&(this.errorMessage=i==null?void 0:i.message),this.loading=!1,this.handleError(this.errorMessage))}).catch(i=>{this.errorMessage=(i==null?void 0:i.message)||b("Error in confirming new paypal subscription"),this.handleError(this.errorMessage),this.loading=!1,this.$emit("close")})},async loadPaypalButtons(){const e=this.$refs.paypalButtonContainer;let a=null,i=null,y=null;e.innerHTML="";let t=this;try{await window.paypal.Buttons({style:{shape:"pill",layout:"vertical",label:"paypal",size:"responsive",disableMaxWidth:!0},createSubscription:async function(u,d){return d.subscription.create({plan_id:a,custom_id:t.subscription.uuid})},onApprove:function(u,d){u.subscriptionID&&(i=u.subscriptionID,y=u.orderID,t.confirmNewPaypalSubscriptionSwitch(i,y))},onClick:async function(u,d){try{const f=await t.getPlanId();if(!f||!f.plan||!f.plan.id)return d.reject();a=f.plan.id}catch{return d.reject()}},onError:u=>{var d,f;(d=this.paymentLoader)==null||d.changeLoaderStatus("error"),(f=this.paymentLoader)==null||f.hideLoader(),alert("PayPal error: "+u.toString())}}).render(e)}catch(l){console.error("PayPal Buttons failed to render:",l)}finally{this.loading=!1}}},mounted(){var a;this.$nextTick(()=>{this.loadPaypal()});const e=(a=this.getBillingAddresses)==null?void 0:a.find(i=>i.is_primary);e&&(this.selectedAddress=e.id),this.updateMethod&&(this.reason="update_payment_method")}},ho={role:"region","aria-labelledby":"paypal-section-heading"},_o={id:"paypal-section-heading",class:"sr-only"},po=["aria-label"],fo={key:0,class:"error-message",role:"alert","aria-live":"assertive"},bo={key:1,class:"success-message",role:"status","aria-live":"polite"},yo={class:"dialog-footer"};function go(e,a,i,y,t,l){const u=m("el-button"),d=q("loading");return r(),c("div",ho,[s("h2",_o,o(l.translate("PayPal Payment")),1),s("div",null,[F(s("div",{id:"paypal-button-container",ref:"paypalButtonContainer","aria-live":"polite","aria-label":l.translate("PayPal payment button")},null,8,po),[[d,t.loading]])]),t.errorMessage?(r(),c("div",fo,o(t.errorMessage),1)):g("",!0),t.successMessage?(r(),c("div",bo,o(t.successMessage),1)):g("",!0),s("div",yo,[n(u,{size:"small",onClick:l.closeUpdatePaymentModal,"aria-label":l.translate("Cancel")},{default:h(()=>[v(o(l.translate("Cancel")),1)]),_:1},8,["onClick","aria-label"])])])}const vo=D(mo,[["render",go],["__scopeId","data-v-4b354d7c"]]),wo={name:"UpdatePaymentInfos",components:{InputField:mt,Stripe:co,Paypal:vo},props:{subscription:{type:Object,required:!0},updateMethod:{type:Boolean,required:!0,default:!0},buttonText:{type:String,default:"Update Payment Method"}},data(){return{updatePaymentModal:!1,selectedPaymentMethod:this.subscription.current_payment_method,selectedAddress:"",stripePubKey:window.fluentcart_customer_profile_vars.stripe_pub_key,stripe:null,cardNumber:null,cardExpiry:null,cardCvc:null,loading:!1,error:"",updating:!1,invalidInput:!1}},computed:{getAllPaymentMethods(){var e;return((e=window.fluentcart_customer_profile_vars)==null?void 0:e.payment_methods)||[]},filteredPaymentMethods(){return this.subscription.can_switch_payment_method===!0?(this.getAllPaymentMethods||[]).filter(e=>{var a;return e&&((a=e.supported_features)==null?void 0:a.includes("switch_payment_method"))}):methods.filter(e=>e.slug===this.subscription.current_payment_method)}},methods:{translate:b,showUpdatePaymentModal(){this.updatePaymentModal=!0},closeUpdatePaymentModal(){this.updatePaymentModal=!1},fetchSubscription(){this.$emit("fetch")}},mounted(){}},ko={id:"update-payment-title",class:"sr-only"},$o={class:"fc-update-payment-method"},Co={class:"fc-update-payment-method-header"},Ao={id:"payment-methods-label",class:"sr-only"},Mo=["src","alt","title"],So={id:"update-payment-description",class:"sr-only"},Do={class:"fc-update-payment-method-body"},Po={class:"fc-update-payment-method-form"},To={key:0,class:"fc-update-payment-method-stripe"},Eo={key:1,class:"fc-update-payment-method-paypal"};function Io(e,a,i,y,t,l){const u=m("el-button"),d=m("el-radio"),f=m("el-radio-group"),k=m("Stripe"),_=m("Paypal"),p=m("el-dialog");return r(),c("div",null,[i.updateMethod?(r(),A(u,{key:0,onClick:l.showUpdatePaymentModal,text:"",class:"underline-link-button","aria-label":i.buttonText},{default:h(()=>[v(o(i.buttonText),1)]),_:1},8,["onClick","aria-label"])):(r(),A(u,{key:1,onClick:l.showUpdatePaymentModal,text:"",class:"underline-link-button","aria-label":l.translate("Reactivate")},{default:h(()=>[v(o(l.translate("Reactivate")),1)]),_:1},8,["onClick","aria-label"])),n(p,{modelValue:t.updatePaymentModal,"onUpdate:modelValue":a[1]||(a[1]=w=>t.updatePaymentModal=w),title:l.translate("Update Payment"),role:"dialog","aria-modal":"true","aria-labelledby":"update-payment-title","aria-describedby":"update-payment-description"},{default:h(()=>[s("h2",ko,o(l.translate("Update Payment")),1),s("div",$o,[s("div",Co,[s("label",Ao,o(l.translate("Select payment method")),1),n(f,{class:"fc-update-payment-method-radio",modelValue:t.selectedPaymentMethod,"onUpdate:modelValue":a[0]||(a[0]=w=>t.selectedPaymentMethod=w),role:"radiogroup","aria-labelledby":"payment-methods-label"},{default:h(()=>[(r(!0),c(S,null,L(l.filteredPaymentMethods,(w,P)=>(r(),A(d,{value:w.slug,key:w.slug,border:"","aria-label":`${w.title} payment method`},{default:h(()=>[s("img",{src:w.logo,alt:`${w.title} logo`,class:O(w.slug),title:w.title},null,10,Mo),v(" "+o(w.title),1)]),_:2},1032,["value","aria-label"]))),128))]),_:1},8,["modelValue"])]),s("div",So,o(l.translate("Update your payment method to continue with the subscription.")),1),s("div",Do,[s("div",Po,[t.selectedPaymentMethod=="stripe"?(r(),c("div",To,[n(k,{subscription:i.subscription,onClose:l.closeUpdatePaymentModal,onFetchSubscription:l.fetchSubscription,updateMethod:i.updateMethod},null,8,["subscription","onClose","onFetchSubscription","updateMethod"])])):g("",!0),t.selectedPaymentMethod=="paypal"?(r(),c("div",Eo,[n(_,{subscription:i.subscription,onClose:l.closeUpdatePaymentModal,onFetchSubscription:l.fetchSubscription,updateMethod:i.updateMethod},null,8,["subscription","onClose","onFetchSubscription","updateMethod"])])):g("",!0)])])])]),_:1},8,["modelValue","title"])])}const Lo=D(wo,[["render",Io]]),Vo={name:"TransactionPaymentMethod",props:{transaction:{type:Object,required:!0}},computed:{assetUrl(){return this.appVars.assets_path}}},Bo={class:"fc-transaction-payment-method",role:"status"},xo={key:0,class:"flex gap-2 items-center"},No=["src","alt"],Uo=["aria-label"],Fo=["aria-label"],Ho=["src","alt"],Oo={key:0,class:"text"},qo=["aria-label"],Ro={key:2,class:"text text-capitalize","aria-label":"Payment method: {{ transaction.payment_method }}"};function zo(e,a,i,y,t,l){return r(),c("div",Bo,[i.transaction.payment_method==="paypal"?(r(),c("div",xo,[s("img",{src:`${l.assetUrl}images/payment-methods/paypal-icon.svg`,alt:e.$t("PayPal logo")},null,8,No),s("span",{class:"text-gray-700 text-sm","aria-label":e.$t("Transaction ID:")+i.transaction.vendor_charge_id||""},o(i.transaction.vendor_charge_id||""),9,Uo)])):parseInt(i.transaction.card_last_4)?(r(),c("div",{key:1,class:"flex gap-2 items-center",role:"img","aria-label":e.$t("Credit card payment method")},[s("img",{src:`${l.assetUrl}images/credit-card/card.svg`,alt:e.$t("Credit Card logo")},null,8,Ho),i.transaction.card_brand?(r(),c("span",Oo,o(i.transaction.card_brand),1)):g("",!0),s("span",{class:"text","aria-label":e.$t("Credit card ending in")+" "+i.transaction.card_last_4}," **** "+o(i.transaction.card_last_4),9,qo)],8,Fo)):(r(),c("span",Ro,o(i.transaction.payment_method),1))])}const Yo=D(Vo,[["render",zo]]),jo={name:"TransactionsTable",components:{AddressComponent:ie,MaterialInput:ee,Badge:V,DynamicIcon:x,TransactionPaymentMethod:Yo},props:{transactions:{type:Array,default:()=>[]},showTableHeader:{type:Boolean,default:!0}},data(){return{isEditingBillingAddressModal:!1,validationErrors:{},billingAddressData:{name:"",address_1:"",address_2:"",city:"",state:"",postcode:"",country:"",vat_tax_id:""},formFields:[{key:"name",label:b("Name/Business Name"),required:!0}],selectedTransaction:null,updatingAddress:!1,address_id:null}},methods:{translate:b,handleTransactionCommand(e,a){e==="edit_billing_address"&&(this.selectedTransaction=a,this.isEditingBillingAddressModal=!0)},fetchBillingAddress(){this.$get(`customer-profile/orders/${this.selectedTransaction.uuid}/billing-address`).then(e=>{this.billingAddressData=e.data,this.billingAddressData.address_1=e.data.address_1,this.billingAddressData.address_2=e.data.address_2,this.billingAddressData.city=e.data.city,this.billingAddressData.state=e.data.state,this.billingAddressData.postcode=e.data.postcode,this.billingAddressData.country=e.data.country,this.billingAddressData.name=e.data.name,this.billingAddressData.vat_tax_id=e.data.vat_tax_id,this.address_id=e.data.address_id}).catch(e=>{e.message&&this.handleError(e)}).finally(()=>{})},updateBillingAddress(){this.updatingAddress=!0,this.$put(`customer-profile/orders/${this.selectedTransaction.uuid}/billing-address`,{name:this.billingAddressData.name,address_1:this.billingAddressData.address_1,address_2:this.billingAddressData.address_2,city:this.billingAddressData.city,state:this.billingAddressData.state,postcode:this.billingAddressData.postcode,country:this.billingAddressData.country,vat_tax_id:this.billingAddressData.vat_tax_id,transaction_uuid:this.selectedTransaction.uuid,address_id:this.address_id}).then(e=>{this.handleSuccess(e.message),this.isEditingBillingAddressModal=!1,this.$emit("billing-address-updated",e.formatted_address)}).catch(e=>{this.handleError(e),this.validationErrors=e}).finally(()=>{this.updatingAddress=!1})},handleCloseModal(){this.isEditingBillingAddressModal=!1,this.selectedTransaction=null}}},Ko=["aria-label"],Zo=["datetime"],Wo=["innerHTML","aria-label"],Go={class:"flex items-center gap-2 justify-between"},Jo=["href","aria-label"],Qo=["aria-label"],Xo={class:"fc-customer-dashboard-add-address-form-wrap"},er={class:"fc-compact-form"},tr={class:"dialog-footer"};function sr(e,a,i,y,t,l){const u=m("el-table-column"),d=m("Badge"),f=m("TransactionPaymentMethod"),k=m("DynamicIcon"),_=m("el-dropdown-item"),p=m("el-dropdown-menu"),w=m("el-dropdown"),P=m("el-table"),E=m("MaterialInput"),T=m("AddressComponent"),C=m("el-button"),B=m("el-dialog");return r(),c("div",null,[n(P,{data:i.transactions,"aria-label":e.$t("Transactions Table")},{default:h(()=>[n(u,{label:"#",width:150},{default:h($=>[s("span",{class:"text truncate","aria-label":e.$t("Invoice Number")+" "+$.row.invoice_no},"#"+o($.row.invoice_no),9,Ko)]),_:1}),n(u,{label:e.$t("Date"),width:120},{default:h($=>[s("time",{class:"text truncate",datetime:$.row.created_at},o(e.formatDate($.row.created_at)),9,Zo)]),_:1},8,["label"]),n(u,{label:e.$t("Amount"),width:"90"},{default:h($=>[s("span",{class:"text",innerHTML:e.formatNumber($.row.total,!0,!1,$.row.currency),"aria-label":e.$t("Amount")},null,8,Wo)]),_:1},8,["label"]),n(u,{label:e.$t("Status"),width:110},{default:h($=>[n(d,{type:$.row.status,size:"small","aria-label":e.$t("Status")+": "+$.row.status},{default:h(()=>[v(o($.row.status),1)]),_:2},1032,["type","aria-label"])]),_:1},8,["label"]),n(u,{label:e.$t("Type"),width:100},{default:h($=>[n(d,{type:$.row.order_type,size:"small","aria-label":e.$t("Order Type")+": "+$.row.order_type},{default:h(()=>[v(o($.row.order_type),1)]),_:2},1032,["type","aria-label"])]),_:1},8,["label"]),n(u,{label:e.$t("Payment Method"),"min-width":160},{default:h($=>[n(f,{transaction:$.row},null,8,["transaction"])]),_:1},8,["label"]),n(u,{width:125},{default:h($=>[s("div",Go,[s("a",{href:$.row.receipt_url,target:"_blank",class:"underline-link-button","aria-label":e.$t("Download Receipt for Invoice")+" "+$.row.invoice_no,rel:"noopener noreferrer"},[n(k,{name:"Download",class:"w-4 h-4","aria-hidden":"true"}),v(" "+o(e.$t("Receipt")),1)],8,Jo),n(w,{trigger:"click",class:"fc-more-option-wrap","popper-class":"fc-dropdown",onCommand:N=>l.handleTransactionCommand(N,$.row),"aria-label":e.$t("More Actions")},{dropdown:h(()=>[n(p,null,{default:h(()=>[n(_,{command:"edit_billing_address"},{default:h(()=>[v(o(l.translate("Edit Billing Address")),1)]),_:1})]),_:1})]),default:h(()=>[s("span",{class:"more-btn w-4 h-4 flex items-center justify-center cursor-pointer","aria-haspopup":"true","aria-label":e.$t("More Actions")},[n(k,{name:"More",class:"w-1","aria-hidden":"true"})],8,Qo)]),_:2},1032,["onCommand","aria-label"])])]),_:1})]),_:1},8,["data","aria-label"]),n(B,{modelValue:t.isEditingBillingAddressModal,"onUpdate:modelValue":a[2]||(a[2]=$=>t.isEditingBillingAddressModal=$),title:l.translate("Edit Billing Address"),"append-to-body":!0,"modal-class":"fct-transaction-billing-address-modal",onOpen:l.fetchBillingAddress,class:"fluent-cart-customer-profile-app fc-customer-root-container","aria-modal":"true",role:"dialog"},{footer:h(()=>[s("div",tr,[n(C,{type:"info",soft:"",onClick:l.handleCloseModal},{default:h(()=>[v(o(l.translate("Cancel")),1)]),_:1},8,["onClick"]),n(C,{type:"primary",loading:t.updatingAddress,onClick:l.updateBillingAddress},{default:h(()=>[v(o(l.translate("Update Address")),1)]),_:1},8,["loading","onClick"])])]),default:h(()=>[s("div",Xo,[s("div",er,[(r(!0),c(S,null,L(t.formFields,($,N)=>(r(),A(E,{key:N,required:$.required,label:$.label,modelValue:t.billingAddressData[$.key],"onUpdate:modelValue":U=>t.billingAddressData[$.key]=U,class:O(t.validationErrors[$.key]?"is-error":"")},null,8,["required","label","modelValue","onUpdate:modelValue","class"]))),128)),n(T,{use_additional_address_fields:"",modelValue:t.billingAddressData,"onUpdate:modelValue":a[0]||(a[0]=$=>t.billingAddressData=$),validationErrors:t.validationErrors},null,8,["modelValue","validationErrors"]),n(E,{label:l.translate("Vat Tax ID"),modelValue:t.billingAddressData.vat_tax_id,"onUpdate:modelValue":a[1]||(a[1]=$=>t.billingAddressData.vat_tax_id=$),class:O(t.validationErrors.vat_tax_id?"is-error":"")},null,8,["label","modelValue","class"])])])]),_:1},8,["modelValue","title","onOpen"])])}const ht=D(jo,[["render",sr]]),ar={name:"SingleSubscription",props:{subscription_uuid:String},components:{TransactionsTable:ht,IconButton:Q,UpdatePaymentInfos:Lo,UpgradePlan:ct,DynamicIcon:x,Badge:V,LicenseTable:oe},data(){return{subscription:null,loading:!0,cancelling:!1}},computed:{isCancelable(){var e,a;return!(((e=this.subscription)==null?void 0:e.bill_times)>1||((a=this.subscription)==null?void 0:a.status)==="canceled")},ArrowRight(){return rt}},methods:{fetchSubscription(){this.loading=!0,this.$get(`customer-profile/subscriptions/${this.subscription_uuid}`).then(e=>{this.subscription=e.subscription}).catch(e=>{this.handleError(e)}).finally(()=>{this.loading=!1})},pluralizeTranslate:G,cancelSubscription(){this.cancelling=!0,this.$post(`customer-profile/subscriptions/${this.subscription.uuid}/cancel-auto-renew`,{method:this.subscription.current_payment_method}).then(e=>{this.$notify.success(e.message)}).catch(e=>{this.handleError(e)}).finally(()=>{this.cancelling=!1,this.fetchSubscription()})},subscriptionStatus(){var e,a,i;return(e=this.subscription)!=null&&e.overridden_status?(a=this.subscription)==null?void 0:a.overridden_status:(i=this.subscription)==null?void 0:i.status}},mounted(){this.fetchSubscription()}},ir={class:"fc-customer-dashboard-single-subcription-wrap fc-customer-dashboard-layout-width",role:"main","aria-labelledby":"subscription-overview-title"},lr={class:"fc-customer-dashboard-single-subscription"},or={class:"fc-customer-dashboard-breadcrumb mb-8"},rr={key:0,class:"fc-renew-box mb-4"},nr={class:"text-center p-4"},dr={class:"p-0 m-0 mb-3"},cr=["href","aria-label"],ur={class:"p-0 m-0 mb-3"},mr=["href","aria-label"],hr={class:"fc-single-order-box mb-11 lg:mb-6",role:"region","aria-labelledby":"subscription-details-title"},_r={class:"fc-single-order-header"},pr={id:"subscription-details-title",class:"title"},fr={class:"fc-single-order-body"},br={class:"fc-single-order-box-inner"},yr={class:"fc-customer-dashboard-content-table-item border-0 pb-0"},gr={class:"left-content"},vr={class:"fc-product-info-card"},wr={class:"fc-product-info-card-inner"},kr={class:"product-info-content"},$r={class:"title truncate-none"},Cr={class:"variation-title"},Ar={class:"right-content !w-auto"},Mr={id:"cancel-popover-title",class:"sr-only"},Sr={class:"flex justify-end gap-2"},Dr=["aria-label"],Pr={class:"fc-customer-dashboard-content-table-item border-0 pb-0"},Tr={class:"left-content"},Er={class:"title"},Ir=["aria-label","innerHTML"],Lr={key:0,class:"fc-customer-dashboard-content-table-item border-0 pb-0"},Vr={class:"left-content"},Br={class:"title"},xr=["aria-label"],Nr={class:"fc-customer-dashboard-content-table-item border-0 pb-0"},Ur={class:"left-content"},Fr={class:"title"},Hr=["aria-label"],Or=["aria-label"],qr={key:1},Rr={class:"fc-single-order-footer mt-3"},zr={class:"flex items-center gap-3"},Yr={key:1,class:"fc-single-order-box",role:"region","aria-labelledby":"licenses-title"},jr={class:"fc-single-order-header"},Kr={id:"licenses-title",class:"title"},Zr={class:"fc-single-order-box",role:"region","aria-labelledby":"transactions-title"},Wr={class:"fc-single-order-header"},Gr={id:"transactions-title",class:"title"},Jr={class:"fc-customer-dashboard-table"},Qr={key:1,"aria-live":"polite"};function Xr(e,a,i,y,t,l){var re,ne,de,ce;const u=m("el-breadcrumb-item"),d=m("el-breadcrumb"),f=m("el-alert"),k=m("Badge"),_=m("DynamicIcon"),p=m("IconButton"),w=m("el-button"),P=m("el-popover"),E=m("el-dropdown-item"),T=m("el-dropdown-menu"),C=m("el-dropdown"),B=m("UpgradePlan"),$=m("UpdatePaymentInfos"),N=m("router-link"),U=m("LicenseTable"),z=m("TransactionsTable"),Y=m("el-skeleton");return r(),c("div",ir,[s("div",lr,[s("div",or,[n(d,{"separator-icon":l.ArrowRight,role:"navigation","aria-label":e.$t("Breadcrumb")},{default:h(()=>[n(u,{class:"cursor-pointer",to:{path:"/subscriptions"}},{default:h(()=>[v(o(e.$t("Subscription Plans")),1)]),_:1}),n(u,{"aria-current":"page"},{default:h(()=>[v(o(e.$t("Overview")),1)]),_:1})]),_:1},8,["separator-icon","aria-label"])]),t.subscription?(r(),c(S,{key:0},[t.subscription.reactivate_url?(r(),c("div",rr,[n(f,{type:"error",closable:!1,role:"alert"},{default:h(()=>[s("div",nr,[t.subscription.status==="expired"?(r(),c(S,{key:0},[s("p",dr,o(e.$t("Your subscription has expired at %s. Please renew to keep things running smoothly.",e.formatDate(t.subscription.expire_at))),1),s("a",{href:t.subscription.reactivate_url,class:"el-button el-button--primary","aria-label":e.$t("Renew Subscription Plan")},o(e.$t("Renew Subscription Plan")),9,cr)],64)):(r(),c(S,{key:1},[s("p",ur,o(e.$t("Your subscription status is now: %s. Please reactivate to keep things running smoothly.",t.subscription.status)),1),s("a",{href:t.subscription.reactivate_url,class:"el-button el-button--primary","aria-label":e.$t("Reactivate Subscription Plan")},o(e.$t("Reactivate Subscription Plan")),9,mr)],64))])]),_:1})])):g("",!0),s("article",hr,[s("header",_r,[s("h1",pr,o(e.$t("Subscription Plan Details")),1)]),s("div",fr,[s("div",br,[s("div",yr,[s("div",gr,[s("div",vr,[s("div",wr,[s("div",kr,[s("div",$r,[v(o(t.subscription.title)+" ",1),n(k,{status:l.subscriptionStatus(),size:"small"},null,8,["status"])]),s("div",Cr,o(t.subscription.subtitle),1)])])])]),s("div",Ar,[l.isCancelable?(r(),A(C,{key:0,trigger:"click","hide-on-click":!1,"popper-class":"fc-dropdown",role:"menu","aria-haspopup":"true","aria-expanded":"false"},{dropdown:h(()=>[n(T,{role:"menu"},{default:h(()=>[n(E,{role:"menuitem"},{default:h(()=>[n(P,{"popper-class":"fluent-cart-customer-profile-app",trigger:"click",placement:"bottom",width:260,ref:"popoverRef",role:"dialog","aria-modal":"true","aria-labelledby":"cancel-popover-title"},{reference:h(()=>[s("span",{"aria-label":e.$t("Cancel Subscription")},o(e.$t("Cancel Subscription")),9,Dr)]),default:h(()=>[s("h3",Mr,o(e.$t("Cancel Subscription")),1),s("div",null,o(e.$t("You are about to cancel the subscription. Are you sure?")),1),s("div",Sr,[n(w,{class:"el-button--x-small",text:"",onClick:a[0]||(a[0]=_c=>e.$refs.popoverRef.hide()),"aria-label":e.$t("Cancel")},{default:h(()=>[v(o(e.$t("Cancel")),1)]),_:1},8,["aria-label"]),n(w,{class:"el-button--x-small",type:"primary",loading:t.cancelling,onClick:l.cancelSubscription,"aria-label":e.$t("Yes, Proceed")},{default:h(()=>[v(o(e.$t("Yes, Proceed")),1)]),_:1},8,["loading","onClick","aria-label"])])]),_:1},512)]),_:1})]),_:1})]),default:h(()=>[n(p,{tag:"button",size:"x-small",class:"simple-icon-btn","aria-label":e.$t("Subscription options")},{default:h(()=>[n(_,{name:"More",class:"w-[5px]","aria-hidden":"true"})]),_:1},8,["aria-label"])]),_:1})):g("",!0)])]),s("div",Pr,[s("div",Tr,[s("div",Er,o(e.$t("Billing Terms")),1),s("span",{class:"text","aria-label":e.$t("Billing Terms"),innerHTML:t.subscription.payment_info},null,8,Ir)])]),t.subscription.status=="active"||t.subscription.status=="trialing"?(r(),c("div",Lr,[s("div",Vr,[s("div",Br,o(e.$t("Next Charge")),1),s("span",{class:"text","aria-label":e.$t("Next Charge")},o(e.formatDate(t.subscription.next_billing_date)),9,xr)])])):g("",!0),s("div",Nr,[s("div",Ur,[s("div",Fr,o(e.$t("Payment Method")),1),s("span",{class:"text","aria-label":e.$t("Payment Method")},[(re=t.subscription.billing_info.details)!=null&&re.last_4?(r(),c("span",{key:0,"aria-label":e.$t("Credit Card ending in")+" "+((ne=t.subscription.billing_info.details)==null?void 0:ne.last_4)}," **** "+o((de=t.subscription.billing_info.details)==null?void 0:de.last_4),9,Or)):(r(),c("span",qr,o(t.subscription.current_payment_method),1))],8,Hr)])])])]),s("footer",Rr,[s("div",zr,[(ce=t.subscription)!=null&&ce.can_upgrade?(r(),A(B,{key:0,"button-type":"primary","button-text":e.$t("Upgrade Plan"),variation_id:t.subscription.variation_id,order_hash:t.subscription.order.uuid},null,8,["button-text","variation_id","order_hash"])):g("",!0),t.subscription.can_update_payment_method?(r(),A($,{key:1,subscription:t.subscription,buttonText:e.$t("Update Payment Method"),onFetch:l.fetchSubscription,updateMethod:!0},null,8,["subscription","buttonText","onFetch"])):g("",!0),n(N,{class:"underline-link-button",to:{name:"view_order",params:{order_id:t.subscription.order.uuid}},"aria-label":e.$t("View Order")},{default:h(()=>[v(o(e.$t("View Order")),1)]),_:1},8,["to","aria-label"])])])]),t.subscription.licenses&&t.subscription.licenses.length?(r(),c("article",Yr,[s("header",jr,[s("h2",Kr,o(l.pluralizeTranslate("Connected License","Connected Licenses",t.subscription.licenses.length)),1)]),n(U,{is_simple:!0,licenses:t.subscription.licenses,showTableHeader:!1},null,8,["licenses"])])):g("",!0),s("article",Zr,[s("header",Wr,[s("h2",Gr,o(e.$t("Related Transactions")),1)]),s("div",Jr,[n(z,{transactions:t.subscription.transactions,"show-table-header":!0},null,8,["transactions"])])])],64)):t.loading?(r(),c("div",Qr,[n(Y,{rows:5,animated:!0})])):g("",!0)])])}const en=D(ar,[["render",Xr]]),tn={class:"fc-purchase-history-route-wrap"},sn=Object.assign({name:"PurchaseHistoryRoute"},{__name:"PurchaseHistoryRoute",setup(e){return(a,i)=>{const y=m("router-view");return r(),c("div",tn,[n(y)])}}}),an={name:"AccountDetails.vue",props:["profileDetails"],components:{MaterialInput:ee},data(){return{accountDetailsDescId:"account-details-desc"}},methods:{translate:b}},ln={class:"fc-form-container",role:"region","aria-labelledby":"account-details-heading"},on={class:"form-left"},rn={id:"account-details-heading",class:"form-heading"},nn=["id"],dn={class:"form-right"},cn={class:"sr-only"},un={class:"fc-compact-form",id:"account-details"};function mn(e,a,i,y,t,l){const u=m("MaterialInput");return r(),c("div",ln,[s("div",on,[s("h3",rn,o(l.translate("Account Details")),1),s("p",{id:t.accountDetailsDescId,class:"form-desc"},o(l.translate("Manage and update your personal information.")),9,nn)]),s("div",dn,[s("span",cn,o(l.translate("Account Details")),1),s("div",un,[n(u,{"aria-describedby":t.accountDetailsDescId,label:l.translate("First Name"),modelValue:i.profileDetails.first_name,"onUpdate:modelValue":a[0]||(a[0]=d=>i.profileDetails.first_name=d)},null,8,["aria-describedby","label","modelValue"]),n(u,{"aria-describedby":t.accountDetailsDescId,label:l.translate("Last Name"),modelValue:i.profileDetails.last_name,"onUpdate:modelValue":a[1]||(a[1]=d=>i.profileDetails.last_name=d)},null,8,["aria-describedby","label","modelValue"]),n(u,{"aria-describedby":t.accountDetailsDescId,label:l.translate("Email"),disabled:"",modelValue:i.profileDetails.email,"onUpdate:modelValue":a[2]||(a[2]=d=>i.profileDetails.email=d)},null,8,["aria-describedby","label","modelValue"])])])])}const hn=D(an,[["render",mn]]),_n={name:"AddressModal",props:["modalAction","newAddressData","showModal","profileDetails","isEditAddress"],emits:["fetch"],components:{DynamicIcon:x,AddressComponent:ie,MaterialInput:ee},data(){return{addressModalTitleId:"address-modal-title",validationErrors:{},addAddressLoading:!1,addNewAddressModalVisible:!1,localIsEditAddress:!1,localAddressData:{label:"",name:"",email:"",phone:"",address_1:"",address_2:"",city:"",state:"",postcode:"",country:""},formRules:{name:[b("Name is required.")],email:[b("Email is required.")],country:[b("Country is required.")],postcode:[b("Postcode is required.")]},formFields:[{key:"label",label:b("Address label e.g Home, Office"),required:!1},{key:"name",label:b("Name"),required:!0},{key:"email",label:b("Email"),required:!0},{key:"phone",label:b("Phone"),required:!1}]}},watch:{showModal(){this.addNewAddressModalVisible=this.showModal},newAddressData:{handler(e){e&&this.isEditAddress&&(this.localAddressData={...e})},deep:!0,immediate:!0},isEditAddress:{handler(e){e||this.resetFormDataAndValidation()},immediate:!0}},methods:{translate:b,validateForm(){const e={};return Object.keys(this.formRules).forEach(a=>{(!this.localAddressData[a]||this.localAddressData[a].trim()==="")&&(e[a]={required:this.formRules[a][0]})}),this.validationErrors=e,Object.keys(e).length===0},addAddress(){if(this.validateForm()){this.addAddressLoading=!0;let e={type:this.modalAction,customer_id:this.profileDetails.id},a={...this.localAddressData,...e};this.$post("customer-profile/create-address",{type:a.type,label:a.label,name:a.name,phone:a.phone,email:a.email,country:a.country,state:a.state,address_1:a.address_1,address_2:a.address_2,city:a.city,postcode:a.postcode}).then(i=>{I.success(i),this.closeModal(),this.addAddressLoading=!1,this.resetFormDataAndValidation(),this.$emit("fetch")}).catch(i=>{i!=null&&i.message&&I.error(i),this.validationErrors=i}).finally(()=>{this.addAddressLoading=!1})}else I.error(b("Please fill in all the required fields."))},editAddress(){if(this.validateForm()){this.addAddressLoading=!0;let e={...this.localAddressData};this.$post("customer-profile/edit-address",{id:e.id,label:e.label,name:e.name,phone:e.phone,email:e.email,country:e.country,state:e.state,address_1:e.address_1,address_2:e.address_2,city:e.city,postcode:e.postcode,type:e.type}).then(a=>{I.success(a),this.closeModal(),this.addAddressLoading=!1,this.resetFormDataAndValidation(),this.$emit("fetch")}).catch(a=>{I.error(a)}).finally(()=>{this.addAddressLoading=!1})}else I.error(b("Please fill in all the required fields."))},openModal(){this.addNewAddressModalVisible=!0},closeModal(){this.addNewAddressModalVisible=!1},getModalTitle(){return this.localIsEditAddress?b("Edit address"):this.modalAction==="billing"?b("Add new billing address"):this.modalAction==="shipping"?b("Add new shipping address"):b("Add new address")},handleAddNewAddressModal(e,a=null){e==="edit"&&a?(this.localAddressData={...a},this.localIsEditAddress=!0):(this.resetFormDataAndValidation(),this.localIsEditAddress=!1),this.addNewAddressModalVisible=!0},resetFormDataAndValidation(){Object.keys(this.localAddressData).forEach(e=>{this.localAddressData[e]=""}),this.validationErrors={}}}},pn={class:"fc-customer-dashboard-add-address-form-wrap"},fn=["id"],bn={class:"fc-compact-form"},yn={id:"addressFormDescId",class:"sr-only"},gn={key:0,class:"form-error-wrap",role:"alert","aria-live":"assertive","aria-atomic":"true"},vn={class:"dialog-footer"};function wn(e,a,i,y,t,l){const u=m("el-button"),d=m("MaterialInput"),f=m("AddressComponent"),k=m("el-dialog");return r(),c(S,null,[n(u,{size:"small",onClick:a[0]||(a[0]=_=>l.handleAddNewAddressModal()),"aria-label":l.translate("Add New Address"),"aria-haspopup":"dialog"},{default:h(()=>[v(o(l.translate("Add New Address")),1)]),_:1},8,["aria-label"]),n(k,{modelValue:t.addNewAddressModalVisible,"onUpdate:modelValue":a[3]||(a[3]=_=>t.addNewAddressModalVisible=_),"append-to-body":!0,title:l.getModalTitle(),onClosed:l.resetFormDataAndValidation,class:"fluent-cart-customer-profile-app fc-customer-root-container",role:"dialog","aria-modal":"true","aria-labelledby":t.addressModalTitleId,"aria-describedby":e.addressFormDescId,tabindex:"-1"},{footer:h(()=>[s("div",vn,[n(u,{type:"info",soft:"",onClick:a[2]||(a[2]=_=>t.addNewAddressModalVisible=!1),"aria-label":l.translate("Cancel")},{default:h(()=>[v(o(l.translate("Cancel")),1)]),_:1},8,["aria-label"]),t.localIsEditAddress?(r(),A(u,{key:0,type:"primary",loading:t.addAddressLoading,onClick:l.editAddress,"aria-label":l.translate("Update Address")},{default:h(()=>[v(o(l.translate("Update Address")),1)]),_:1},8,["loading","onClick","aria-label"])):(r(),A(u,{key:1,type:"primary",loading:t.addAddressLoading,onClick:l.addAddress,"aria-label":l.translate("Add Address")},{default:h(()=>[v(o(l.translate("Add Address")),1)]),_:1},8,["loading","onClick","aria-label"]))])]),default:h(()=>[s("div",pn,[s("h2",{id:t.addressModalTitleId,class:"sr-only"},o(l.getModalTitle()),9,fn),s("form",bn,[(r(!0),c(S,null,L(t.formFields,(_,p)=>(r(),A(d,{key:p,required:_.required,label:_.label,modelValue:t.localAddressData[_.key],"onUpdate:modelValue":w=>t.localAddressData[_.key]=w,class:O(t.validationErrors[_.key]?"is-error":""),"aria-invalid":!!t.validationErrors[_.key],"aria-describedby":t.validationErrors[_.key]?`${_.key}-error`:null},null,8,["required","label","modelValue","onUpdate:modelValue","class","aria-invalid","aria-describedby"]))),128)),n(f,{use_additional_address_fields:"",modelValue:t.localAddressData,"onUpdate:modelValue":a[1]||(a[1]=_=>t.localAddressData=_),validationErrors:t.validationErrors},null,8,["modelValue","validationErrors"])]),s("div",yn,o(l.translate("Form to add or edit address. Required fields are marked with an asterisk.")),1),Object.keys(t.validationErrors).length?(r(),c("div",gn,[(r(!0),c(S,null,L(t.validationErrors,_=>(r(),c("p",null,o(_.required||_.email||_.max),1))),256))])):g("",!0)])]),_:1},8,["modelValue","title","onClosed","aria-labelledby","aria-describedby"])],64)}const kn=D(_n,[["render",wn]]),$n={name:"AddressSection",props:{profileDetails:Object,addressType:String,title:String,description:String},emits:["fetch","setAddressPrimary","deleteAddress"],data(){return{addressSectionTitleId:`address-section-title-${this.addressType}`,isEditAddress:!1,newAddressData:{label:"",name:"",email:"",phone:"",address_1:"",address_2:"",city:"",state:"",postcode:"",country:""}}},components:{DynamicIcon:x,Badge:V,AddressModal:kn},computed:{addresses(){return this.profileDetails[`${this.addressType}_address`]||[]},sortedAddresses(){return this.addresses.sort((e,a)=>a.is_primary-e.is_primary)}},methods:{translate:b,handleAddressCommand(e){const{action:a,data:i}=e;a==="edit"?(this.isEditAddress=!0,this.newAddressData={...i},this.$refs.modalRef.handleAddNewAddressModal("edit",i)):a==="default"?this.$emit("setAddressPrimary",i):a==="remove"&&le.confirm(b("Are you sure want to delete this address?"),b("Warning"),{customClass:"fluent-cart-customer-profile-app",confirmButtonText:b("Yes, Delete!"),cancelButtonText:b("Cancel"),cancelButtonClass:"el-button--small",confirmButtonClass:"el-button--small",type:"warning"}).then(()=>{this.$emit("deleteAddress",i)}).catch(()=>{})}}},Cn=["aria-labelledby"],An={class:"form-left"},Mn=["id"],Sn={class:"form-desc"},Dn={class:"form-right"},Pn=["aria-label"],Tn={class:"title"},En={class:"text"},In={class:"fc-address-action"},Ln=["aria-label"],Vn={key:1,class:"text-sm text-system-mid",role:"status","aria-live":"polite"};function Bn(e,a,i,y,t,l){const u=m("AddressModal"),d=m("Badge"),f=m("DynamicIcon"),k=m("el-dropdown-item"),_=m("el-dropdown-menu"),p=m("el-dropdown");return r(),c("div",{class:"fc-form-container",role:"region","aria-labelledby":t.addressSectionTitleId},[s("div",An,[s("h3",{id:t.addressSectionTitleId,class:"form-heading"},o(i.title),9,Mn),s("p",Sn,o(i.description),1),n(u,{ref:"modalRef",modalAction:i.addressType,onFetch:a[0]||(a[0]=w=>e.$emit("fetch")),isEditAddress:t.isEditAddress,newAddressData:t.newAddressData,profileDetails:i.profileDetails},null,8,["modalAction","isEditAddress","newAddressData","profileDetails"])]),s("div",Dn,[l.addresses.length?(r(),c("ul",{key:0,class:"fc-customer-address-list",role:"list","aria-label":`${i.addressType} addresses`},[(r(!0),c(S,null,L(l.sortedAddresses,w=>(r(),c("li",{class:O(`fc-customer-address-block ${w.is_primary==="1"?"default-address":""}`),key:w.id,role:"listitem"},[s("div",Tn,[v(o(w.label)+" ",1),w.is_primary==="1"?(r(),A(d,{key:0,"hide-icon":!0,highContrast:"",size:"small","aria-label":l.translate("Default")},{default:h(()=>[v(o(l.translate("Default")),1)]),_:1},8,["aria-label"])):g("",!0)]),s("p",En,o(e.getAddress(w.formatted_address,"")),1),s("div",In,[n(p,{trigger:"click",class:"fc-more-option-wrap","popper-class":"fc-dropdown",onCommand:l.handleAddressCommand},{dropdown:h(()=>[n(_,{role:"menu"},{default:h(()=>[n(k,{command:{action:"edit",data:w},role:"menuitem"},{default:h(()=>[v(o(l.translate("Edit")),1)]),_:2},1032,["command"]),w.is_primary!=="1"?(r(),c(S,{key:0},[n(k,{command:{action:"default",data:w},role:"menuitem"},{default:h(()=>[v(o(l.translate("Set as default")),1)]),_:2},1032,["command"]),n(k,{command:{action:"remove",data:w},class:"item-destructive",role:"menuitem"},{default:h(()=>[v(o(l.translate("Delete")),1)]),_:2},1032,["command"])],64)):g("",!0)]),_:2},1024)]),default:h(()=>[s("button",{class:"more-btn","aria-label":l.translate("Address options"),"aria-haspopup":"true","aria-expanded":"false"},[n(f,{name:"More","aria-hidden":"true"})],8,Ln)]),_:2},1032,["onCommand"])])],2))),128))],8,Pn)):(r(),c("div",Vn,o(l.translate(`No ${i.addressType} address found, please add a new address.`)),1))])],8,Cn)}const _t=D($n,[["render",Bn]]),xn={name:"BillingAddress",props:["profileDetails"],emits:["fetch","setAddressPrimary","deleteAddress"],components:{AddressSection:_t}};function Nn(e,a,i,y,t,l){const u=m("AddressSection");return r(),A(u,{profileDetails:i.profileDetails,addressType:e.$t("billing"),title:e.$t("Billing Address"),description:e.$t("Provide or update the address where your billing statements and invoices will be sent."),onFetch:a[0]||(a[0]=d=>e.$emit("fetch")),onSetAddressPrimary:a[1]||(a[1]=d=>e.$emit("setAddressPrimary",d)),onDeleteAddress:a[2]||(a[2]=d=>e.$emit("deleteAddress",d))},null,8,["profileDetails","addressType","title","description"])}const Un=D(xn,[["render",Nn]]),Fn={name:"ShippingAddress",props:["profileDetails"],emits:["fetch","setAddressPrimary","deleteAddress"],components:{AddressSection:_t}};function Hn(e,a,i,y,t,l){const u=m("AddressSection");return r(),A(u,{profileDetails:i.profileDetails,addressType:e.$t("shipping"),title:e.$t("Shipping Address"),description:e.$t("Provide or update the address where your orders will be delivered."),onFetch:a[0]||(a[0]=d=>e.$emit("fetch")),onSetAddressPrimary:a[1]||(a[1]=d=>e.$emit("setAddressPrimary",d)),onDeleteAddress:a[2]||(a[2]=d=>e.$emit("deleteAddress",d))},null,8,["profileDetails","addressType","title","description"])}const On=D(Fn,[["render",Hn]]),qn={name:"UserProfile",components:{DynamicIcon:x,Badge:V,MaterialInput:ee,AddressComponent:ie,AccountDetails:hn,BillingAddress:Un,ShippingAddress:On},data(){return{validationErrors:{},isProfileChanged:!1,originalProfileDetails:{},loading:!1,addAddressLoading:!1,profileDetails:null,billingAddress:null,shippingAddress:null,addNewAddressModalVisible:!1,isEditAddress:!1,modalAction:"billing",newEmail:"",emailConfirmationData:{},emailChangeTokenExpiry:""}},watch:{"profileDetails.first_name":{handler(e,a){this.checkProfileChanges()}},"profileDetails.last_name":{handler(e,a){this.checkProfileChanges()}}},methods:{translate:b,updateCustomerProfile(){this.loading=!0,this.$post("customer-profile/update",{first_name:this.profileDetails.first_name,last_name:this.profileDetails.last_name,email:this.profileDetails.email}).then(e=>{this.isProfileChanged=!1,I.success(e.message),this.fetch()}).catch(e=>{I.error(e)}).finally(()=>{this.loading=!1})},setAddressPrimary(e){let a=e;a.customer_id,this.$post("customer-profile/make-primary-address",{addressId:a.id,type:a.type}).then(i=>{I.success(i),this.fetch()}).catch(i=>{I.success(i)})},deleteAddress(e){let a=e;a.customer_id,this.$post("customer-profile/delete-address",{addressId:a.id}).then(i=>{I.success(i),this.fetch()}).catch(i=>{I.error(i)})},fetch(){this.loading=!0,this.$get("customer-profile/profile").then(e=>{var a,i;this.originalProfileDetails=JSON.parse(JSON.stringify(e.data)),this.profileDetails=e==null?void 0:e.data,this.newEmail=(a=e==null?void 0:e.data)==null?void 0:a.new_email,this.emailChangeTokenExpiry=(i=e==null?void 0:e.data)==null?void 0:i.email_change_token_expiry,this.isProfileChanged=!1}).finally(()=>{this.loading=!1})},editAddress(){if(this.validateForm()){this.addAddressLoading=!0;let e={...this.newAddressData};this.$post("customer-profile/edit-address",{id:e.id,label:e.label,name:e.name,phone:e.phone,email:e.email,country:e.country,state:e.state,address_1:e.address_1,address_2:e.address_2,city:e.city,postcode:e.postcode,type:e.type}).then(a=>{I.success(a),this.fetch(),this.addAddressLoading=!1}).catch(a=>{I.error(a)}).finally(()=>{this.addNewAddressModalVisible=!1,this.resetFormDataAndValidation()})}else I.error(b("Please fill in all the required fields."))},checkProfileChanges(){if(this.profileDetails&&this.originalProfileDetails&&Object.keys(this.originalProfileDetails).length>0){const e=this.profileDetails.first_name!==this.originalProfileDetails.first_name,a=this.profileDetails.last_name!==this.originalProfileDetails.last_name;this.isProfileChanged=e||a}}},mounted(){this.fetch()}},Rn={key:0,"aria-live":"polite","aria-hidden":"true",class:"border border-solid border-gray-outline rounded fc-customer-dashboard-layout-width"},zn={class:"fc-form-container"},Yn={class:"form-left"},jn={class:"form-right"},Kn={class:"fc-form-container"},Zn={class:"form-left"},Wn={class:"form-right"},Gn={class:"fc-form-container"},Jn={class:"form-left"},Qn={class:"form-right"},Xn={key:1,class:"fc-customer-dashboard-user-profile fc-customer-dashboard-layout-width","aria-live":"polite"},ed={class:"fc-form-footer text-right"};function td(e,a,i,y,t,l){const u=m("el-skeleton-item"),d=m("el-skeleton"),f=m("AccountDetails"),k=m("BillingAddress"),_=m("ShippingAddress"),p=m("el-button");return r(),c(S,null,[t.loading?(r(),c("div",Rn,[n(d,{class:"px-5 py-5",loading:t.loading,rows:2,animated:""},{template:h(()=>[s("div",zn,[s("div",Yn,[n(u,{variant:"p",class:"w-[200px] mr-5"}),n(u,{variant:"p",class:"w-[240px] mr-5"})]),s("div",jn,[n(u,{variant:"p",class:"w-[200px]"}),n(u,{variant:"p",class:"w-[300px]"})])]),s("div",Kn,[s("div",Zn,[n(u,{variant:"p",class:"w-[200px] mr-5"}),n(u,{variant:"p",class:"w-[240px] mr-5"})]),s("div",Wn,[n(u,{variant:"p",class:"w-[200px]"}),n(u,{variant:"p",class:"w-[300px]"})])]),s("div",Gn,[s("div",Jn,[n(u,{variant:"p",class:"w-[200px] mr-5"}),n(u,{variant:"p",class:"w-[240px] mr-5"})]),s("div",Qn,[n(u,{variant:"p",class:"w-[200px]"}),n(u,{variant:"p",class:"w-[300px]"})])])]),_:1},8,["loading"])])):g("",!0),t.profileDetails&&!t.loading?(r(),c("div",Xn,[n(f,{profileDetails:t.profileDetails},null,8,["profileDetails"]),t.profileDetails.not_a_customer?g("",!0):(r(),c(S,{key:0},[n(k,{profileDetails:t.profileDetails,onFetch:l.fetch,onSetAddressPrimary:l.setAddressPrimary,onDeleteAddress:l.deleteAddress},null,8,["profileDetails","onFetch","onSetAddressPrimary","onDeleteAddress"]),n(_,{profileDetails:t.profileDetails,onFetch:l.fetch,onSetAddressPrimary:l.setAddressPrimary,onDeleteAddress:l.deleteAddress},null,8,["profileDetails","onFetch","onSetAddressPrimary","onDeleteAddress"]),s("footer",ed,[n(p,{type:"primary",size:"small",onClick:l.updateCustomerProfile,disabled:!t.isProfileChanged,"aria-label":l.translate("Save Profile")},{default:h(()=>[v(o(l.translate("Save Profile")),1)]),_:1},8,["onClick","disabled","aria-label"])])],64))])):g("",!0)],64)}const sd=D(qn,[["render",td]]),ad={name:"SingleOrderDetails",props:{order_id:{type:[String,Number],required:!0}},watch:{order_id(){this.fetchOrder()}},components:{OrderTableLoader:R,TransactionsTable:ht,LicenseTable:oe,SubscriptionTable:ut,Badge:V,DownloadsTable:dt},data(){return{orderTitleId:"order-title",order:null,loading:!0,placeholderImage:window.fluentcart_customer_profile_vars.placeholder_image}},computed:{ArrowRight(){return rt}},methods:{orderBillingAddressUpdated(e){this.order.billing_address_text=e},getImage(e){return e.variant_image?e.variant_image:e.image?e.image:this.placeholderImage},fetchOrder(){this.$get("customer-profile/orders/"+this.order_id).then(e=>{this.order=e.order}).catch(e=>{var a;if(e!=null&&e.parent_order&&((a=e==null?void 0:e.parent_order)!=null&&a.uuid)){this.$router.push({name:"view_order",params:{order_id:e.parent_order.uuid}});return}this.handleError(e)}).finally(()=>{this.loading=!1})},pluralizeTranslate:G},mounted(){this.fetchOrder()}},id=["aria-labelledby","aria-busy"],ld=["aria-label"],od=["id"],rd={class:"fc-single-order-box",role:"region","aria-labelledby":"order-summary-title"},nd={class:"fc-single-order-body"},dd={class:"fc-customer-dashboard-order-items","aria-labelledby":"order-summary-title"},cd={class:"fc-order-summary-wrap"},ud={class:"fc-order-summary-header"},md={id:"order-summary-title",class:"fc-order-summary-header-title"},hd=["aria-label"],_d={class:"fc-order-summary-body"},pd={class:"fc-order-summary-items",role:"list"},fd={class:"fc-product-info-card"},bd={class:"fc-product-info-card-inner"},yd={class:"media"},gd=["href","aria-label"],vd=["src","alt"],wd={class:"product-info-content"},kd={class:"title"},$d=["href","aria-label"],Cd={key:0,class:"text-gray-600"},Ad={class:"variation-title"},Md={key:0,class:"product-subscription-info flex flex-col gap-1 mt-1"},Sd=["innerHTML","aria-label"],Dd=["aria-label"],Pd={key:0,class:"text-sm"},Td={key:0,class:"fc-order-summary-order-calculation"},Ed={key:0,class:"tr"},Id={key:1,class:"tr"},Ld={key:2,class:"tr"},Vd={key:3,class:"tr"},Bd={key:4,class:"tr"},xd={key:5,class:"tr"},Nd={class:"fc-order-summary-footer"},Ud={class:"fc-order-summary-footer-inner"},Fd=["aria-level"],Hd={key:0,class:"fc-single-order-box",role:"region","aria-labelledby":"subscription-title"},Od={class:"fc-single-order-header"},qd={id:"subscription-title",class:"title"},Rd={key:1,class:"fc-single-order-box",role:"region","aria-labelledby":"downloads-title"},zd={class:"fc-single-order-header"},Yd={id:"downloads-title",class:"title"},jd={key:2,class:"fc-single-order-box",role:"region","aria-labelledby":"licenses-title"},Kd={class:"fc-single-order-header"},Zd={id:"licenses-title",class:"title"},Wd={key:3,class:"fc-single-order-box",role:"region","aria-labelledby":"transactions-title"},Gd={class:"fc-single-order-header"},Jd={id:"transactions-title",class:"title"},Qd={class:"fc-customer-dashboard-table"},Xd={key:4,class:"fc-single-order-box pb-5 lg:pb-0",role:"region","aria-labelledby":"addresses-title"},ec={id:"addresses-title",class:"sr-only"},tc={class:"fc-customer-dashboard-address mb-5 lg:mb-0","aria-labelledby":"billing-title"},sc={id:"billing-title",class:"title"},ac=["innerHTML"],ic={class:"fc-customer-dashboard-address","aria-labelledby":"shipping-title"},lc={id:"shipping-title",class:"title"},oc=["innerHTML"],rc={key:1,"aria-live":"polite"};function nc(e,a,i,y,t,l){const u=m("el-breadcrumb-item"),d=m("el-breadcrumb"),f=m("Badge"),k=m("SubscriptionTable"),_=m("DownloadsTable"),p=m("LicenseTable"),w=m("TransactionsTable"),P=m("el-col"),E=m("el-row"),T=m("OrderTableLoader");return r(),c("div",{class:"fc-customer-dashboard-single-order-wrap",role:"main","aria-labelledby":t.orderTitleId,"aria-busy":t.loading},[s("div",{class:"fc-customer-dashboard-breadcrumb mb-4",role:"navigation","aria-label":e.$t("Breadcrumb navigation")},[n(d,{"separator-icon":l.ArrowRight},{default:h(()=>[n(u,{to:{name:"purchase-history"}},{default:h(()=>[v(o(e.$t("Purchase History")),1)]),_:1}),n(u,{"aria-current":"page"},{default:h(()=>{var C;return[v("#"+o((C=t.order)==null?void 0:C.invoice_no),1)]}),_:1})]),_:1},8,["separator-icon"])],8,ld),t.order?(r(),c(S,{key:0},[s("h1",{id:t.orderTitleId,class:"sr-only"},o(e.$t("Order Details"))+" #"+o(t.order.invoice_no),9,od),s("article",rd,[s("div",nd,[s("section",dd,[s("div",cd,[s("header",ud,[s("h2",md,o(e.$t("Summary")),1),t.order?(r(),c("div",{key:0,"aria-label":e.$t("Order status information"),class:"fc-order-status-badges"},[n(f,{status:t.order.payment_status},null,8,["status"]),t.order.fulfillment_type=="physical"?(r(),c(S,{key:0},[n(f,{class:"ml-2",status:t.order.status},null,8,["status"]),n(f,{class:"ml-2",status:t.order.shipping_status},null,8,["status"])],64)):g("",!0)],8,hd)):g("",!0)]),s("div",_d,[s("ul",pd,[(r(!0),c(S,null,L(t.order.order_items,(C,B)=>(r(),c("li",{key:B,class:"fc-order-summary-item",role:"listitem"},[s("div",fd,[s("div",bd,[s("div",yd,[s("a",{target:"_blank",href:C.url,rel:"noopener noreferrer","aria-label":e.$t("View product")+" "+C.title},[s("img",{src:l.getImage(C),alt:e.$t("Product image for")+" "+C.title,loading:"lazy"},null,8,vd)],8,gd)]),s("div",wd,[s("div",kd,[s("a",{target:"_blank",href:C.url,rel:"noopener noreferrer","aria-label":e.$t("View product")+" "+C.title},[C.quantity>1?(r(),c("span",Cd,o(C.quantity)+" x",1)):g("",!0),v(" "+o(C.post_title),1)],8,$d)]),s("div",Ad,o(C.title),1),C.meta_lines&&C.meta_lines.length>0?(r(),c("div",Md,[(r(!0),c(S,null,L(C.meta_lines,$=>(r(),c("span",{class:"block leading-none text-xs",innerHTML:$.label+": "+$.value,"aria-label":$.label+": "+$.value},null,8,Sd))),256))])):g("",!0)])])]),s("div",{class:"fc-order-total text-right","aria-label":e.$t("Subtotal for this item")},[v(o(e.formatNumber(C.subtotal))+" ",1),C.extra_amount?(r(),c("span",Pd,[a[0]||(a[0]=s("br",null,null,-1)),v(" + "+o(e.formatNumber(C.extra_amount)),1)])):g("",!0)],8,Dd)]))),128))]),t.order.manual_discount_total+t.order.coupon_discount_total>0||t.order.shipping_total>0||t.order.manual_discount_total+t.order.coupon_discount_total>0||t.order.tax_total>0?(r(),c("div",Td,[t.order.manual_discount_total+t.order.coupon_discount_total||t.order.subtotal>0?(r(),c("div",Ed,[v(o(e.$t("Subtotal"))+" ",1),s("span",null,o(e.formatNumber(t.order.subtotal))+" "+o(parseInt(t.order.tax_behavior)==2?e.$t("(Inc. Tax)"):""),1)])):g("",!0),t.order.shipping_total>0?(r(),c("div",Id,[v(o(e.$t("Shipping"))+" ",1),s("span",null,o(e.formatNumber(t.order.shipping_total)),1)])):g("",!0),t.order.tax_total>0?(r(),c("div",Ld,[v(o(e.$t("Tax"))+" "+o(t.order.tax_behavior==2?e.$t("(Included)"):e.$t("(Excluded)"))+" ",1),s("span",null,o(e.formatNumber(t.order.tax_total)),1)])):g("",!0),t.order.shipping_tax>0?(r(),c("div",Vd,[v(o(e.$t("Shipping Tax"))+" "+o(t.order.tax_behavior==2?e.$t("(Included)"):e.$t("(Excluded)"))+" ",1),s("span",null,o(e.formatNumber(t.order.shipping_tax)),1)])):g("",!0),t.order.coupon_discount_total>0?(r(),c("div",Bd,[v(o(e.$t("Coupon Discount"))+" ",1),s("span",null,"-"+o(e.formatNumber(t.order.coupon_discount_total)),1)])):g("",!0),t.order.manual_discount_total>0?(r(),c("div",xd,[v(o(e.$t("Upgrade Discount"))+" ",1),s("span",null,"-"+o(e.formatNumber(t.order.manual_discount_total)),1)])):g("",!0)])):g("",!0)]),s("footer",Nd,[s("div",Ud,[s("div",{class:"tr","aria-level":e.$t("Total amount for the order")},[v(o(e.$t("Total"))+" ",1),s("span",null,o(e.formatNumber(t.order.total_amount)),1)],8,Fd)])])])])])]),t.order.subscriptions&&t.order.subscriptions.length?(r(),c("article",Hd,[s("header",Od,[s("h2",qd,o(e.$t("Subscription Plan")),1)]),n(k,{hideHeader:!0,subscriptions:t.order.subscriptions},null,8,["subscriptions"])])):g("",!0),t.order.downloads&&t.order.downloads.length?(r(),c("article",Rd,[s("header",zd,[s("h2",Yd,o(l.pluralizeTranslate("Download","Downloads",t.order.downloads.length)),1)]),n(_,{"show-table-header":!1,downloads:t.order.downloads},null,8,["downloads"])])):g("",!0),t.order.licenses&&t.order.licenses.length?(r(),c("article",jd,[s("header",Kd,[s("h2",Zd,o(l.pluralizeTranslate("License","Licenses",t.order.licenses.length)),1)]),n(p,{licenses:t.order.licenses,is_simple:!0,showTableHeader:!1},null,8,["licenses"])])):g("",!0),t.order.transactions&&t.order.transactions.length?(r(),c("article",Wd,[s("header",Gd,[s("h2",Jd,o(e.$t("Related Transactions")),1)]),s("div",Qd,[n(w,{transactions:t.order.transactions,"show-table-header":!0,onBillingAddressUpdated:l.orderBillingAddressUpdated},null,8,["transactions","onBillingAddressUpdated"])])])):g("",!0),t.order.billing_address_text||t.order.shipping_address_text?(r(),c("article",Xd,[s("h2",ec,o(e.$t("Order addresses")),1),n(E,{gutter:30},{default:h(()=>[n(P,{md:12,sm:24},{default:h(()=>[s("section",tc,[s("h3",sc,o(e.$t("Billing Address")),1),s("div",{class:"text",innerHTML:t.order.billing_address_text},null,8,ac)])]),_:1}),t.order.fulfillment_type=="physical"?(r(),A(P,{key:0,md:12,sm:24},{default:h(()=>[s("section",ic,[s("h3",lc,o(e.$t("Shipping Address")),1),s("div",{class:"text",innerHTML:t.order.shipping_address_text},null,8,oc)])]),_:1})):g("",!0)]),_:1})])):g("",!0)],64)):t.loading?(r(),c("div",rc,[n(T,{class:"mb-4","rows-range":[1,2,3]}),n(T,{class:"mb-4","rows-range":[1,2]}),n(T,{"rows-range":[1,2,3]})])):g("",!0)],8,id)}const dc=D(ad,[["render",nc]]),cc={class:"fc-customer-app"},uc=Object.assign({name:"CustomerDashboardApp"},{__name:"App",setup(e){return(a,i)=>{const y=m("router-view");return r(),c("div",cc,[n(y)])}}});function mc(e){e.component(W.name,W),e.component(be.name,be),e.component(ye.name,ye),e.component(ge.name,ge),e.component(me.name,me),e.component(ve.name,ve),e.component(he.name,he),e.component(we.name,we),e.component(_e.name,_e),e.component(ke.name,ke),e.component($e.name,$e),e.component(Ce.name,Ce),e.component(Ae.name,Ae),e.component(Me.name,Me),e.component(Se.name,Se),e.component(De.name,De),e.component(Pe.name,Pe),e.component(Te.name,Te),e.component(Ee.name,Ee),e.component(Ie.name,Ie),e.component(pe.name,pe),e.component(Le.name,Le),e.component(Ve.name,Ve),e.component(Be.name,Be),e.component(xe.name,xe),e.component(Ne.name,Ne),e.component(Ue.name,Ue),e.component(Fe.name,Fe),e.component(He.name,He),e.component(Oe.name,Oe),e.component(qe.name,qe),e.component(Re.name,Re),e.component(ze.name,ze),e.component(Ye.name,Ye),e.component(je.name,je),e.component(Ke.name,Ke),e.component(Ze.name,Ze),e.component(We.name,We),e.component(Ge.name,Ge),e.component(Je.name,Je),e.component(Qe.name,Qe),e.component(Xe.name,Xe),e.component(et.name,et),e.component(tt.name,tt),e.component(st.name,st),e.component(at.name,at),e.component(fe.name,fe),e.component(it.name,it),e.config.globalProperties.$notify=W,e.config.globalProperties.$confirm=le.confirm,e.config.globalProperties.$message=Et}const hc=[{path:"/",name:"dashboard",component:Cs,meta:{active_menu:"dashboard",title:"dashboard"}},{path:"/purchase-history",name:"purchase-history",component:qs,meta:{active_menu:"purchase-history",title:"Purchase History"}},{path:"/order",component:sn,children:[{name:"view_order",path:":order_id",component:dc,props:!0,meta:{active_menu:"purchase-history",title:"View Order"}}]},{path:"/subscriptions",name:"subscriptions",component:Il,meta:{active_menu:"subscriptions",title:"Subscriptions"}},{name:"view_subscription",path:"/subscription/:subscription_uuid",component:en,props:!0,meta:{active_menu:"subscriptions",title:"View Subscription"}},{path:"/downloads",name:"downloads",component:Fa,meta:{active_menu:"downloads",title:"Downloads"}},{path:"/licenses",name:"licenses",component:$a,meta:{active_menu:"licenses",title:"Licenses"}},{name:"manage_license",path:"/licenses/:license_key/view",component:Wi,props:!0,meta:{active_menu:"licenses",title:"Manage License"}},{name:"profile",path:"/profile",component:sd,meta:{active_menu:"profile",title:"Profile"}}],J=Pt({routes:hc,history:Tt(window.fluentcart_customer_profile_vars.app_slug)});J.afterEach(e=>{var i;const a=(i=e.meta)==null?void 0:i.active_menu;if(document.querySelectorAll(".fc-customer-navs li").forEach(y=>{y.classList.remove("active_customer_menu")}),a){const y=document.querySelector(".fc-customer-nav-item-"+a);y&&y.classList.add("active_customer_menu")}});const se=document.querySelectorAll("[data-fluent-cart-customer-profile-app]");if(se&&se.length>0){const e=se[0],a=kt({});mc(a),a.config.globalProperties.$notify=W,a.config.globalProperties.$confirm=le.confirm,a.config.globalProperties.appVars=window.fluentcart_customer_profile_vars,a.directive("loading",Vt),a.mixin({methods:{$get:K.get,$post:K.post,$put:K.put,$del:K.delete,formatNumber(t,l=!0,u=!1){return!t&&u?"":(t?t=(t/100).toFixed(2):t="0.00",l?(t=new Intl.NumberFormat("en-US").format(t),window.fluentcart_customer_profile_vars.shop.currency_position==="before"?window.fluentcart_customer_profile_vars.shop.currency_sign+t:t+window.fluentcart_customer_profile_vars.shop.currency_sign):t)},$t:b,handleError(t){let l="";typeof t=="string"?l=t:t&&t.message&&(l=t.message),l||(l="Something is wrong!"),this.$notify({type:"error",title:"Error",offset:30,message:l,dangerouslyUseHTMLString:!0,duration:1e3})},handleSuccess(t){let l="Success";typeof t=="string"?l=t:t&&t.message?l=t.message:l=convertToText(t),l||(l="Success!"),this.$notify({type:"success",title:"Success",offset:30,message:l,dangerouslyUseHTMLString:!0,duration:1e3})},registerCopyAction(){$t(()=>{document.querySelectorAll(".copyable-content").forEach(u=>{u.addEventListener("click",function(){const d=this.textContent;navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(d).then(()=>{}).catch(f=>{console.error("Failed to copy text: ",f),l(d)}):l(d)})});function l(u){let d=document.createElement("input");d.value=u,document.body.appendChild(d),d.select(),d.setSelectionRange(0,99999);try{document.execCommand("copy")}catch(f){console.error("Fallback: Could not copy text: ",f)}document.body.removeChild(d)}})},getAddress(t,l="billing",u=!1){if(!t)return"";let d=[];return!u&&t.name&&d.push(t.name),t.address_1&&d.push(t.address_1),t.address_2&&d.push(t.address_2),t.city&&d.push(t.city),t.state&&d.push(t.state),t.postcode&&d.push(t.postcode),t.country&&d.push(t.country),t.phone&&d.push(t.phone),d.join(", ")||"No "+l+" address provided"},readableFileSize(t){if(!t&&t!==0)return"";const l=["Bytes","KB","MB","GB","TB"],u=Math.floor(Math.log2(t)/10);return`${+(t/1024**u).toFixed(2)} ${l[u]}`},formatDate:Mt}});const i=window.fluentcart_customer_profile_vars.el_strings,y=window.fluentcart_customer_profile_vars.datei18;i.el.datepicker.weeks=Object.values(y.weekdaysShort),i.el.datepicker.months=Object.values(y.monthsShort),a.use(Bt,{locale:i}),a.use(J).component("app",uc).mount(e)}document.addEventListener("DOMContentLoaded",()=>{let e=window.fluentcart_customer_profile_vars.app_url;document.querySelectorAll("a.fct_route").forEach(a=>{a.addEventListener("click",i=>{const y=a.getAttribute("href");if(!y)return;const t=y.replace(e,"");try{if(J.resolve(t).matched.length>0)return i.preventDefault(),J.push(t),!0}catch(l){console.error("Navigation error:",l)}})})});
