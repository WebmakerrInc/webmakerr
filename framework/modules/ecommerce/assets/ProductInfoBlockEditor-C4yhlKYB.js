import{j as e,b as o}from"./BlockEditorTranslator-Do4trUgb.js";import{h as g}from"./Icons-B2jBVdSk.js";import{C as j,a as v}from"./index-BYEX9EM_.js";import{S as P}from"./SelectProductModal-ZoqEuQTy.js";import{E as b}from"./EditorPanel-4oWFueOm.js";import{E as d}from"./EditorPanelRow-CD2W-00O.js";import{S as w}from"./SingleProductContext-BzN8-5Wa.js";import{a as k}from"./add-query-args-COp5A_Oq.js";import"./index-CGoo2crO.js";import"./ProductListItem-D_5QaYKg.js";const{InspectorControls:_}=wp.blockEditor,N=({attributes:t,setAttributes:s,selectedProduct:l,setSelectedProduct:h})=>e.jsx(_,{children:e.jsx("div",{className:"fc-inspector-control-wrap fc-inspector-control-wrap--product-card",children:e.jsx("div",{className:"fc-inspector-control-group",children:e.jsx("div",{className:"fc-inspector-control-body",children:e.jsxs(b,{title:o("Product"),children:[e.jsxs(d,{children:[e.jsx("span",{className:"fc-inspector-control-label",children:o("Query type")}),e.jsx("div",{className:"actions",children:e.jsx(j,{customKeys:{key:"value",label:"label"},defaultValue:t.query_type,options:[{label:o("Default"),value:"default"},{label:o("Custom"),value:"custom"}],onChange:function(r){s({query_type:r})}})})]}),t.query_type==="custom"&&e.jsxs(d,{className:"flex-col",children:[e.jsx(P,{onModalClosed:r=>{console.log(r," selectedProduct"),s({product_id:String(r.ID)||""})}}),l&&e.jsxs("div",{className:"fc-selected-variation-info w-full",children:[e.jsx("strong",{children:o("Selected Product:")}),e.jsx("p",{children:l.post_title})]})]})]})})})})}),S=""+new URL("assets/ProductInfo-Cy9l_GKj.png",import.meta.url).href,{useBlockProps:p,InnerBlocks:u}=wp.blockEditor,{registerBlockType:E}=wp.blocks,{useEffect:C,useState:f}=wp.element,c=window.fluent_cart_product_info_data;c.placeholder_image;const m=window.fluentCartRestVars.rest,I=[["core/columns",{},[["core/column",{},[["fluent-cart/product-gallery",{}]]],["core/column",{},[["fluent-cart/shopapp-product-title",{}],["fluent-cart/stock",{}],["fluent-cart/shopapp-product-price",{}],["fluent-cart/buy-section",{}]]]]]];E(c.slug+"/"+c.name,{title:c.title,description:c.description,example:{attributes:{},innerBlocks:[{name:"core/image",attributes:{url:S,alt:"Product Info Preview",style:{width:"100%",height:"auto"}}}]},icon:{src:g},category:"fluent-cart",supports:{html:!1,reusable:!1,innerBlocks:!0},attributes:{product_id:{type:"string",default:""},variant_id:{type:"string",default:""},query_type:{type:"string",default:"default"}},edit:({attributes:t,setAttributes:s})=>{const l=p({className:"my-plugin-product-card"}),[h,r]=f({}),[a,n]=f({}),x=m.url+"/products/"+t.product_id,y=()=>{v({path:k(x,{with:["detail","variants"]}),headers:{"X-WP-Nonce":m.nonce}}).then(i=>{console.log(i.product," response"),n(i.product||{})}).finally(()=>{})};return C(()=>{y()},[t.product_id]),e.jsxs("div",{...l,children:[e.jsx(N,{attributes:t,setAttributes:s,selectedProduct:a,setSelectedProduct:n}),e.jsx("div",{className:"product-card-inner",style:{border:"1px solid #eee",padding:"16px",borderRadius:"8px"},children:e.jsx(w,{value:{product:a},children:e.jsx(u,{template:I,templateLock:!1,allowedBlocks:["core/heading","fluent-cart/buy-section","fluent-cart/product-gallery","fluent-cart/stock","core/columns","core/paragraph","core/title","fluent-cart/shopapp-product-title","fluent-cart/shopapp-product-price"]})})})]})},save:()=>{const t=p.save({className:"my-plugin-product-card"});return e.jsx("div",{...t,children:e.jsx("div",{className:"product-card-inner",children:e.jsx(u.Content,{})})})}});
